    
    

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
 lang="en" dir="ltr">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
    Lab 11: Web Services    [CS Open CourseWare]
  </title>

  <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="date" content="2016-06-17T15:45:22+0300"/>
<meta name="keywords" content="iot2015,labs,11"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../lib/exe/opensearch.php" title="CS Open CourseWare"/>
<link rel="start" href="../../../courses.1.html"/>
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="../../feed.php%3Fmode=list&amp;ns=iot2015:labs"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="../../_export/xhtml/iot2015/labs/11.html"/>
<link rel="canonical" href="11.html"/>
<link rel="stylesheet" type="text/css" href="../../lib/exe/css.php%3Ft=arctic&amp;tseed=1479898000.css"/>
<script type="text/javascript">/*<![CDATA[*/var NS='iot2015:labs';var JSINFO = {"id":"iot2015:labs:11","namespace":"iot2015:labs","isadmin":0,"isauth":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../lib/exe/js.php%3Ftseed=1479898000"></script>
<script type="text/x-mathjax-config">/*<![CDATA[*/MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ["$","$"], ["\\(","\\)"] ],
        displayMath: [ ["$$","$$"], ["\\[","\\]"] ],
        processEscapes: true
    }
});
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<script type="text/javascript">/*<![CDATA[*/
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
		  
/*!]]>*/</script>
<script type="text/javascript">/*<![CDATA[*/
var pageTracker = _gat._getTracker("UA-38383934-1");
pageTracker._initData();
pageTracker._trackPageview();
		  
/*!]]>*/</script>

  <link rel="shortcut icon" href="../../lib/tpl/arctic/images/favicon.ico" />

  
</head>
<body>
<div id="wrapper" class='show'>
  <div class="dokuwiki">

    
    <div class="stylehead">
      <div class="header">
        <div class="pagename">
          <a href="../index.html"><img height="70" src="../../res/sigla_iot.png"/> </a>        </div>
        <div class="logo">
          <a style="color: #AAA !important;" href="http://innovationlabs.ro"/><img height="70" src="../../res/sigla_il.png" name="dokuwiki__top"/></a>        </div>
      </div>
    
       
      <div class="breadcrumbs">
              </div>
      
            </div>

                  <div class="bar" id="bar__top">
        <div class="bar-left">
                  </div>
        <div class="bar-right">
          <a href="11%3Fdo=recent.html"  class="action recent" accesskey="r" rel="nofollow" title="Recent changes [R]">Recent changes</a><a href="11%3Fdo=login&amp;sectok=f62420cf5b01253da4b50505d148181b.html"  class="action login" rel="nofollow" title="Login">Login</a>        </div>
    </div>
        
    
    
    
              <div class="left_page">
          
<h2 class="sectionedit1" id="lab_11web_services">Lab 11: Web Services</h2>
<div class="level2">

</div>

<h2 class="sectionedit2" id="chat">1) Chat</h2>
<div class="level2">

<p>
Using the what you learned in course 11 continue the chat app you started in laboratory 10.
For this you have an api at
<a href="http://api.my-sandbox.co/chat/chat.php" class="urlextern" title="http://api.my-sandbox.co/chat/chat.php"  rel="nofollow">http://api.my-sandbox.co/chat/chat.php</a>
When you call get on it you will receive all the messages
When you send via post the variables username and msg to it, it will add a message to the chat.
For visibility show only last 5-10 messages. Each message is separated by “\n”
</p>

<p>
In order to fetch the messages you need to use the ajax get method from jquery and
replace the \n with &lt;br&gt; in order to display them
</p>
<pre class="code">$.get(&#039;http://api.my-sandbox.co/chat/chat.php&#039;, function(msgs){
  msgs = msgs.split(&quot;\n&quot;).slice(-5).join(&quot;&lt;br&gt;&quot;);
  //display msgs in some container
})</pre>

<p>
The split method applied on a string splits the string into an array of strings using the given separator.
The slice method is used to select certain elements of an array , here the last 5.
The join method applied on an array returns of string generated by concatenating the elements of the array
of delimiting them by the given separator.
</p>

<p>
In order to send a message you will need to use the post ajax call:
</p>
<pre class="code">$.post(&#039;http://api.my-sandbox.co/chat/chat.php&#039;,{username:&quot;some user name&quot;, msg:&quot;the contents of the msg&quot;}, function(result){
  //code to run when msg sent successfully 
})</pre>

<p>
In order to make the chat from the last laboratory to work, all you need to do is code the chatSend method to post
the latest message to the server as shown above  and retrieve the messages every second by calling the get
method shown above every 1000 ms with the help of an interval (setInterval).
</p>

<p>
Your chatSend method should now look like this:
</p>
<pre class="code">chatSend:function(){
  $.post(&#039;http://api.my-sandbox.co/chat/chat.php&#039;,
         {username:$(&quot;#username&quot;).val(), msg:$(&quot;#msg&quot;).val()}
  );
}</pre>

</div>

<h2 class="sectionedit3" id="newsfeed">2) Newsfeed</h2>
<div class="level2">

<p>
Continue the newsfeed you started in laboratory 10.
Implement support for reading the whole article bu showing it on a new page
and support for liking articles and display the number of likes.
</p>

<p>
For this you will have an api at:
</p>

<p>
<a href="http://api.my-sandbox.co/news/get.php" class="urlextern" title="http://api.my-sandbox.co/news/get.php"  rel="nofollow">http://api.my-sandbox.co/news/get.php</a>
used to fetch latest news and
<a href="http://api.my-sandbox.co/news/get.php?id=PRIMARY_KEY_OF_ARTICLE" class="urlextern" title="http://api.my-sandbox.co/news/get.php?id=PRIMARY_KEY_OF_ARTICLE"  rel="nofollow">http://api.my-sandbox.co/news/get.php?id=PRIMARY_KEY_OF_ARTICLE</a>
to fetch the full article
</p>

<p>
and for likes
</p>

<p>
GET <a href="http://api.my-sandbox.co/news/like.php" class="urlextern" title="http://api.my-sandbox.co/news/like.php"  rel="nofollow">http://api.my-sandbox.co/news/like.php</a> with
with id set in order to get the number of likes for an article
</p>

<p>
GET <a href="http://api.my-sandbox.co/news/like.php" class="urlextern" title="http://api.my-sandbox.co/news/like.php"  rel="nofollow">http://api.my-sandbox.co/news/like.php</a> with
with id and uuid set in order to get if you liked or not an article
</p>

<p>
POST <a href="http://api.my-sandbox.co/news/like.php" class="urlextern" title="http://api.my-sandbox.co/news/like.php"  rel="nofollow">http://api.my-sandbox.co/news/like.php</a> with a JSON
</p>
<pre class="code">{
  method:&quot;like&quot;,
  uuid:&quot;phone-uuid&quot;,
  pk:&quot;article-pk&quot;
}</pre>

<p>
in order to like an article
</p>

<p>
POST <a href="http://api.my-sandbox.co/news/like.php" class="urlextern" title="http://api.my-sandbox.co/news/like.php"  rel="nofollow">http://api.my-sandbox.co/news/like.php</a> with a JSON
</p>
<pre class="code">{
  method:&quot;unlike&quot;,
  uuid:&quot;phone-uuid&quot;,
  pk:&quot;article-pk&quot;
}</pre>

<p>
in order to dislike an article.
</p>

<p>
To get the uuid of the phone just access
device.uuid
The device plugin must be installed (it should be installed in your apps by default but you will have to move the config.xml from the root folder in the www folder)
</p>

<p>
Fetching of news is identical to fetching the text in exercise one. This is also true for fetching the
like count with or without id.
</p>

<p>
I order to set JSON encoded messages though you will need to use JSON.stringify method like in the following example:
</p>
<pre class="code">var json_object = { method:&quot;like&quot;, uuid:device.uuid, pk:1 }
$.post(URL,JSON.stringify(json_object), function(response){ //post respone action });</pre>

</div>

<h2 class="sectionedit4" id="comunicate_with_webservers_from_your_boards">3) Comunicate with webservers from your boards</h2>
<div class="level2">

<p>
Depending on what you made your boards try to make the phone communicate with the webserver from the boards.
</p>

</div>

        </div>
        <div class="right_sidebar">
          <form action="../../start.html" accept-charset="utf-8" class="search" id="dw__search" method="get"><div class="no"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch__in" accesskey="f" name="id" class="edit" title="[F]" /><input type="submit" value="Search" class="button" title="Search" /><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>          <div class="namespace_sidebar sidebar_box">

<h1 class="sectionedit1" id="lectures">Lectures</h1>
<div class="level1">

<div><div id="nojs_indexmenu_628116394583579d67b394" data-jsajax="" class="indexmenu_nojs">

<ul class="idx">
<li class="level1"><div class="li"><a href="../courses/01.html" class="wikilink1" title="iot2015:courses:01">Lecture 1: Introduction to IoT</a></div></li>
<li class="level1"><div class="li"><a href="../courses/02.html" class="wikilink1" title="iot2015:courses:02">Lecture 2: Electronics for the Internet of Things</a></div></li>
<li class="level1"><div class="li"><a href="../courses/03.html" class="wikilink1" title="iot2015:courses:03">Lecture 3: Software for the Internet of Things</a></div></li>
<li class="level1"><div class="li"><a href="../courses/04.html" class="wikilink1" title="iot2015:courses:04">Lecture 4: Sensors and peripherals</a></div></li>
<li class="level1"><div class="li"><a href="../courses/05.html" class="wikilink1" title="iot2015:courses:05">Lecture 5: Wyliodrin Dashboard</a></div></li>
<li class="level1"><div class="li"><a href="../courses/06.html" class="wikilink1" title="iot2015:courses:06">Lecture 6: Web servers</a></div></li>
<li class="level1"><div class="li"><a href="../courses/07.html" class="wikilink1" title="iot2015:courses:07">Lecture 7: Signals and Systems</a></div></li>
<li class="level1"><div class="li"><a href="../courses/08.html" class="wikilink1" title="iot2015:courses:08">Lecture 8: Transfer Function</a></div></li>
<li class="level1"><div class="li"><a href="../courses/09.html" class="wikilink1" title="iot2015:courses:09">Lecture 9: Filters</a></div></li>
<li class="level1"><div class="li"><a href="../courses/10.html" class="wikilink1" title="iot2015:courses:10">Lecture 10: Cross platform mobile development</a></div></li>
<li class="level1"><div class="li"><a href="../courses/11.html" class="wikilink1" title="iot2015:courses:11">Lecture 11: Web Services</a></div></li>
<li class="level1"><div class="li"><a href="../courses/12.html" class="wikilink1" title="iot2015:courses:12">Lecture 12: PhoneGap plugins</a></div></li>
</ul>
</div></div>

</div>
<!-- EDIT1 SECTION "Lectures" [1-55] -->
<h1 class="sectionedit2" id="labs">Labs</h1>
<div class="level1">

<div><div id="nojs_indexmenu_1485959732583579d67d2d4" data-jsajax="" class="indexmenu_nojs">

<ul class="idx">
<li class="level1"><div class="li"><a href="01.html" class="wikilink1" title="iot2015:labs:01">Lab 1: Setting up Edison</a></div></li>
<li class="level1"><div class="li"><a href="02.html" class="wikilink1" title="iot2015:labs:02">Lab 2: Linux</a></div></li>
<li class="level1"><div class="li"><a href="03.html" class="wikilink1" title="iot2015:labs:03">Lab 3: Blink a LED</a></div></li>
<li class="level1"><div class="li"><a href="04.html" class="wikilink1" title="iot2015:labs:04">Lab 4: Programming with Streams</a></div></li>
<li class="level1"><div class="li"><a href="05.html" class="wikilink1" title="iot2015:labs:05">Lab 5: Connecting Analog Sensors to the board and adding charts</a></div></li>
<li class="level1"><div class="li"><a href="06.html" class="wikilink1" title="iot2015:labs:06">Lab 6: Connect and use an LCD</a></div></li>
<li class="level1"><div class="li"><a href="07.html" class="wikilink1" title="iot2015:labs:07">Lab 7: Digital sensors</a></div></li>
<li class="level1"><div class="li"><a href="08.html" class="wikilink1" title="iot2015:labs:08">Lab 8: Web server</a></div></li>
<li class="level1"><div class="li"><a href="09.html" class="wikilink1" title="iot2015:labs:09">Lab 9: App Inventor</a></div></li>
<li class="level1"><div class="li"><a href="10.html" class="wikilink1" title="iot2015:labs:10">Lab 10: User Interface and User Experience</a></div></li>
<li class="level1"><div class="li"><span class="curid"><a href="11.html" class="wikilink1" title="iot2015:labs:11">Lab 11: Web Services</a></span></div></li>
<li class="level1"><div class="li"><a href="12.html" class="wikilink1" title="iot2015:labs:12">Lab 12: Plugins and Local Storage</a></div></li>
</ul>
</div></div>

</div>
<!-- EDIT2 SECTION "Labs" [56-105] -->
<h1 class="sectionedit3" id="others">Others</h1>
<div class="level1">

<div><div id="nojs_indexmenu_1714540971583579d67f210" data-jsajax="" class="indexmenu_nojs">

<ul class="idx">
<li class="level1"><div class="li"><a href="../res/bilbiografie.html" class="wikilink1" title="iot2015:res:bilbiografie">Bibliography</a></div></li>
<li class="level1"><div class="li"><a href="../res/components.html" class="wikilink1" title="iot2015:res:components">Components</a></div></li>
<li class="level1"><div class="li"><a href="../res/electronics.html" class="wikilink1" title="iot2015:res:electronics">Electronics</a></div></li>
<li class="level1"><div class="li"><a href="../res/installingtools.html" class="wikilink1" title="iot2015:res:installingtools">App Inventor - Installing tools</a></div></li>
<li class="level1"><div class="li"><a href="../res/resistors.html" class="wikilink1" title="iot2015:res:resistors">Resistor Color Code</a></div></li>
<li class="level1"><div class="li"><a href="../res/streams.html" class="wikilink1" title="iot2015:res:streams">Streams nodes</a></div></li>
<li class="level1"><div class="li"><a href="../res/tipsandtricks.html" class="wikilink1" title="iot2015:res:tipsandtricks">Tips &amp; Tricks</a></div></li>
<li class="level1"><div class="li"><a href="../res/wyliodrin.html" class="wikilink1" title="iot2015:res:wyliodrin">Wyliodrin</a></div></li>
</ul>
</div></div>



</div>
<!-- EDIT3 SECTION "Others" [106-] -->
</div>
<div class="toc_sidebar sidebar_box">
<!-- TOC START -->
<div id="sb__right__dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level2"><div class="li"><a href="11.html#lab_11web_services">Lab 11: Web Services</a></div></li>
<li class="level2"><div class="li"><a href="11.html#chat">1) Chat</a></div></li>
<li class="level2"><div class="li"><a href="11.html#newsfeed">2) Newsfeed</a></div></li>
<li class="level2"><div class="li"><a href="11.html#comunicate_with_webservers_from_your_boards">3) Comunicate with webservers from your boards</a></div></li>
</ul>
</div>
</div>
<!-- TOC END -->
</div>
        </div>
      
    
      <div class="stylefoot">
        <div class="meta">
          <div class="user">
                    </div>
          <div class="doc">
          iot2015/labs/11.txt · Last modified: 2016/06/17 15:45 (external edit)          </div>
        </div>
      </div>

    <div class="clearer"></div>

    
                <div class="bar" id="bar__bottom">
      <div class="bar-left">
        <a href="11%3Fdo=revisions.html"  class="action revs" accesskey="o" rel="nofollow" title="Old revisions [O]">Old revisions</a>      </div>
      <div class="bar-right">
        <a href="11%3Fdo=media&amp;ns=iot2015%253Alabs.html"  class="action media" rel="nofollow" title="Media Manager">Media Manager</a><a href="11.html#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]">Back to top</a>      </div>
    </div>
    <div class="clearer"></div>
            
    <div align="center" class="footerinc">
  <div class="license"><a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license"><img src="../../lib/images/license/button/cc-by-sa.png" alt="CC Attribution-Share Alike 3.0 Unported" /></a></div>
  <a target="_blank" href="http://www.chimeric.de" title="www.chimeric.de"><img src="../../lib/tpl/arctic/images/button-chimeric-de.png" width="80" height="15" alt="www.chimeric.de" border="0" /></a>

  <a target="_blank" href="http://jigsaw.w3.org/css-validator/check/referer" title="Valid CSS"><img src="../../lib/tpl/arctic/images/button-css.png" width="80" height="15" alt="Valid CSS" border="0" /></a>

  <a target="_blank" href="http://wiki.splitbrain.org/wiki:dokuwiki" title="Driven by DokuWiki"><img src="../../lib/tpl/arctic/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" border="0" /></a>

  <a target="_blank" href="http://www.firefox-browser.de" title="do yourself a favour and use a real browser - get firefox"><img src="../../lib/tpl/arctic/images/button-firefox.png" width="80" height="15" alt="do yourself a favour and use a real browser - get firefox!!" border="0" /></a>
  
  <a target="_blank" href="../../feed.php" title="Recent changes RSS feed"><img src="../../lib/tpl/arctic/images/button-rss.png" width="80" height="15" alt="Recent changes RSS feed" border="0" /></a>

  <a target="_blank" href="http://validator.w3.org/check/referer" title="Valid XHTML 1.0"><img src="../../lib/tpl/arctic/images/button-xhtml.png" width="80" height="15" alt="Valid XHTML 1.0" border="0" /></a>
</div>

  </div>
</div>

<div class="no"><img src="../../lib/exe/indexer.php%3Fid=iot2015%253Alabs%253A11&amp;1479899606" width="2" height="1" alt="" /></div>
</body>
</html>
