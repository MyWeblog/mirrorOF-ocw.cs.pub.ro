    
    

<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <title>sasc:res:stuff</title>
<meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="date" content="2016-04-26T11:35:30+0300"/>
<meta name="keywords" content="sasc,res,stuff"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../../../lib/exe/opensearch.php" title="CS Open CourseWare"/>
<link rel="start" href="../../../../../courses.1.html"/>
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="../../../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="../../../../feed.php%3Fmode=list&amp;ns=sasc:res"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="stuff.html"/>
<link rel="canonical" href="../../../../sasc/res/stuff.html"/>
<link rel="stylesheet" type="text/css" href="../../../../lib/exe/css.php%3Ft=arctic&amp;tseed=1476798676.css"/>
<script type="text/javascript">/*<![CDATA[*/var NS='sasc:res';var JSINFO = {"id":"sasc:res:stuff","namespace":"sasc:res","isadmin":0,"isauth":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../../../lib/exe/js.php%3Ftseed=1476798676"></script>
<script type="text/x-mathjax-config">/*<![CDATA[*/MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ["$","$"], ["\\(","\\)"] ],
        displayMath: [ ["$$","$$"], ["\\[","\\]"] ],
        processEscapes: true
    }
});
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<script type="text/javascript">/*<![CDATA[*/
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
		  
/*!]]>*/</script>
<script type="text/javascript">/*<![CDATA[*/
var pageTracker = _gat._getTracker("UA-38383934-1");
pageTracker._initData();
pageTracker._trackPageview();
		  
/*!]]>*/</script>
</head>
<body>
<div class="dokuwiki export">
<!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level2"><div class="li"><a href="stuff.html#diverse_exercitii">Diverse exercitii</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="stuff.html#feistel_networks">Feistel networks</a></div></li>
<li class="level3"><div class="li"><a href="stuff.html#decryption_modes">Decryption modes</a></div></li>
<li class="level3"><div class="li"><a href="stuff.html#substitution-permutation_networks">Substitution-Permutation networks</a></div></li>
<li class="level3"><div class="li"><a href="stuff.html#more_on_subsitution-permutation">More on subsitution-permutation</a></div></li>
<li class="level3"><div class="li"><a href="stuff.html#hmac_timing_attack">HMAC Timing attack</a></div></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h2 class="sectionedit1" id="diverse_exercitii">Diverse exercitii</h2>
<div class="level2">

</div>
<!-- EDIT1 SECTION "Diverse exercitii" [1-31] -->
<h3 class="sectionedit2" id="feistel_networks">Feistel networks</h3>
<div class="level3">

<p>
How can you distinguish a cipher composed only of a Feistel network from a random function if it has
only (a) one round, (b) two rounds?
</p>

<p>
For clarity, here is an image of such a cipher with two rounds:
<a href="../../../../_media/sasc/res/screen_shot_2015-04-01_at_20.22.12.png" class="media" title="sasc:res:screen_shot_2015-04-01_at_20.22.12.png"><img src="../../../../_media/sasc/res/screen_shot_2015-04-01_at_20.22.12.png%3Fw=200&amp;tok=450ed2" class="media" alt="" width="200" /></a>
</p>

</div>
<!-- EDIT2 SECTION "Feistel networks" [32-327] -->
<h3 class="sectionedit3" id="decryption_modes">Decryption modes</h3>
<div class="level3">

<p>
A sequence of plaintext blocks M1, . . . , M8 is encrypted using DES into a sequence of ciphertext blocks. Where an IV is used, it is numbered C0. A transmission error occurs and one bit in ciphertext block C3 changes its value. As a consequence, the receiver obtains after decryption a corrupted plaintext block sequence M1′,…,M8′. For the discussed modes of operation (ECB, CBC), how many bits do you expect to be wrong in each block Mi′? (Hint: You may find it helpful to draw decryption block diagrams.)
</p>

<p>
Please motivate your answer.
</p>

</div>
<!-- EDIT3 SECTION "Decryption modes" [328-902] -->
<h3 class="sectionedit4" id="substitution-permutation_networks">Substitution-Permutation networks</h3>
<div class="level3">

<p>
Now we have a better SPN, where the output of the permutation is XOR-ed with another 2 key bytes, as in the following figure:
<a href="../../../../_detail/sasc/laboratoare/spn_1r_full_2s.png%3Fid=sasc%253Ares%253Astuff.html" class="media" title="sasc:laboratoare:spn_1r_full_2s.png"><img src="../../../../_media/sasc/laboratoare/spn_1r_full_2s.png" class="media" alt="" /></a>
</p>
<ol>
<li class="level1"><div class="li"> Try to find the key in this case, when given the following message/ciphertext pairs: (&#039;Om&#039;, 0x0073), (&#039;El&#039;, 0xd00e), (&#039;an&#039;, 0x855b). Print the key in ascii.</div>
</li>
</ol>

<p>
<p><div class="notetip">You may try some kind of brute-force search
</div></p>
</p>

</div>
<!-- EDIT4 SECTION "Substitution-Permutation networks" [903-1342] -->
<h3 class="sectionedit5" id="more_on_subsitution-permutation">More on subsitution-permutation</h3>
<div class="level3">

<p>
As another example, which uses a larger block size, let&#039;s use an SPN that takes a 4-byte input x=[x1 || x2 || x3 || x4] and an 8-byte key k=[k1 || k2 || k3 || k4 || k5 || k6 || k7 || k8] as in this figure:
<a href="../../../../_detail/sasc/laboratoare/spn_1r_full_4s.png%3Fid=sasc%253Ares%253Astuff.html" class="media" title="sasc:laboratoare:spn_1r_full_4s.png"><img src="../../../../_media/sasc/laboratoare/spn_1r_full_4s.png" class="media" alt="" /></a>
</p>

<p>
Note that in this 4-byte SPN, the permutation operates on all 4 bytes, similarly to the 2-byte SPN: that is, it shifts all bits four bits to the right.
</p>
<ol>
<li class="level1"><div class="li"> Try to find the key in this case as well, using the following message/ciphertext pairs: (&#039;Omul&#039;, 0xddcf7bc7), (&#039;stea&#039;, 0x96d58b43), (&#039;luna&#039;, 0x9c3f2303) . Again print the key in ascii.</div>
</li>
</ol>

<p>
<p><div class="notetip"> This time you cannot (easily) do a brute-force on all the bytes of the last XOR. However, you may try to attack one S-box at a time. Think of the bits that affect one such S-box and find an efficient attack.

</div></p>
</p>

</div>
<!-- EDIT5 SECTION "More on subsitution-permutation" [1343-2205] -->
<h3 class="sectionedit6" id="hmac_timing_attack">HMAC Timing attack</h3>
<div class="level3">

<p>
In this exercise you will perform a timing attack against HMAC.
</p>

<p>
You are given access to an HMAC $\mathsf{Verify}$ oracle, which tests whether the received HMAC matches the one computed using the secret key. Timing attacks exploit naive equality comparisons between the received and computed HMACs (for example, the comparison is done byte by byte; more checks means more latency).
</p>

<p>
Your task is to produce a forged tag for the message &#039;Test&#039; without knowing the key. Do this by iterating through all possible values for a specific byte; when the oracle&#039;s latency for a certain value seems larger than the rest, it suggests that the equality test returned True and the oracle passed to the next byte.
</p>

<p>
Try to start by finding the first byte and checking your result with the TA.
</p>

<p>
You can use <code>time.clock()</code> before and after each oracle query to measure its runtime.
</p>

<p>
<p><div class="noteimportant">
The oracle&#039;s latency is subject to noise; for the best results, you will need to run each query multiple times (try at least 30) and compute the mean latency.

</div></p>
</p>
<dl class="file">
<dt><a href="../../../code/sasc/res/stuff%3Fcodeblock=0" title="Download Snippet" class="mediafile mf_py">timing.py</a></dt>
<dd><pre class="code file python"><span class="kw1">import</span> <span class="kw3">sys</span>
<span class="kw1">import</span> <span class="kw3">random</span>
<span class="kw1">import</span> <span class="kw3">string</span>
<span class="kw1">import</span> <span class="kw3">time</span>
<span class="kw1">import</span> <span class="kw3">itertools</span>
<span class="kw1">import</span> <span class="kw3">operator</span>
<span class="kw1">import</span> <span class="kw3">base64</span>
&nbsp;
<span class="kw1">from</span> Crypto.<span class="me1">Hash</span>.<span class="me1">HMAC</span> <span class="kw1">import</span> HMAC
&nbsp;
<span class="kw1">def</span> raw2hex<span class="br0">&#40;</span>raw<span class="br0">&#41;</span>:
    <span class="kw1">return</span> raw.<span class="me1">encode</span><span class="br0">&#40;</span><span class="st0">'hex'</span><span class="br0">&#41;</span>
&nbsp;
&nbsp;
<span class="kw1">def</span> hex2raw<span class="br0">&#40;</span>hexstring<span class="br0">&#41;</span>:
    <span class="kw1">return</span> <span class="kw3">base64</span>.<span class="me1">b16decode</span><span class="br0">&#40;</span>hexstring<span class="br0">&#41;</span>
&nbsp;
&nbsp;
<span class="kw1">def</span> slow_foo<span class="br0">&#40;</span><span class="br0">&#41;</span>:
    p <span class="sy0">=</span> <span class="nu0">181</span>
    k <span class="sy0">=</span> <span class="nu0">2</span>
    <span class="kw1">while</span> k <span class="sy0">&lt;</span> p:
        <span class="kw1">if</span> p % k <span class="sy0">==</span> <span class="nu0">0</span>:
            <span class="kw1">return</span>
        k +<span class="sy0">=</span> <span class="nu0">1</span>
&nbsp;
&nbsp;
<span class="kw1">def</span> verify<span class="br0">&#40;</span>message<span class="sy0">,</span> tag<span class="br0">&#41;</span>:
    k <span class="sy0">=</span> <span class="st0">'0123456789ABCDEF'</span>
&nbsp;
    <span class="co1"># Use MD5 for HMAC</span>
    digest <span class="sy0">=</span> HMAC<span class="br0">&#40;</span>k<span class="sy0">,</span> message<span class="br0">&#41;</span>.<span class="me1">digest</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
&nbsp;
    <span class="kw1">for</span> i <span class="kw1">in</span> <span class="kw2">range</span><span class="br0">&#40;</span><span class="nu0">16</span><span class="br0">&#41;</span>:
        <span class="co1"># Artificially extend byte comparison duration</span>
        slow_foo<span class="br0">&#40;</span><span class="br0">&#41;</span>
        <span class="kw1">if</span> tag<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="sy0">!=</span> digest<span class="br0">&#91;</span>i<span class="br0">&#93;</span>:
            <span class="kw1">return</span> <span class="kw2">False</span>
&nbsp;
    <span class="kw1">return</span> <span class="kw2">True</span>
&nbsp;
&nbsp;
hexdigits <span class="sy0">=</span> <span class="st0">'0123456789ABCDEF'</span>
&nbsp;
&nbsp;
<span class="kw1">def</span> main<span class="br0">&#40;</span><span class="br0">&#41;</span>:
    message <span class="sy0">=</span> <span class="st0">'Test'</span>
&nbsp;
    <span class="co1"># Step 1. Iterate through all possible first byte values, and call the</span>
    <span class="co1"># Verify oracle for each of them</span>
&nbsp;
    <span class="co1"># Step 2. Store the byte which caused the longest computation time</span>
&nbsp;
    <span class="co1"># Step 3. Continue the operation for each byte (except the last)</span>
&nbsp;
    <span class="co1"># Step 4. Guess the last byte, and query the oracle with the complete tag</span>
    mytag <span class="sy0">=</span> <span class="st0">'???'</span>
    result <span class="sy0">=</span> verify<span class="br0">&#40;</span>message<span class="sy0">,</span> mytag<span class="br0">&#41;</span>
    <span class="kw1">if</span> result <span class="sy0">==</span> <span class="kw2">True</span>:
        <span class="kw1">print</span> mytag
&nbsp;
&nbsp;
<span class="kw1">if</span> __name__ <span class="sy0">==</span> <span class="st0">&quot;__main__&quot;</span>:
    main<span class="br0">&#40;</span><span class="br0">&#41;</span></pre>
</dd></dl>

</div>
<!-- EDIT6 SECTION "HMAC Timing attack" [2206-] --></div>
</body>
</html>
