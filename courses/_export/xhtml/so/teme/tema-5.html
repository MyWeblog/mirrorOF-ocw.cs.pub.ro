    
    

<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <title>so:teme:tema-5</title>
<meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="date" content="2016-05-28T11:00:23+0300"/>
<meta name="keywords" content="so,teme,tema-5"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../../../lib/exe/opensearch.php" title="CS Open CourseWare"/>
<link rel="start" href="../../../../../courses.1.html"/>
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="../../../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="../../../../feed.php%3Fmode=list&amp;ns=so:teme"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="tema-5.html"/>
<link rel="canonical" href="../../../../so/teme/tema-5.html"/>
<link rel="stylesheet" type="text/css" href="../../../../lib/exe/css.php%3Ft=arctic&amp;tseed=1476798676.css"/>
<script type="text/javascript">/*<![CDATA[*/var NS='so:teme';var JSINFO = {"id":"so:teme:tema-5","namespace":"so:teme","isadmin":0,"isauth":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../../../lib/exe/js.php%3Ftseed=1476798676"></script>
<script type="text/x-mathjax-config">/*<![CDATA[*/MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ["$","$"], ["\\(","\\)"] ],
        displayMath: [ ["$$","$$"], ["\\[","\\]"] ],
        processEscapes: true
    }
});
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<script type="text/javascript">/*<![CDATA[*/
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
		  
/*!]]>*/</script>
<script type="text/javascript">/*<![CDATA[*/
var pageTracker = _gat._getTracker("UA-38383934-1");
pageTracker._initData();
pageTracker._trackPageview();
		  
/*!]]>*/</script>
</head>
<body>
<div class="dokuwiki export">
<!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="tema-5.html#tema_5_server_web_asincron">Tema 5 Server web asincron</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="tema-5.html#obiectivele_temei">Obiectivele temei</a></div></li>
<li class="level2"><div class="li"><a href="tema-5.html#enunt">Enunț</a></div></li>
<li class="level2"><div class="li"><a href="tema-5.html#precizarirecomandari_pentru_implementare">Precizări/recomandări pentru implementare</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="tema-5.html#resurse_utile">Resurse utile</a></div></li>
<li class="level3"><div class="li"><a href="tema-5.html#depanaretroubleshooting">Depanare/troubleshooting</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="tema-5.html#precizari_pentru_windows">Precizări pentru Windows</a></div></li>
<li class="level2"><div class="li"><a href="tema-5.html#precizari_pentru_linux">Precizări pentru Linux</a></div></li>
<li class="level2"><div class="li"><a href="tema-5.html#testare">Testare</a></div></li>
<li class="level2"><div class="li"><a href="tema-5.html#resurse_de_suport">Resurse de suport</a></div></li>
<li class="level2"><div class="li"><a href="tema-5.html#faq">FAQ</a></div></li>
<li class="level2"><div class="li"><a href="tema-5.html#suport_intrebari_si_clarificari">Suport, întrebări și clarificări</a></div></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="tema_5_server_web_asincron">Tema 5 Server web asincron</h1>
<div class="level1">

<p>
<p><div class="noteimportant">
Dată publicare: <strong>12 Mai 2016</strong>
</p>

<p>
Deadline hard: <strong>25 Mai 2016, ora 23:55</strong>

</div></p>
</p>

</div>
<!-- EDIT1 SECTION "Tema 5 Server web asincron" [1-143] -->
<h2 class="sectionedit2" id="obiectivele_temei">Obiectivele temei</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li">Aprofundarea noțiunilor legate de lucrul cu sockeți.</div>
</li>
<li class="level1"><div class="li">Deprinderi de implementare și proiectare a aplicațiilor care folosesc operații asincrone și alte operații I/O avansate.</div>
</li>
<li class="level1"><div class="li">Aprofundarea utilizării <abbr title="Application Programming Interface">API</abbr>-ului pentru operații I/O avansate la nivelul sistemelor de operare Linux și Windows.</div>
</li>
</ul>

</div>
<!-- EDIT2 SECTION "Obiectivele temei" [144-480] -->
<h2 class="sectionedit3" id="enunt">Enunț</h2>
<div class="level2">

<p>
Să se implementeze un server web care să folosească operații avansate de intrare/ieșire:
</p>
<ul>
<li class="level1"><div class="li">operații asincrone pe fișiere;</div>
</li>
<li class="level1"><div class="li">operații non-blocante pe sockeți;</div>
</li>
<li class="level1"><div class="li">zero-copying;</div>
</li>
<li class="level1"><div class="li">multiplexarea operațiilor I/O.</div>
</li>
</ul>

<p>
Pentru implementare se va folosi <abbr title="Application Programming Interface">API</abbr>-ul de operații I/O avansate specific sistemelor de operare Linux și Windows:
</p>
<ul>
<li class="level1"><div class="li"><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sendfile.2.html" class="urlextern" title="http://www.kernel.org/doc/man-pages/online/pages/man2/sendfile.2.html"  rel="nofollow"> sendfile</a>/<a href="http://msdn.microsoft.com/en-us/library/ms740565(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms740565(VS.85).aspx"  rel="nofollow"> TransmitFile</a></div>
</li>
<li class="level1"><div class="li"><a href="http://www.kernel.org/doc/man-pages/online/pages/man2/io_setup.2.html" class="urlextern" title="http://www.kernel.org/doc/man-pages/online/pages/man2/io_setup.2.html"  rel="nofollow"> io_setup &amp; friends</a>/<a href="http://msdn.microsoft.com/en-us/library/aa365683(v=VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa365683(v=VS.85).aspx"  rel="nofollow"> Overlapped I/O</a></div>
</li>
<li class="level1"><div class="li"><a href="http://man7.org/linux/man-pages/man7/epoll.7.html" class="urlextern" title="http://man7.org/linux/man-pages/man7/epoll.7.html"  rel="nofollow"> epoll</a>/<a href="http://msdn.microsoft.com/en-us/library/aa365198(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa365198(VS.85).aspx"  rel="nofollow"> Completion Ports</a>.</div>
</li>
</ul>

<p>
Serverul web va utiliza <abbr title="Application Programming Interface">API</abbr>-ul modern de multiplexare pentru a aștepta conexiuni din partea clienților: <a href="http://man7.org/linux/man-pages/man7/epoll.7.html" class="urlextern" title="http://man7.org/linux/man-pages/man7/epoll.7.html"  rel="nofollow"> epoll</a> (Linux) și <a href="http://msdn.microsoft.com/en-us/library/aa365198(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa365198(VS.85).aspx"  rel="nofollow"> Completion Ports</a> pe Windows. Pe conexiunile realizate se vor recepționa cereri din partea clienților și apoi se vor distribui răspunsurile către aceștia.
</p>

<p>
Clienții și serverul vor comunica folosind protocolul HTTP. Pentru parsarea cererilor HTTP din partea clienților recomandăm folosirea <a href="http://github.com/joyent/http-parser" class="urlextern" title="http://github.com/joyent/http-parser"  rel="nofollow"> acestui parser HTTP</a>, disponibil și în cadrul <a href="http://elf.cs.pub.ro/so/res/teme/tema5-util/" class="urlextern" title="http://elf.cs.pub.ro/so/res/teme/tema5-util/"  rel="nofollow"> directorului de resurse ale temei</a>. Va trebui să folosiți un callback pentru obținerea căii către resursa locală solicitată de client. Tot în directorul de resurse, găsiți un exemplu simplificat de folosire a parser-ului.
</p>

<p>
Serverul implementează o <strong>funcționalitate limitată</strong> a protocolului HTTP, aceea de a <strong>transmite fișiere clienților</strong>. Serverul va furniza fișiere din directorul <code>AWS_DOCUMENT_ROOT</code>, definit în cadrul antetului temei. Fișiere se găsesc doar în subdirectoarele <code>AWS_DOCUMENT_ROOT/static/</code>, respectiv <code>AWS_DOCUMENT_ROOT/dynamic/</code>, iar <em>request path</em>-uri corespunzătoare vor fi, de exemplu, <code>AWS_DOCUMENT_ROOT/static/test.dat</code>, respectiv <code>AWS_DOCUMENT_ROOT/dynamic/test.dat</code>. Prelucrarea fișierelor va fi următoarea:
</p>
<ul>
<li class="level1"><div class="li">Fișierele din directorul <code>AWS_DOCUMENT_ROOT/static/</code> sunt fișiere statice care vor fi transmise clienților folosind <abbr title="Application Programming Interface">API</abbr> de zero-copying (<a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sendfile.2.html" class="urlextern" title="http://www.kernel.org/doc/man-pages/online/pages/man2/sendfile.2.html"  rel="nofollow"> sendfile</a>/<a href="http://msdn.microsoft.com/en-us/library/ms740565(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms740565(VS.85).aspx"  rel="nofollow"> TransmitFile</a>).</div>
</li>
<li class="level1"><div class="li">Fișierele din directorul <code>AWS_DOCUMENT_ROOT/dynamic/</code> sunt fișiere pentru care se presupune că este necesară o fază de post-procesare din partea serverului. Aceste fișiere vor fi citite de pe disc folosind <abbr title="Application Programming Interface">API</abbr> asincron și apoi vor fi transmise către clienți. Transmiterea va folosi sockeți non-blocanți (Linux) și Overlapped I/O pe sockeți (Windows).</div>
</li>
<li class="level1"><div class="li">Pentru <em>request path</em>-uri nevalide se va transmite un mesaj <a href="http://en.wikipedia.org/wiki/HTTP_404" class="urlextern" title="http://en.wikipedia.org/wiki/HTTP_404"  rel="nofollow"> HTTP 404</a>.</div>
</li>
</ul>

<p>
După transmiterea unui fișier, conform protocolului HTTP, conexiunea este închisă.
</p>

</div>
<!-- EDIT3 SECTION "Enunț" [481-3687] -->
<h2 class="sectionedit4" id="precizarirecomandari_pentru_implementare">Precizări/recomandări pentru implementare</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li">Implementarea temei presupune existența unei mașini de stări pentru fiecare conexiune, pe care să o interogați și actualizați periodic pe măsura desfășurării transferului.</div>
<ul>
<li class="level2"><div class="li">Recomandăm crearea unei structuri care să gestioneze o conexiune, starea acesteia, conținutul bufferelor.</div>
</li>
</ul>
</li>
<li class="level1"><div class="li">Definițiile macro-urilor și structurilor utile se găsesc în <a href="http://elf.cs.pub.ro/so/res/teme/tema5-util/aws.h" class="urlextern" title="http://elf.cs.pub.ro/so/res/teme/tema5-util/aws.h"  rel="nofollow"> header-ul temei</a>.</div>
</li>
<li class="level1"><div class="li">Răspunsurile HTTP vor avea codul 200 pentru fișiere existente și 404 pentru fișiere inexistente.</div>
<ul>
<li class="level2"><div class="li">Un răspuns valid este format din antetul HTTP, conținând directivele aferente, două newline-uri (<code>\r\n\r\n</code>), urmat de conținutul efectiv (fișierul).</div>
</li>
<li class="level2"><div class="li">Exemple de răspunsuri găsiți în <a href="http://elf.cs.pub.ro/so/res/teme/tema5-util/http-parser/test.c" class="urlextern" title="http://elf.cs.pub.ro/so/res/teme/tema5-util/http-parser/test.c"  rel="nofollow"> fișierul de test al parser-ului</a> sau în <a href="http://elf.cs.pub.ro/so/res/teme/tema5-util/http-parser/samples/test_get_request_path.c" class="urlextern" title="http://elf.cs.pub.ro/so/res/teme/tema5-util/http-parser/samples/test_get_request_path.c"  rel="nofollow"> sample-ul pus la dispoziție</a>.</div>
</li>
<li class="level2"><div class="li">Puteți folosi directive de request predefinite, precum <code>Date</code>, <code>Last-Modified</code> etc.</div>
<ul>
<li class="level3"><div class="li">Directiva <code>Content-Length</code> trebuie să precizeze dimensiunea conținutului HTTP (datelor efective) la nivel de octeți.</div>
</li>
<li class="level3"><div class="li">Directiva <code>Connection</code> trebuie inițializată la <code>close</code>.</div>
</li>
</ul>
</li>
</ul>
</li>
<li class="level1"><div class="li">Portul pe care serverul web ascultă pentru conexiuni este definit în cadrul <a href="http://elf.cs.pub.ro/so/res/teme/tema5-util/aws.h" class="urlextern" title="http://elf.cs.pub.ro/so/res/teme/tema5-util/aws.h"  rel="nofollow"> header-ului temei</a> ca macro: <code>AWS_LISTEN_PORT</code>.</div>
</li>
<li class="level1"><div class="li">Directorul rădăcină raportat la care se caută resursele/fișierele este definit în cadrul <a href="http://elf.cs.pub.ro/so/res/teme/tema5-util/aws.h" class="urlextern" title="http://elf.cs.pub.ro/so/res/teme/tema5-util/aws.h"  rel="nofollow"> header-ului temei</a> ca macro: <code>AWS_DOCUMENT_ROOT</code>.</div>
</li>
</ul>

</div>
<!-- EDIT4 SECTION "Precizări/recomandări pentru implementare" [3688-5410] -->
<h3 class="sectionedit5" id="resurse_utile">Resurse utile</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li">Pentru parsarea cererii HTTP și obținerea <em>request path</em>-ului puteți folosi <a href="http://github.com/joyent/http-parser" class="urlextern" title="http://github.com/joyent/http-parser"  rel="nofollow"> acest parser HTTP</a> disponibil și în directorul de resurse ale temei.</div>
<ul>
<li class="level2"><div class="li">Pentru compilare, folosiți fișierul <code>Makefile</code>.</div>
</li>
<li class="level2"><div class="li">Consultați fișierul <code>README.md</code>.</div>
</li>
<li class="level2"><div class="li">Un exemplu specific de folosire a parser-ului pentru obținerea <em>request path</em>-ului este disponibil în <a href="http://elf.cs.pub.ro/so/res/teme/tema5-util/http-parser/samples/" class="urlextern" title="http://elf.cs.pub.ro/so/res/teme/tema5-util/http-parser/samples/"  rel="nofollow"> subdirectorul samples/</a>.</div>
</li>
</ul>
</li>
<li class="level1"><div class="li">Pentru aspecte de depanare și tratare a erorilor, folosiți fișierele header disponibile.</div>
</li>
<li class="level1"><div class="li">Folosiți subdirectorul <code>samples/</code> din directorul aferent fiecărui sistem de operare pentru exemple de utilizare a <abbr title="Application Programming Interface">API</abbr>-ului pe sockeți.</div>
<ul>
<li class="level2"><div class="li">Găsiți implementat ca exemplu un server echo bazat pe <abbr title="Application Programming Interface">API</abbr> avansat de multiplexare.</div>
</li>
<li class="level2"><div class="li">Găsiți implementat ca exemplu un server care trimite un răspuns HTTP.</div>
</li>
</ul>
</li>
</ul>

</div>
<!-- EDIT5 SECTION "Resurse utile" [5411-6344] -->
<h3 class="sectionedit6" id="depanaretroubleshooting">Depanare/troubleshooting</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li">Pentru depanarea serverului, recomandăm folosirea <a href="http://linux.die.net/man/1/wget" class="urlextern" title="http://linux.die.net/man/1/wget"  rel="nofollow"> wget</a> și a <a href="http://linux.die.net/man/1/nc" class="urlextern" title="http://linux.die.net/man/1/nc"  rel="nofollow"> netcat</a>.</div>
<ul>
<li class="level2"><div class="li">Pentru netcat, dacă doriți să comunicați folosind HTTP, va trebui să transmiteți o cerere specifică (spre exemplu <code>GET /path/to/resource HTTP/1.0</code>). Exemplu de folosire:<pre class="code">$ nc localhost 8888
GET / HTTP/1.0
</pre>
</div>
<ul>
<li class="level3"><div class="li">Sau:<pre class="code">echo -ne &quot;GET / HTTP/1.0\r\n\r\n&quot; | nc -q 2 localhost 8888</pre>
</div>
</li>
</ul>
</li>
<li class="level2"><div class="li">Exemple de utilizare găsiți în <a href="tema-5.html#testare" title="so:teme:tema-5 ↵" class="wikilink1"> teste</a>.</div>
</li>
</ul>
</li>
</ul>

</div>
<!-- EDIT6 SECTION "Depanare/troubleshooting" [6345-6908] -->
<h2 class="sectionedit7" id="precizari_pentru_windows">Precizări pentru Windows</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li">Operațiile pe sockeți și fișiere (<a href="http://msdn.microsoft.com/en-us/library/aa365467(v=vs.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa365467(v=vs.85).aspx"  rel="nofollow"> ReadFile</a>, <a href="http://msdn.microsoft.com/en-us/library/ms742203(v=vs.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms742203(v=vs.85).aspx"  rel="nofollow"> WSASend</a>, <a href="http://msdn.microsoft.com/en-us/library/ms742203(v=vs.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms742203(v=vs.85).aspx"  rel="nofollow"> TransmitFile</a>) vor fi operații asincrone realizate folosind <a href="http://msdn.microsoft.com/en-us/library/aa365683(v=VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa365683(v=VS.85).aspx"  rel="nofollow"> Overlapped I/O</a>.</div>
</li>
<li class="level1"><div class="li">Așteptarea încheierii operațiilor asincrone (atât pe fișiere cât și pe sockeți) se va realiza unificat, folosind <a href="http://msdn.microsoft.com/en-us/library/aa365198(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa365198(VS.85).aspx"  rel="nofollow"> I/O Completion Ports</a>.</div>
</li>
<li class="level1"><div class="li">Pentru implementare, recomandăm să porniți de la <a href="http://elf.cs.pub.ro/so/res/teme/tema5-util/win/samples/iocp_echo_server.c" class="urlextern" title="http://elf.cs.pub.ro/so/res/teme/tema5-util/win/samples/iocp_echo_server.c"  rel="nofollow"> exemplul de echo server</a> pus la dispoziție.</div>
<ul>
<li class="level2"><div class="li"><abbr title="Application Programming Interface">API</abbr>-ul I/O Completion Ports este apelat prin intermediul wrapper-elor din cadrul header-ului <a href="http://elf.cs.pub.ro/so/res/teme/tema5-util/win/w_iocp.h" class="urlextern" title="http://elf.cs.pub.ro/so/res/teme/tema5-util/win/w_iocp.h"  rel="nofollow"> w_iocp.h</a>.</div>
</li>
</ul>
</li>
<li class="level1"><div class="li">Sockeți creați folosind apelul <a href="http://msdn.microsoft.com/en-us/library/ms740506(v=vs.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms740506(v=vs.85).aspx"  rel="nofollow"> socket</a> sunt sockeți ce pot fi folosiți pentru <a href="http://msdn.microsoft.com/en-us/library/aa365683(v=vs.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa365683(v=vs.85).aspx"  rel="nofollow"> operații asincrone</a>.</div>
</li>
<li class="level1"><div class="li">Pentru operații asincrone de comunicare pe sockeți folosiți funcțiile <a href="http://msdn.microsoft.com/en-us/library/ms742203(v=vs.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms742203(v=vs.85).aspx"  rel="nofollow"> WSASend</a>. respectiv <a href="http://msdn.microsoft.com/en-us/library/ms741688(v=vs.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms741688(v=vs.85).aspx"  rel="nofollow"> WSARecv</a>.</div>
<ul>
<li class="level2"><div class="li">Structura <a href="http://msdn.microsoft.com/en-us/library/ms741665(v=vs.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms741665(v=vs.85).aspx"  rel="nofollow"> WSAOVERLAPPED</a> conține informațiile necesare pentru operațiile asincrone pe sockeți. Este echivalentă structurii <a href="http://msdn.microsoft.com/en-us/library/ms684342(v=vs.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms684342(v=vs.85).aspx"  rel="nofollow"> OVERLAPPED</a>.</div>
</li>
</ul>
</li>
<li class="level1"><div class="li">Pentru adăugarea socket-ului listener în I/O Completion Port, va trebui să folosiți apelul <a href="http://msdn.microsoft.com/en-us/library/ms737524(v=vs.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms737524(v=vs.85).aspx"  rel="nofollow"> AcceptEx</a>, așa cum se observă și în <a href="http://elf.cs.pub.ro/so/res/teme/tema5-util/win/samples/iocp_echo_server.c" class="urlextern" title="http://elf.cs.pub.ro/so/res/teme/tema5-util/win/samples/iocp_echo_server.c"  rel="nofollow"> exemplul de echo server</a>.</div>
<ul>
<li class="level2"><div class="li"><a href="http://msdn.microsoft.com/en-us/library/ms737524(v=vs.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms737524(v=vs.85).aspx"  rel="nofollow"> AcceptEx</a> permite notificarea unei acțiuni în momentul în care aceasta are loc, împreună cu binding-ul socket-ului.</div>
</li>
</ul>
</li>
<li class="level1"><div class="li">Pentru operații asincrone cu sistemul de fișiere, folosiți funcțiile <a href="http://msdn.microsoft.com/en-us/library/aa365467(VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa365467(VS.85).aspx"  rel="nofollow"> ReadFile</a> și <a href="http://msdn.microsoft.com/en-us/library/aa365747(v=VS.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/aa365747(v=VS.85).aspx"  rel="nofollow"> WriteFile</a> cu argumentele de Overlapped I/O activate.</div>
</li>
<li class="level1"><div class="li">Pentru obținerea de informații despre o operație asincronă încheiată (prin intermediul structurii <a href="http://msdn.microsoft.com/en-us/library/ms684342(v=vs.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms684342(v=vs.85).aspx"  rel="nofollow"> OVERLAPPED</a>), folosiți <a href="http://msdn.microsoft.com/en-us/library/ms683209(v=vs.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms683209(v=vs.85).aspx"  rel="nofollow"> GetOverlappedResult</a> (fișiere), respectiv <a href="http://msdn.microsoft.com/en-us/library/ms741582(v=vs.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms741582(v=vs.85).aspx"  rel="nofollow"> WSAGetOverlappedResult</a> (sockeți).</div>
</li>
<li class="level1"><div class="li">Transmiterea de fișiere statice se realizează folosind <a href="http://msdn.microsoft.com/en-us/library/ms740565(v=vs.85).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/ms740565(v=vs.85).aspx"  rel="nofollow"> TransmitFile</a>.</div>
</li>
<li class="level1"><div class="li">Tema se va rezolva folosind doar funcții Win32. Se pot folosi de asemenea și funcțiile de formatare <code>printf</code>, <code>scanf</code>, funcțiile de alocare de memorie <code>malloc</code>, <code>free</code> și funcțiile de manipulare a șirurilor de caractere (<code>strcat</code>, <code>strcmp</code> etc.).</div>
</li>
<li class="level1"><div class="li">Pentru partea de I/O și procese se vor folosi doar funcții Win32. De exemplu, funcțiile <code>open</code>, <code>read</code>, <code>write</code>, <code>close</code> nu trebuie folosite; în locul acestora folosiți <code>CreateFile</code>, <code>ReadFile</code>, <code>WriteFile</code>, <code>CloseHandle</code>.</div>
</li>
</ul>

</div>
<!-- EDIT7 SECTION "Precizări pentru Windows" [6909-10548] -->
<h2 class="sectionedit8" id="precizari_pentru_linux">Precizări pentru Linux</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li">Atât citirea cât și scrierea peste sockeți se realizează doar la notificarea dată de <abbr title="Application Programming Interface">API</abbr>-ul specific sistemului de operare, folosind <a href="http://man7.org/linux/man-pages/man7/epoll.7.html" class="urlextern" title="http://man7.org/linux/man-pages/man7/epoll.7.html"  rel="nofollow"> epoll</a>.</div>
<ul>
<li class="level2"><div class="li">Tot folosind <a href="http://man7.org/linux/man-pages/man7/epoll.7.html" class="urlextern" title="http://man7.org/linux/man-pages/man7/epoll.7.html"  rel="nofollow"> epoll</a> se va aștepta notificarea încheierii operațiilor asincrone pe fișiere.</div>
</li>
</ul>
</li>
<li class="level1"><div class="li">Pentru implementare, recomandăm să porniți de la <a href="http://elf.cs.pub.ro/so/res/teme/tema5-util/lin/samples/epoll_echo_server.c" class="urlextern" title="http://elf.cs.pub.ro/so/res/teme/tema5-util/lin/samples/epoll_echo_server.c"  rel="nofollow"> exemplul de echo server</a> pus la dispoziție.</div>
<ul>
<li class="level2"><div class="li"><abbr title="Application Programming Interface">API</abbr>-ul epoll este apelat prin intermediul wrapper-elor din cadrul header-ului <a href="http://elf.cs.pub.ro/so/res/teme/tema5-util/lin/w_epoll.h" class="urlextern" title="http://elf.cs.pub.ro/so/res/teme/tema5-util/lin/w_epoll.h"  rel="nofollow"> w_epoll.h</a>.</div>
</li>
</ul>
</li>
<li class="level1"><div class="li">Scrierea pe sockeți, atât în cazul fișierelor statice, cât și în cazul fișierelor dinamice, se realizează non-blocant: sockeții sunt marcați ca non-blocanți, iar la un apel de scriere se scrie cât permite buffer-ul socketului. La următoarea notificare din partea <abbr title="Application Programming Interface">API</abbr>-ului specific se va realiza o nouă scriere și așa mai departe.</div>
<ul>
<li class="level2"><div class="li">Pentru configurarea unui socket ca non-blocant puteți folosi <a href="http://www.kernel.org/doc/man-pages/online/pages/man2/fcntl.2.html" class="urlextern" title="http://www.kernel.org/doc/man-pages/online/pages/man2/fcntl.2.html"  rel="nofollow"> fcntl</a> (flag-ul <code>O_NONBLOCK</code>).</div>
</li>
</ul>
</li>
<li class="level1"><div class="li">Pentru implementarea operațiilor I/O, folosiți funcțiile din familia <a href="http://www.kernel.org/doc/man-pages/online/pages/man2/io_setup.2.html" class="urlextern" title="http://www.kernel.org/doc/man-pages/online/pages/man2/io_setup.2.html"  rel="nofollow"> io_setup</a>.</div>
<ul>
<li class="level2"><div class="li">Pentru utilizarea funcțiilor va trebui să realizați link-area cu <a href="http://lse.sourceforge.net/io/aio.html" class="urlextern" title="http://lse.sourceforge.net/io/aio.html"  rel="nofollow"> biblioteca libaio</a> și includerea header-ului <code>&lt;libaio.h&gt;</code>.</div>
</li>
<li class="level2"><div class="li">Recomandăm folosirea unei variabile de tipul <code>io_context_t</code> și a unui descriptor <a href="http://www.kernel.org/doc/man-pages/online/pages/man2/eventfd.2.html" class="urlextern" title="http://www.kernel.org/doc/man-pages/online/pages/man2/eventfd.2.html"  rel="nofollow"> eventfd</a> pentru fiecare conexiune.</div>
</li>
<li class="level2"><div class="li">Pentru încheierea operațiilor asincrone, folosiți <a href="http://www.kernel.org/doc/man-pages/online/pages/man2/io_getevents.2.html" class="urlextern" title="http://www.kernel.org/doc/man-pages/online/pages/man2/io_getevents.2.html"  rel="nofollow"> io_getevents</a>.</div>
</li>
<li class="level2"><div class="li">Puteți consulta <a href="http://www.xmailserver.org/eventfd-aio-test.c" class="urlextern" title="http://www.xmailserver.org/eventfd-aio-test.c"  rel="nofollow"> acest exemplu</a> de integrare a operațiilor I/O asincrone cu <a href="http://www.kernel.org/doc/man-pages/online/pages/man2/eventfd.2.html" class="urlextern" title="http://www.kernel.org/doc/man-pages/online/pages/man2/eventfd.2.html"  rel="nofollow"> eventfd</a>.</div>
</li>
</ul>
</li>
<li class="level1"><div class="li">Transmiterea de fișiere statice se realizează folosind <a href="http://www.kernel.org/doc/man-pages/online/pages/man2/sendfile.2.html" class="urlextern" title="http://www.kernel.org/doc/man-pages/online/pages/man2/sendfile.2.html"  rel="nofollow"> sendfile</a>.</div>
</li>
<li class="level1"><div class="li">Tema se va rezolva folosind doar funcții POSIX. Se pot folosi de asemenea și funcțiile de formatare din familia <code>printf</code>, funcțiile de alocare de memorie <code>malloc</code>, <code>free</code> și funcțiile de lucru cu șiruri de caractere (<code>strcat</code>, <code>strdup</code> etc.)</div>
</li>
<li class="level1"><div class="li">Pentru partea de I/O se vor folosi doar funcții POSIX și funcții pentru operații asincrone. De exemplu, funcțiile <code>fopen</code>, <code>fread</code>, <code>fwrite</code>, <code>fclose</code> nu trebuie folosite; în locul acestora folosiți <code>open</code>, <code>io_setup</code>, <code>io_submit</code>, <code>close</code>.</div>
</li>
<li class="level1"><div class="li"> <span style='color:red; '> Scrierea și citirea pe sockeți se vor face <strong>doar</strong> prin funcțiile <code>send()</code> și <code>recv()</code>. Nu este permisă folosirea funcțiilor <code>read()</code> și <code>write()</code> pentru lucrul cu sockeți. </span></div>
</li>
</ul>

</div>
<!-- EDIT8 SECTION "Precizări pentru Linux" [10549-13605] -->
<h2 class="sectionedit9" id="testare">Testare</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li">Corectarea temelor se va realiza automat cu ajutorul unor suite de teste publice:</div>
<ul>
<li class="level2"><div class="li">teste Linux   – <a href="http://elf.cs.pub.ro/so/res/teme/tema5-checker-lin.zip" class="urlextern" title="http://elf.cs.pub.ro/so/res/teme/tema5-checker-lin.zip"  rel="nofollow"> tema5-checker-lin.zip</a></div>
</li>
<li class="level2"><div class="li">teste Windows – <a href="http://elf.cs.pub.ro/so/res/teme/tema5-checker-win.zip" class="urlextern" title="http://elf.cs.pub.ro/so/res/teme/tema5-checker-win.zip"  rel="nofollow"> tema5-checker-win</a></div>
</li>
</ul>
</li>
<li class="level1"><div class="li">Indicații despre utilizarea suitei de teste se găsesc în fișierul <code>README</code> din cadrul arhivei.</div>
</li>
<li class="level1"><div class="li">Pentru testare, pe Windows, se folosește o versiune a utilitarului <code>netcat</code>; puteți descărca arhiva completă (inclusiv executabilul necesar) <a href="http://joncraton.org/media/files/nc111nt.zip" class="urlextern" title="http://joncraton.org/media/files/nc111nt.zip"  rel="nofollow"> de aici</a> (parola este <code>nc</code>).</div>
</li>
<li class="level1"><div class="li">Pentru evaluare și corectare tema va fi uploadată folosind <a href="https://elf.cs.pub.ro/vmchecker/ui" class="urlextern" title="https://elf.cs.pub.ro/vmchecker/ui"  rel="nofollow"> interfața vmchecker</a>.</div>
</li>
<li class="level1"><div class="li">În urma compilării temei trebuie să rezulte un executabil denumit <code>aws</code> (Linux), respectiv <code>aws.exe</code> (Windows).</div>
<ul>
<li class="level2"><div class="li">Pe Windows, va trebui ca, în urma compilării, să rezulte și fișierul obiect <code>aws.obj</code> (pentru verificările de simboluri folosind <code>nm</code>).</div>
</li>
</ul>
</li>
<li class="level1"><div class="li">Suita de teste conține un set de teste. Trecerea unui test conduce la obținerea punctajului aferent acestuia.</div>
<ul>
<li class="level2"><div class="li">În urma rulării testelor, se va acorda, în mod automat, un punctaj total. Punctajul total maxim este de 90 de puncte, pentru o temă care trece toate testele. La acest punctaj se adaugă 10 puncte care reprezintă aprecierea temei de către asistentul care o corectează.</div>
</li>
<li class="level2"><div class="li">Cele 100 de puncte corespund la 10 puncte din cadrul notei finale.</div>
</li>
</ul>
</li>
<li class="level1"><div class="li">Pot exista penalizări în caz de întârzieri sau pentru neajunsuri de implementare sau de stil.</div>
</li>
<li class="level1"><div class="li">Pe lângă penalizările precizate în cadrul <a href="../../../../so/teme/general.html#lista_depunctari" class="urlextern" title="http://ocw.cs.pub.ro/courses/so/teme/general#lista_depunctari"  rel="nofollow"> listei de depunctări</a>, se vor avea în vedere următoarele elemente:</div>
<ul>
<li class="level2"><div class="li"> <span style='color:red; '> <strong>-2p</strong> Linux și Windows – fișierele statice nu sunt transmise prin mecanismul de zero-copy </span></div>
</li>
<li class="level2"><div class="li"> <span style='color:red; '> <strong>-0.5p</strong> Linux și Windows – alocare statică a unui vector de conexiuni </span></div>
</li>
<li class="level2"><div class="li"> <span style='color:red; '> <strong>-4p</strong> Linux – nu se folosesc doar <code>send</code> și <code>recv</code> pentru operațiile cu sockeți </span></div>
</li>
<li class="level2"><div class="li"> <span style='color:red; '> <strong>-2p</strong> Linux – folosirea de operații blocante pe sockeți în locul operațiilor non-blocante </span></div>
</li>
<li class="level2"><div class="li"> <span style='color:red; '> <strong>-1p</strong> Linux – recv/send/sendfile sunt apelate într-o buclă și nu pe baza evenimentelor semnalizate de epoll </span></div>
</li>
<li class="level2"><div class="li"> <span style='color:red; '> <strong>-2p</strong> Linux – operațiile I/O asincrone pe fișiere nu sunt așteptate “integrat” folosind <code>eventfd</code> și <code>epoll</code> </span></div>
</li>
<li class="level2"><div class="li"> <span style='color:red; '> <strong>-2p</strong> Windows – așteptarea încheierii operațiilor asincrone (atât pe fișiere cât și pe sockeți) nu este realizată unificat, folosind I/O Completion Ports </span></div>
</li>
<li class="level2"><div class="li"> <span style='color:red; '> <strong>-1p</strong> Linux și Windows – alte implementări nevalide la nivelul sistemului asincron de comunicație </span></div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> <span style='color:red; '> O temă care <strong>nu</strong> folosește operații I/O asincrone pe fișiere: <code>io_*</code> (din <code>libaio</code>) pe Linux, respectiv Overlapped I/O pe Windows va pierde punctajul pentru testele cu fișiere dinamice (testele 26-35) </span></div>
</li>
<li class="level1"><div class="li"><strong>Testul 0</strong> din cadrul checker-ului temei verifică automat coding style-ul surselor voastre. Ca referință este folosit <a href="https://www.kernel.org/doc/Documentation/CodingStyle" class="urlextern" title="https://www.kernel.org/doc/Documentation/CodingStyle"  rel="nofollow"> stilul de coding din kernelul Linux</a>. Acest test nu oferă sau scade puncte, dar poate fi folosit orientativ de către echipa de corectare pentru a penaliza problemele grave de coding style. Important este să vă definiți un stil și să-l folosiți consecvent. Pentru mai multe informații despre un cod de calitate citiți <a href="../../../../so/laboratoare/resurse/c_tips.html" class="urlextern" title="http://ocw.cs.pub.ro/courses/so/laboratoare/resurse/c_tips"  rel="nofollow"> pagina de recomandări</a>.</div>
</li>
</ul>

</div>
<!-- EDIT9 SECTION "Testare" [13606-17320] -->
<h2 class="sectionedit10" id="resurse_de_suport">Resurse de suport</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li">Cursuri</div>
<ul>
<li class="level2"><div class="li"><a href="../../../../so/cursuri/curs-10.html" class="urlextern" title="http://ocw.cs.pub.ro/courses/so/cursuri/curs-10"  rel="nofollow"> Curs 10 - Dispozitive de intrare/ieșire</a></div>
</li>
<li class="level2"><div class="li"><a href="../../../../so/cursuri/curs-11.html" class="urlextern" title="http://ocw.cs.pub.ro/courses/so/cursuri/curs-11"  rel="nofollow"> Curs 11 - Networking în sistemul de operare</a></div>
</li>
</ul>
</li>
<li class="level1"><div class="li">Laboratoare</div>
<ul>
<li class="level2"><div class="li"><a href="../../../../so/laboratoare/laborator-10.html" class="urlextern" title="http://ocw.cs.pub.ro/courses/so/laboratoare/laborator-10"  rel="nofollow"> Laborator 10 - Operații I/O avansate -- Windows</a></div>
</li>
<li class="level2"><div class="li"><a href="../../../../so/laboratoare/laborator-11.html" class="urlextern" title="http://ocw.cs.pub.ro/courses/so/laboratoare/laborator-11"  rel="nofollow"> Laborator 11 - Operații I/O avansate -- Linux</a></div>
</li>
</ul>
</li>
<li class="level1"><div class="li"><a href="http://github.com/joyent/http-parser" class="urlextern" title="http://github.com/joyent/http-parser"  rel="nofollow"> Parser-ul HTTP</a> recomandat pentru parsarea cererilor.</div>
</li>
<li class="level1"><div class="li"><a href="http://www.jmarshall.com/easy/http/" class="urlextern" title="http://www.jmarshall.com/easy/http/"  rel="nofollow"> Tutorial HTTP</a></div>
</li>
<li class="level1"><div class="li"><a href="http://elf.cs.pub.ro/so/res/teme/tema5-util.zip" class="urlextern" title="http://elf.cs.pub.ro/so/res/teme/tema5-util.zip"  rel="nofollow"> Resurse tema 5</a></div>
</li>
<li class="level1"><div class="li">Sample-uri pentru lucru cu sockeți</div>
<ul>
<li class="level2"><div class="li"><a href="http://elf.cs.pub.ro/so/res/teme/tema5-util/lin/samples/" class="urlextern" title="http://elf.cs.pub.ro/so/res/teme/tema5-util/lin/samples/"  rel="nofollow"> Sample-uri Linux</a></div>
</li>
<li class="level2"><div class="li"><a href="http://elf.cs.pub.ro/so/res/teme/tema5-util/win/samples/" class="urlextern" title="http://elf.cs.pub.ro/so/res/teme/tema5-util/win/samples/"  rel="nofollow"> Sample-uri Windows</a></div>
</li>
</ul>
</li>
<li class="level1"><div class="li">Teste</div>
<ul>
<li class="level2"><div class="li"><a href="http://elf.cs.pub.ro/so/res/teme/tema5-checker-lin.zip" class="urlextern" title="http://elf.cs.pub.ro/so/res/teme/tema5-checker-lin.zip"  rel="nofollow"> Teste Linux</a></div>
</li>
<li class="level2"><div class="li"><a href="http://elf.cs.pub.ro/so/res/teme/tema5-checker-win.zip" class="urlextern" title="http://elf.cs.pub.ro/so/res/teme/tema5-checker-win.zip"  rel="nofollow"> Teste Windows</a></div>
</li>
</ul>
</li>
<li class="level1"><div class="li"><a href="https://elf.cs.pub.ro/vmchecker/ui" class="urlextern" title="https://elf.cs.pub.ro/vmchecker/ui"  rel="nofollow"> Interfața de upload vmchecker</a></div>
</li>
<li class="level1"><div class="li"><a href="http://news.gmane.org/gmane.education.region.romania.operating-systems" class="urlextern" title="http://news.gmane.org/gmane.education.region.romania.operating-systems"  rel="nofollow"> Lista de discuții a cursului</a></div>
</li>
</ul>

<p>
<p><div class="noteimportant">
Resursele temei se găsesc și în repo-ul <a href="https://github.com/systems-cs-pub-ro/so-assignments" class="urlextern" title="https://github.com/systems-cs-pub-ro/so-assignments"  rel="nofollow">so-assignments</a> de pe GitHub. Repo-ul conține și un script Bash care vă ajută să vă creați un repository privat pe instanța de <a href="https://gitlab.cs.pub.ro" class="urlextern" title="https://gitlab.cs.pub.ro"  rel="nofollow">GitLab</a> a facultății. Urmăriți indicațiile din README și de pe <a href="../../../../so/teme/folosire-gitlab.html" class="wikilink1" title="so:teme:folosire-gitlab"> pagina de Wiki dedicată pentru git</a>.
</p>

<p>
În plus, responsabilii de teme se pot uita mai rapid pe <a href="https://gitlab.cs.pub.ro" class="urlextern" title="https://gitlab.cs.pub.ro"  rel="nofollow">GitLab</a> la temele voastre în cazul în care aveți probleme/bug-uri. Este mai ușor să primiți suport în rezolvarea problemelor implementării voastre dacă le oferiți responsabililor de teme acces la codul sursă pe <a href="https://gitlab.cs.pub.ro" class="urlextern" title="https://gitlab.cs.pub.ro"  rel="nofollow">GitLab</a>.
</p>

<p>
<strong>Dacă ați folosit <a href="https://gitlab.cs.pub.ro" class="urlextern" title="https://gitlab.cs.pub.ro"  rel="nofollow">GitLab</a> pentru realizarea temei, indicați în README link-ul către repository. Asigurați-vă că responsabilii de teme au drepturi de citire asupra repo-ului vostru</strong>.

</div></p>
</p>

</div>
<!-- EDIT10 SECTION "Resurse de suport" [17321-19595] -->
<h2 class="sectionedit11" id="faq">FAQ</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"><strong>Q:</strong> Tema se poate face în C++?</div>
<ul>
<li class="level2"><div class="li"><strong>A:</strong> Nu.</div>
</li>
</ul>
</li>
</ul>

</div>
<!-- EDIT11 SECTION "FAQ" [19596-19667] -->
<h2 class="sectionedit12" id="suport_intrebari_si_clarificari">Suport, întrebări și clarificări</h2>
<div class="level2">

<p>
Pentru întrebări sau nelămuriri legate de temă folosiți <a href="../../../../so/info/lista-discutii.html" class="wikilink1" title="so:info:lista-discutii">lista de discuții</a> sau <a href="../../../../so/info/documentatie.html#social_media" class="wikilink1" title="so:info:documentatie">canalul de IRC</a>.
</p>



</div>
<!-- EDIT12 SECTION "Suport, întrebări și clarificări" [19668-] --></div>
</body>
</html>
