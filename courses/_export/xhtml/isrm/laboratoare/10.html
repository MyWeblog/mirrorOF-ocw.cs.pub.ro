    
    

<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <title>isrm:laboratoare:10</title>
<meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="date" content="2016-01-06T15:41:47+0200"/>
<meta name="keywords" content="isrm,laboratoare,10"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../../../lib/exe/opensearch.php" title="CS Open CourseWare"/>
<link rel="start" href="../../../../../courses.1.html"/>
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="../../../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="../../../../feed.php%3Fmode=list&amp;ns=isrm:laboratoare"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="10.html"/>
<link rel="canonical" href="../../../../isrm/laboratoare/10.html"/>
<link rel="stylesheet" type="text/css" href="../../../../lib/exe/css.php%3Ft=arctic&amp;tseed=1476798676.css"/>
<script type="text/javascript">/*<![CDATA[*/var NS='isrm:laboratoare';var JSINFO = {"id":"isrm:laboratoare:10","namespace":"isrm:laboratoare","isadmin":0,"isauth":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../../../lib/exe/js.php%3Ftseed=1476798676"></script>
<script type="text/x-mathjax-config">/*<![CDATA[*/MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ["$","$"], ["\\(","\\)"] ],
        displayMath: [ ["$$","$$"], ["\\[","\\]"] ],
        processEscapes: true
    }
});
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<script type="text/javascript">/*<![CDATA[*/
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
		  
/*!]]>*/</script>
<script type="text/javascript">/*<![CDATA[*/
var pageTracker = _gat._getTracker("UA-38383934-1");
pageTracker._initData();
pageTracker._trackPageview();
		  
/*!]]>*/</script>
</head>
<body>
<div class="dokuwiki export">
<!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level3"><div class="li"><a href="10.html#laboratorul_10">Laboratorul 10</a></div>
<ul class="toc">
<li class="level4"><div class="li"><a href="10.html#mcs_multiple">MCS multiple</a></div></li>
<li class="level4"><div class="li"><a href="10.html#rezolvare">Rezolvare</a></div></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h3 class="sectionedit1" id="laboratorul_10">Laboratorul 10</h3>
<div class="level3">

</div>

<h4 id="mcs_multiple">MCS multiple</h4>
<div class="level4">

<p>
Se dă scriptul <a href="../../../../_media/isrm/laboratoare/src/multirate.tcl" class="media mediafile mf_tcl" title="isrm:laboratoare:src:multirate.tcl (8.2 KB)">multirate.tcl</a> care definește 
nodurile WiFi 0,1,2,3,4 astfel: 
</p>
<pre class="code">        3

    4   0   2
        
        1</pre>

<p>
Nodul 0 funcționează ca AP și emite la 11Mbps, iar celelalte noduri sunt clienți, cu legături uplink de 1Mbps. Sunt definite patru fluxuri UDP 1→3, 2→4, 4→0, 0→4, toate cu pachete de 1460 de octeți. 
Distanțele de la clienți la AP sunt de 20m, RTS este dezactivat, RxThresh=250m, iar acești parametri nu vor fi modificați. 
Scriptul <strong>necesită</strong> următorii
parametri pe linia de comandă:
</p>
<ul>
<li class="level1"><div class="li"> rate0 &lt;rate&gt; indică rata oferită pentru fluxul 1→3  </div>
</li>
<li class="level1"><div class="li"> rate1 &lt;rate&gt; indică rata oferită pentru fluxul 2→4 </div>
</li>
<li class="level1"><div class="li"> rate2 &lt;rate&gt; indică rata oferită pentru fluxul 4→0 </div>
</li>
<li class="level1"><div class="li"> rate3 &lt;rate&gt; indică rata oferită pentru fluxul 0→4 </div>
</li>
</ul>

<p>
La sfârșitul simulării de 100 secunde se afișează throughputul în bps
pentru fiecare flux, și numărul total de pachete transferat pe durata
întregii simulări. Scriptul cere ca parametrii rate să fie diferiți de
zero, dar pentru a dezactiva un flux, trebuie furnizată o rată
neglijabilă, de exemplu 0.01bps. Unitatea de măsură nu se separă cu
spațiu: 11Mbps, 360Kbps, etc.
</p>
<ol>
<li class="level1"><div class="li"> Să se calculeze capacitatea maximă a aerului în pps si bps pentru fiecare emițător luat în izolare. Cât durează transmiterea unui cadru de la stații? Dar de la AP?</div>
</li>
<li class="level1"><div class="li"> Dacă doar fluxul 0 (1→3) este activ, ce throughput se obține end to end? </div>
</li>
<li class="level1"><div class="li"> Care este rata coliziunilor (cps)? Cât durează o coliziune? </div>
</li>
<li class="level1"><div class="li"> Cum se justifică valoarea obținută? Care este compoziția cadrelor din aer? </div>
</li>
<li class="level1"><div class="li"> Dacă doar fluxurile 0 (1→3) și 1 (2→4) sunt active, ce throughput se obține end to end? </div>
</li>
<li class="level1"><div class="li"> Cum se justifică valoarea obținută? </div>
</li>
<li class="level1"><div class="li"> Cum puteți obține o valoare mai mare? </div>
</li>
</ol>

</div>

<h4 id="rezolvare">Rezolvare</h4>
<div class="level4">
<ol>
<li class="level1"><div class="li"> Se dezactivează toate fluxurile în afară de unul pentru a studia un transmițător în izolare: <pre class="code">     
    ns ./multirate.tcl -rate0 0.01bps -rate1 0.01bps  -rate2 0.01bps -rate3 11Mbps  </pre>

<p>
 Se obțin 511pps, sau 5.97Mbps pentru AP. Un cadru durează \( \frac{1000}{511} = 1.95ms \) 
</p>
<pre class="code">     
    ns ./multirate.tcl -rate0 0.01bps -rate1 0.01bps  -rate2 11Mbps -rate3 0.01bps  </pre>

<p>
  Se obțin 77pps, sau 902Kbps pentru statii. Un cadru durează \( \frac{1000}{77} = 12.98ms \). E mai greu de folosit fluxurile 1→3 și 2→4 deoarece un pachet trece de două ori prin aer pentru aceste cazuri. Pentru acest setup, cele două treceri sunt la MCS diferite.  
</p>
</div>
</li>
<li class="level1"><div class="li"> Se activează doar fluxul 0 (1→3):  <pre class="code">     
    ns ./multirate.tcl -rate0 902Kbps -rate1 0.01bps  -rate2 0.1bps -rate3 0.1bps  </pre>

<p>
 Se obțin 755Kbps, sau 64pps. În aer se află cadre scurte, la 11Mbps, și cadre lungi, emise la 1Mbps, cel puțin câte 64 din fiecare, deoarece 64pps sunt livrate la destinație. Este posibil să mai fie și cadre în coliziune.
</p>
</div>
</li>
<li class="level1"><div class="li"> <pre class="code"> cat ./multirate.tr  | grep cbr | grep COL | wc -l </pre>

<p>
  Rezultă 4cps coliziuni pe secundă. Deoarece toate dispozitive sunt în CS, nu avem terminale ascunse, și coliziunile sunt datorate ferestrei de contenție. Avem 2 transmițători: AP și stația 1, ce emit cadre de lungimi diferite. O coliziune durează până la sfârșitul cadrului cel mai lung (802.11 nu are CSMA/CD), adică 12.98ms. 4*12.98ms = 52ms = 5.2% din timp. 
</p>
</div>
</li>
<li class="level1"><div class="li"> Trebuie să aflăm câte cadre din fiecare tip se află în aer  într-o secundă. Fiecare emițător câștigă aceleași oportunități de transmisie pe termen lung<sup><a href="10.html#fn__1" id="fnt__1" class="fn_top">1)</a></sup>, x cadre pe secundă, dar fiecare îl ține ocupat în funcție de MCS folosit: (1Mbps, 11Mbps) \( R_1 = 77pps, R_2 = 511pps\). În plus mai avem și C coliziuni pe secundă. $$ \frac{x}{R_1} + \frac{x}{R_2} + \frac{C}{R_1} = 1 $$ $$ x = (1-\frac{C}{R_1})\frac{R_1R_2}{R_1+R_2} = 63pps$$ adică 63*1480*8 = 751Kbps, consistent cu ce am obținut în simulare.</div>
<ul>
<li class="level2"><div class="li"> Stația 1 ocupă 64*12.98 = 823ms = 82% din timp. </div>
</li>
<li class="level2"><div class="li"> AP ocupă 64*1.95=123ms = 12% din timp</div>
</li>
<li class="level2"><div class="li"> coliziuni, restul de 5% din timp </div>
</li>
<li class="level2"><div class="li"> Coada de pachete este probabil mereu goală în AP, și în creștere la stație, deoarece se generează mai mult decât se poate emite.</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> Activăm fluxurile 0 și 1, oferind maximul precedent: <pre class="code">     
    ns ./multirate.tcl -rate0 755Kbps -rate1 755Kbps  -rate2 0.1bps -rate3 0.1bps
    cat ./multirate.tr  | grep cbr | grep COL | wc -l 
  </pre>

<p>
 Se obțin câte 199Kbps pentru fiecare flux, adică 17pps. Coliziuni 8.2cps. 
</p>
</div>
</li>
<li class="level1"><div class="li"> Dacă se transmite un maximum de la fiecare sursă (1 și 2), AP-ul va avea de retransmis pentru ambele, dar nu câștigă mediul decât în 1/3 din arbitrări, deși cadrele lui sunt mai scurte. $$  \frac{x}{R_1} + \frac{x}{R_1} + \frac{x}{R_2} + \frac{C}{R_1} = 1 $$ Ce este diferit față de cazul precedent este că toți cei trei   emițători sunt saturați, AP-ul însă nu dirijează decât \( \frac{x}{2} \) pentru   fiecare flux, iar restul este pierdut. $$ x = (1 - \frac{C}{R_1})\frac{R_1 R_2}{R_1+2 R_2} = 32pps$$ Dar debitul obținut pentru fiecare flux este doar \(x/2\) = 16pps, adică 190Kbps.</div>
<ul>
<li class="level2"><div class="li"> Stația 1 ocupă 32*12.98ms = 42% din timp </div>
</li>
<li class="level2"><div class="li"> Stația 2 ocupă 32*12.98ms = 42% din timp </div>
</li>
<li class="level2"><div class="li"> AP ocupă 32*1.95ms = 6% din timp </div>
</li>
<li class="level2"><div class="li"> Coliziuni 8.2*12.98ms = 10% din timp</div>
</li>
<li class="level2"><div class="li"> Adică 42% din timp este irosit pentru a transmite prin aer cadre care vor fi aruncate la AP!</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> Ar trebui ca fiecare cadru emis de o sursă să fie dirijat de către AP, si nu aruncat, deci împărțirea prin contenție nu se dorește echitabilă, ci AP-ul ar trebui să obțină dublu față de fiecare stație. \(x\) este acum debitul per flux: $$  \frac{x}{R_1} + \frac{x}{R_1} + \frac{2x}{R_2} + \frac{C}{R_1} = 1 $$ Din păcte C și x sunt interdependente, și o proporție de coliziuni este inevitabilă chiar dacă AP-ul este nesaturat. Cu 0 coliziuni am obține  $$ x = \frac{0.5 R_1 R_2}{R_1 + R_2} = 33.5pps = 396Kbps $$ Dacă rulăm, obținem 214Kbps și 7.9cps, ceea ce este departe de formulă, dar totuși crește debitul și scad coliziunile, deci este clar că trebuie trimis mai puțin de la surse. Un alt indiciu este că nu se pot emite mai mult de 755Kbps pentru un flux, deci 755Kbps/2 = 377Kbps de la fiecare stație 0 și 1, deoarece mediul este comun. <pre class="code">  ns ./multirate.tcl -rate0 377Kbps -rate1 377Kbps  -rate2 0.1bps -rate3 0.1bps
  </pre>

<p>
 Se obțin câte 337Kbps pentru fiecare flux, adică 29pps. Coliziuni C = 5.9cps. Folosind acest ultim C, obținem: $$ x = (1 - \frac{C}{R_1})\frac{0.5 R_1 R_2}{R_1+R_2} = 31pps = 365Kbps $$  Dacă oferim doar 365K, se obțin 362K, si doar 4cps (similar cu 2., 3.), probabil  optimul pentru această configurație.
</p>
</div>
</li>
</ol>

</div>
<div class="footnotes">
<div class="fn"><sup><a href="10.html#fnt__1" id="fn__1" class="fn_bot">1)</a></sup> 
De ce? Explicați folosind algoritmul de acces la mediu 802.11, sau prin rulare: -rate0 0.1bps -rate1 0.1bps -rate2 11Mbps -rate3 11Mbps</div>
</div>
</div>
</body>
</html>
