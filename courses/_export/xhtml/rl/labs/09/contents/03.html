    
    

<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <title>rl:labs:09:contents:03</title>
<meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="date" content="2015-12-15T11:02:53+0200"/>
<meta name="keywords" content="rl,labs,09,contents,03"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../../../../../lib/exe/opensearch.php" title="CS Open CourseWare"/>
<link rel="start" href="../../../../../../../courses.1.html"/>
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="../../../../../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="../../../../../../feed.php%3Fmode=list&amp;ns=rl:labs:09:contents"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="03.html"/>
<link rel="canonical" href="../../../../../../rl/labs/09/contents/03.html"/>
<link rel="stylesheet" type="text/css" href="../../../../../../lib/exe/css.php%3Ft=arctic&amp;tseed=1476798676.css"/>
<script type="text/javascript">/*<![CDATA[*/var NS='rl:labs:09:contents';var JSINFO = {"id":"rl:labs:09:contents:03","namespace":"rl:labs:09:contents","isadmin":0,"isauth":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../../../../../lib/exe/js.php%3Ftseed=1476798676"></script>
<script type="text/x-mathjax-config">/*<![CDATA[*/MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ["$","$"], ["\\(","\\)"] ],
        displayMath: [ ["$$","$$"], ["\\[","\\]"] ],
        processEscapes: true
    }
});
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<script type="text/javascript">/*<![CDATA[*/
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
		  
/*!]]>*/</script>
<script type="text/javascript">/*<![CDATA[*/
var pageTracker = _gat._getTracker("UA-38383934-1");
pageTracker._initData();
pageTracker._trackPageview();
		  
/*!]]>*/</script>
</head>
<body>
<div class="dokuwiki export">

<h3 class="sectionedit1" id="p_format_de_pachete_tcp_la_translatare">03. [10p] Format de pachete TCP la translatare</h3>
<div class="level3">

<p>
Dorim să urmărim conținutul pachetelor TCP înainte și după translatarea de adrese. În plus față de exercițiul de mai sus, vrem să urmărim și porturile. Pentru aceasta vom genera pachete TCP (HTTP) folosind <code>wget</code> de pe stația <code>red</code> și vom captura pachetele folosind <code>tcpdump</code> pe stația <code>host</code>.
</p>

<p>
Pe stația <code>host</code> capturați pe toate interfețele pachetele HTTP care au ca adresă destinație numele <code>www.upb.ro</code>.
</p>

<p>
<p><div class="notetip">
Va trebui să folosiți argumentele <code>ip dst host www.upb.ro</code> și <code>tcp dst port 80</code> la <code>tcpdump</code>. Legați argumentele prin șirul <code>and</code>. Urmăriți și <a href="http://linux-circles.blogspot.ro/2012/11/how-to-capture-packets-with-tcpdump.html" class="urlextern" title="http://linux-circles.blogspot.ro/2012/11/how-to-capture-packets-with-tcpdump.html"  rel="nofollow">exemplele de aici</a>.
</p>

<p>
Folosiți opțiunea <code>-n</code> a <code>tcpdump</code> ca să afișați în format rezultatele în format numeric (adresă IP și port). Vă va fi mai ușor să urmăriți pachetele și translatarea de adrese.

</div></p>
</p>

<p>
Pe stația <code>red</code> folosiți <code>wget</code> pentru a obține pagina de la <code>www.upb.ro</code>.
</p>

<p>
Urmăriți translatarea adresei IP sursă și a portului sursă în cadrul capturii de pachete realizată cu <code>tcpdump</code> pe <code>host</code>.
</p>

<p>
<p><div class="noteimportant">
O să existe o latență (2-3 secunde) la afișarea pachetelor capturate cu <code>tcpdump</code> datorată rezolvării <abbr title="Domain Name System">DNS</abbr>. Puteți folosi opțiunea <code>-n</code> a <code>tcpdump</code> pentru a dezactivarea rezolvarea <abbr title="Domain Name System">DNS</abbr> și pentru a elimina latența.

</div></p>
</p>

<p>
Observați în cadrul capturii că portul sursă, ales de stația <code>red</code> este același cu cel folosit în urma translatării de stația <code>host</code>. În general implementările de NAT vor păstra portul în urma translatării. În cazul rar în care acel port este ocupat pe stația <code>host</code> (posibil datorită unei alte translatării) se va aloca un alt port.
</p>

<p>
Pe stația <code>host</code> capturați pe toate interfețele pachetele HTTP care au ca adresă numele <code>www.upb.ro</code>; nu contează dacă este sursă sau destinație, capturăm și pachetele de interogare și cele de rășpuns; la fel, portul poate fi sursă sau destinație; folosiți <code>ip host</code> în loc de <code>ip dst host</code> și <code>tcp port</code> în loc de <code>tcp dst port</code>. Pe stația <code>red</code> folosiți, din nou, <code>wget</code> pentru a obține pagina de la <code>www.upb.ro</code>. Urmăriți translatarea adresei IP sursă și a portului sursă pentru pachetele de interogare și translatarea adresei IP destinație și a portului destinație pentru pachetele de răspuns.
</p>

</div>
</div>
</body>
</html>
