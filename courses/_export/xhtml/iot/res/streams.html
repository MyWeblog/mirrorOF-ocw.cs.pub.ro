    
    

<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <title>iot:res:streams</title>
<meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="date" content="2015-07-30T16:21:01+0300"/>
<meta name="keywords" content="iot,res,streams"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../../../lib/exe/opensearch.php" title="CS Open CourseWare"/>
<link rel="start" href="../../../../../courses.1.html"/>
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="../../../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="../../../../feed.php%3Fmode=list&amp;ns=iot:res"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="streams.html"/>
<link rel="canonical" href="../../../../iot/res/streams.html"/>
<link rel="stylesheet" type="text/css" href="../../../../lib/exe/css.php%3Ft=arctic&amp;tseed=1476798676.css"/>
<script type="text/javascript">/*<![CDATA[*/var NS='iot:res';var JSINFO = {"id":"iot:res:streams","namespace":"iot:res","isadmin":0,"isauth":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../../../lib/exe/js.php%3Ftseed=1476798676"></script>
<script type="text/x-mathjax-config">/*<![CDATA[*/MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ["$","$"], ["\\(","\\)"] ],
        displayMath: [ ["$$","$$"], ["\\[","\\]"] ],
        processEscapes: true
    }
});
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<script type="text/javascript">/*<![CDATA[*/
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
		  
/*!]]>*/</script>
<script type="text/javascript">/*<![CDATA[*/
var pageTracker = _gat._getTracker("UA-38383934-1");
pageTracker._initData();
pageTracker._trackPageview();
		  
/*!]]>*/</script>
</head>
<body>
<div class="dokuwiki export">
<!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="streams.html#streams_nodes">Streams nodes</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="streams.html#run">Run</a></div></li>
<li class="level2"><div class="li"><a href="streams.html#print">Print</a></div></li>
<li class="level2"><div class="li"><a href="streams.html#functions">Functions</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="streams.html#function">Function</a></div></li>
<li class="level3"><div class="li"><a href="streams.html#visual">Visual</a></div></li>
<li class="level3"><div class="li"><a href="streams.html#delay">Delay</a></div></li>
<li class="level3"><div class="li"><a href="streams.html#switch">Switch</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="streams.html#socialsend_and_receive">Social: Send and receive</a></div></li>
<li class="level2"><div class="li"><a href="streams.html#say">Say</a></div></li>
<li class="level2"><div class="li"><a href="streams.html#io_pins">I/O pins</a></div></li>
<li class="level2"><div class="li"><a href="streams.html#signals">Signals</a></div></li>
<li class="level2"><div class="li"><a href="streams.html#web_servers">Web servers</a></div></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="streams_nodes">Streams nodes</h1>
<div class="level1">

</div>
<!-- EDIT1 SECTION "Streams nodes" [1-26] -->
<h2 class="sectionedit2" id="run">Run</h2>
<div class="level2">

<p>
 The nodes which will start the payload. This is practically the first data flow sent towards the rest of the nodes you use in an application.
</p>

<p>
In its settings you have three fields.
</p>

<p>
If no payload is specified the payload is set to the current time in milliseconds since 1970. This allows subsequent functions to perform time based actions. You can write it yourself if you chose for it to be a string.
</p>

<p>
The topic field can hold data to be used later, in other functions.
</p>

<p>
The repeat function does what it says on the tin and continuously sends the payload every x seconds.
</p>

<p>
The Fire once at start option actually waits 50mS before firing to give other nodes a chance to instantiate properly.
</p>

<p>
Any node can have a name given by the user. 
<a href="../../../../_detail/iot/res/run.png%3Fid=iot%253Ares%253Astreams.html" class="media" title="iot:res:run.png"><img src="../../../../_media/iot/res/run.png%3Fw=200&amp;tok=87e4dc" class="mediacenter" alt="" width="200" /></a>
</p>

</div>
<!-- EDIT2 SECTION "Run" [27-810] -->
<h2 class="sectionedit3" id="print">Print</h2>
<div class="level2">

<p>
 The print node can be connected to the output of any node. It will display msg.payload field of any messages it receives.
</p>

<p>
The button to the right of the node will toggle it&#039;s output on and off so you can de-clutter the console window.
</p>

<p>
If the payload is an object it will be converted to String first for display and indicate that by saying ”(Object) ”.
</p>

<p>
By connecting the two blocks you send the output of run as input for print. 
<a href="../../../../_detail/iot/res/runex.png%3Fid=iot%253Ares%253Astreams.html" class="media" title="iot:res:runex.png"><img src="../../../../_media/iot/res/runex.png%3Fw=400&amp;tok=c161c3" class="mediacenter" alt="" width="400" /></a>
</p>

</div>
<!-- EDIT3 SECTION "Print" [811-1296] -->
<h2 class="sectionedit4" id="functions">Functions</h2>
<div class="level2">

</div>
<!-- EDIT4 SECTION "Functions" [1297-1318] -->
<h3 class="sectionedit5" id="function">Function</h3>
<div class="level3">

<p>
A function block where you can write code to do many other interesting things.
By convention it will have a msg.payload property containing the body of the message.
If you double click on it, you will find the name field, the second field, where you write the code and the last one, where you specify how many outputs the node has. 
<a href="../../../../_detail/iot/labs/functions.png%3Fid=iot%253Ares%253Astreams.html" class="media" title="iot:labs:functions.png"><img src="../../../../_media/iot/labs/functions.png%3Fw=300&amp;tok=e0eb51" class="mediacenter" alt="" width="300" /></a>
 For this node you can find an usage example in <em> Course 3: Software for the Internet of Things </em>.
</p>

</div>
<!-- EDIT5 SECTION "Function" [1319-1807] -->
<h3 class="sectionedit6" id="visual">Visual</h3>
<div class="level3">

<p>
This node is similar to the function block, only that the second field will consist of visual blocks.
</p>

<p>
Look up an example in <em> Lab. 03 - Blink an LED </em>.
</p>

</div>
<!-- EDIT6 SECTION "Visual" [1808-1980] -->
<h3 class="sectionedit7" id="delay">Delay</h3>
<div class="level3">

<p>
Introduces a delay into a flow or rate limited messages.
</p>

<p>
Default delay is 5 seconds and rate limit of 1 msg/second, but both can be configured.
<a href="../../../../_detail/iot/labs/delay.png%3Fid=iot%253Ares%253Astreams.html" class="media" title="iot:labs:delay.png"><img src="../../../../_media/iot/labs/delay.png%3Fw=200&amp;tok=998af3" class="mediacenter" alt="" width="200" /></a>
</p>

<p>
The <em>delay</em> node is placed in an example in <em> Course 3: Software for the Internet of Things</em> as well. 
</p>

</div>
<!-- EDIT7 SECTION "Delay" [1981-2280] -->
<h3 class="sectionedit8" id="switch">Switch</h3>
<div class="level3">

<p>
A function node which will evaluate the message received and pass it on after filtering it though a set of ruled. You can create the rules in the node&#039;s settings. 
<a href="../../../../_detail/iot/labs/switch.png%3Fid=iot%253Ares%253Astreams.html" class="media" title="iot:labs:switch.png"><img src="../../../../_media/iot/labs/switch.png%3Fw=200&amp;tok=6a9e75" class="mediacenter" alt="" width="200" /></a>
Find an example of how to use the node in <em> Course 3: Software for the Internet of Things </em>.
</p>

</div>
<!-- EDIT8 SECTION "Switch" [2281-2588] -->
<h2 class="sectionedit9" id="socialsend_and_receive">Social: Send and receive</h2>
<div class="level2">

<p>
You can make boards communicate. The message that they exchange will be in the payload. 
The <em>Send</em> node needs the label, which is the identification of the expected message. It should be the same one in the receive message node.
<a href="../../../../_detail/iot/labs/messages.png%3Fid=iot%253Ares%253Astreams.html" class="media" title="iot:labs:messages.png"><img src="../../../../_media/iot/labs/messages.png%3Fw=200&amp;tok=fbad4f" class="mediacenter" alt="" width="200" /></a>
The third field asks for the board ID. In <em>send</em> you need the receiver board ID. To obtain it, go to the main page, find your board and, in its options, choose <em> Board ID</em>
<a href="../../../../_detail/iot/labs/boardid.png%3Fid=iot%253Ares%253Astreams.html" class="media" title="iot:labs:boardid.png"><img src="../../../../_media/iot/labs/boardid.png%3Fw=300&amp;tok=5fa9d7" class="mediacenter" alt="" width="300" /></a>
</p>

<p>
Here&#039;s a simple and short example on a situation where you might need this very nodes. 
The temperature from a room is needed. The user who has these values wants to send them to your board, for you to insert them in your own project. 
The first user needs a <em> Send message</em> node, a label he decides over and your board ID. He will take the values from the temperature sensor connected, say on pin A0 and include them in the message to be sent. 
</p>

<p>
You, on the other hand, will have to put a <em>Receive message</em> node which, in this example, will print on your console the values respective to the temperature, in an analog range (0 - 1024) every time it gets a message from the first board. <br/>

<a href="../../../../_detail/iot/res/receivemsg.png%3Fid=iot%253Ares%253Astreams.html" class="media" title="iot:res:receivemsg.png"><img src="../../../../_media/iot/res/receivemsg.png%3Fw=300&amp;tok=b2f10f" class="medialeft" alt="" width="300" /></a>
<a href="../../../../_detail/iot/res/sendmsg.png%3Fid=iot%253Ares%253Astreams.html" class="media" title="iot:res:sendmsg.png"><img src="../../../../_media/iot/res/sendmsg.png%3Fw=300&amp;tok=d25cec" class="mediacenter" alt="" width="300" /></a>
</p>

</div>
<!-- EDIT9 SECTION "Social: Send and receive" [2589-3861] -->
<h2 class="sectionedit10" id="say">Say</h2>
<div class="level2">

<p>
You can make the board speak. Just insert this node and specify the message and the language.  It will be saved in the payload. 
<a href="../../../../_detail/iot/labs/say.png%3Fid=iot%253Ares%253Astreams.html" class="media" title="iot:labs:say.png"><img src="../../../../_media/iot/labs/say.png%3Fw=200&amp;tok=d8dc83" class="mediacenter" alt="" width="200" /></a>
</p>

<p>
For instance, a possible application would implement this block and two other simple ones: the <em> run </em> node and a change node, where you write the message you expect from your project. 
</p>

<p>
<a href="../../../../_detail/iot/res/sayexample.png%3Fid=iot%253Ares%253Astreams.html" class="media" title="iot:res:sayexample.png"><img src="../../../../_media/iot/res/sayexample.png%3Fw=400&amp;tok=e14562" class="mediacenter" alt="" width="400" /></a>
</p>

</div>
<!-- EDIT10 SECTION "Say" [3862-4260] -->
<h2 class="sectionedit11" id="io_pins">I/O pins</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li">  digitalWrite - it will write 0 or 1 on a digital pin, the one that you choose in the settings.</div>
</li>
<li class="level1"><div class="li">  digitalRead- reads 0 or 1 from a digital pin demanded in its settings and saves this value in the payload.</div>
</li>
</ul>

<p>
<a href="../../../../_detail/iot/labs/digitals.png%3Fid=iot%253Ares%253Astreams.html" class="media" title="iot:labs:digitals.png"><img src="../../../../_media/iot/labs/digitals.png%3Fw=200&amp;tok=32dc20" class="mediacenter" alt="" width="200" /></a>
</p>
<ul>
<li class="level1"><div class="li">  analogWrite - reads the value from the analog pin mentioned in the settings </div>
</li>
<li class="level1"><div class="li">  analogRead - writes a value on an analog/ PMM pin. Said value will be in the payload. </div>
</li>
</ul>

<p>
<a href="../../../../_detail/iot/labs/analogs.png%3Fid=iot%253Ares%253Astreams.html" class="media" title="iot:labs:analogs.png"><img src="../../../../_media/iot/labs/analogs.png%3Fw=200&amp;tok=002611" class="mediacenter" alt="" width="200" /></a>
For these nodes you can find examples in <em>Course 3: Software for the Internet of Things </em>
</p>
<ul>
<li class="level1"><div class="li"> Shift in/ out- When it receives an input, shifts in/out a byte value from a pin using the clock pin as a clock. The value read/written is in payload. If no data pin is specified, the pin number is the topic field of the message.</div>
</li>
</ul>

<p>
<a href="../../../../_detail/iot/labs/shifts.png%3Fid=iot%253Ares%253Astreams.html" class="media" title="iot:labs:shifts.png"><img src="../../../../_media/iot/labs/shifts.png%3Fw=200&amp;tok=2411e0" class="mediacenter" alt="" width="200" /></a>
Here&#039;s an example on how to use the <em>shift out</em> node. You want to light up 3 LEDs one by one, without changing the state of the previous one. Picture this: you have the pins connected to 3 consecutive pins of a shift register so,  you want to have on them the values: 0, 0, 0 when they are all out; 0, 0, 1 when the last pin is high; 0, 1, 1 when the last two are turned on and for all the LEDs to be alight 1, 1, 1. The corresponding values would be 0, 1, 3 and 7 which, in binary, would look exactly like the values you expect. Make a function which returns these numbers and the <em>shift out </em> node will write on the shift register exactly what you need. Make sure the data and the clock pin correspond to the shift register&#039;s pins. 
<a href="../../../../_detail/iot/res/shiftoutt.png%3Fid=iot%253Ares%253Astreams.html" class="media" title="iot:res:shiftoutt.png"><img src="../../../../_media/iot/res/shiftoutt.png%3Fw=400&amp;tok=74ea8d" class="mediacenter" alt="" width="400" /></a>
The easiest way to do this is to select, in the <em> run </em> node, the <em> Times</em> option, instead of <em> timestamp</em>. This will send in the payload a number, starting with 0, which is incresing by one each time a new message is sent out. The function should look like this. 
<a href="../../../../_detail/iot/res/exfctshiftout.png%3Fid=iot%253Ares%253Astreams.html" class="media" title="iot:res:exfctshiftout.png"><img src="../../../../_media/iot/res/exfctshiftout.png%3Fw=350&amp;tok=35190d" class="mediacenter" alt="" width="350" /></a>
</p>

</div>
<!-- EDIT11 SECTION "I/O pins" [4261-6174] -->
<h2 class="sectionedit12" id="signals">Signals</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li">  receiveSignal- puts in the payload the value received though the signal, from the dashboard. Write in the settings the name of the signal you expect, which should be identical with the one in the dashboard.</div>
</li>
<li class="level1"><div class="li">  sendSignal- sends the value of the payload to the signal with the same name in the dashboard or to a certain number of boards.</div>
</li>
</ul>

<p>
<a href="../../../../_detail/iot/labs/signals.png%3Fid=iot%253Ares%253Astreams.html" class="media" title="iot:labs:signals.png"><img src="../../../../_media/iot/labs/signals.png%3Fw=200&amp;tok=26f82d" class="mediacenter" alt="" width="200" /></a>
Find examples of how the <em> send signal </em> node works in <em> Lab 05. Connecting Analog Sensors to the board and adding charts </em>.
</p>

<p>
As for the <em> receive signal </em>node, you add a swith in the dashboard and name the signal it sends in a paticular way. 
Afterwords, you come back to your main page and add a <em> receive signal </em> node. This one will start the project when it gets the message sent from the switch, and will put in the payload the value 0 or 1, depending on the switch&#039;s state. You can use this value to light up an LED, for example. 
<a href="../../../../_detail/iot/res/example2.png%3Fid=iot%253Ares%253Astreams.html" class="media" title="iot:res:example2.png"><img src="../../../../_media/iot/res/example2.png%3Fw=300&amp;tok=2a3f55" class="mediacenter" alt="" width="300" /></a>
<a href="../../../../_detail/iot/res/examplereceive.png%3Fid=iot%253Ares%253Astreams.html" class="media" title="iot:res:examplereceive.png"><img src="../../../../_media/iot/res/examplereceive.png%3Fw=300&amp;tok=e18069" class="mediacenter" alt="" width="300" /></a>
</p>

</div>
<!-- EDIT12 SECTION "Signals" [6175-7189] -->
<h2 class="sectionedit13" id="web_servers">Web servers</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> http request - this block can either get, post, pull, delete the data from a web page depending on what method you choose</div>
</li>
</ul>

<p>
<a href="../../../../_detail/iot/labs/screenshot_from_2015-06-20_18_24_41.png%3Fid=iot%253Ares%253Astreams.html" class="media" title="iot:labs:screenshot_from_2015-06-20_18_24_41.png"><img src="../../../../_media/iot/labs/screenshot_from_2015-06-20_18_24_41.png%3Fw=200&amp;tok=0a60ed" class="mediacenter" alt="" width="200" /></a>
</p>
<ul>
<li class="level1"><div class="li"> Web route - will start a web server which listens on the port you choose and has a method for the configured route</div>
</li>
<li class="level1"><div class="li"> Web response- it will set the response of the server. In <em>status</em> you configure it. Default is 200 which is page found.</div>
</li>
</ul>

<p>
<a href="../../../../_detail/iot/labs/web.png%3Fid=iot%253Ares%253Astreams.html" class="media" title="iot:labs:web.png"><img src="../../../../_media/iot/labs/web.png%3Fw=200&amp;tok=84e920" class="mediacenter" alt="" width="200" /></a>
</p>

<p>
All the additional information you need can be found  in <em> Course 09. Web servers </em> and examples in <em> Lab 08. Web services </em>.
</p>

</div>
<!-- EDIT13 SECTION "Web servers" [7190-] --></div>
</body>
</html>
