    
    

<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <title>iot:courses:02</title>
<meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="date" content="2016-06-23T10:17:10+0300"/>
<meta name="keywords" content="iot,courses,02"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../../../lib/exe/opensearch.php" title="CS Open CourseWare"/>
<link rel="start" href="../../../../../courses.1.html"/>
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="../../../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="../../../../feed.php%3Fmode=list&amp;ns=iot:courses"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="02.html"/>
<link rel="canonical" href="../../../../iot/courses/02.html"/>
<link rel="stylesheet" type="text/css" href="../../../../lib/exe/css.php%3Ft=arctic&amp;tseed=1476798676.css"/>
<script type="text/javascript">/*<![CDATA[*/var NS='iot:courses';var JSINFO = {"id":"iot:courses:02","namespace":"iot:courses","isadmin":0,"isauth":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../../../lib/exe/js.php%3Ftseed=1476798676"></script>
<script type="text/x-mathjax-config">/*<![CDATA[*/MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ["$","$"], ["\\(","\\)"] ],
        displayMath: [ ["$$","$$"], ["\\[","\\]"] ],
        processEscapes: true
    }
});
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<script type="text/javascript">/*<![CDATA[*/
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
		  
/*!]]>*/</script>
<script type="text/javascript">/*<![CDATA[*/
var pageTracker = _gat._getTracker("UA-38383934-1");
pageTracker._initData();
pageTracker._trackPageview();
		  
/*!]]>*/</script>
</head>
<body>
<div class="dokuwiki export">
<!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="02.html#lecture_2web_services">Lecture 2: Web Services</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="02.html#rest_apis">REST APIs</a></div></li>
<li class="level2"><div class="li"><a href="02.html#json_javascript_object_notation">JSON (JavaScript  Object Notation)</a></div></li>
<li class="level2"><div class="li"><a href="02.html#jquery_and_ajax_requests">jQuery and Ajax requests</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="02.html#get">GET</a></div></li>
<li class="level3"><div class="li"><a href="02.html#post">POST</a></div></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="lecture_2web_services">Lecture 2: Web Services</h1>
<div class="level1">

<p>

<iframe src="http://www.slideshare.net/slideshow/embed_code/key/8GnV54kJ1wzvqr" width="425" height="355" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen> </iframe> <div style="margin-bottom:5px"> <strong> <a href="http://www.slideshare.net/AvnerSolomon/slide-curs11" title="Web Services and Mobile" target="_blank">Web Services and Mobile</a> </strong> from <strong><a href="http://www.slideshare.net/AvnerSolomon" target="_blank">Avner Solomon</a></strong> </div>

</p>

<p>
Most of modern apps need at one point another to interact with WEB APIs in order to centralize data, authenticate users or even small updates.
In this course we will talk only about the client side of the APIs and not the server.
WEB <abbr title="Application Programming Interface">API</abbr> clients interact with WEB APIs in pretty much the same way as users interact with web sites, they access a link and they fetch certain information. The main difference would be that instead of human readable information the content is encoded in such manner to be easily processed by our code. Usually the response from an <abbr title="Application Programming Interface">API</abbr> is a text representation of an Object or Array ( it doesn&#039;t matter which coding language is used because the text representation is language independent ).
</p>

<p>
There are multiple types of WEB APIs like SOAP , REST , xml-rpc , json-rpc etc. but in order to simplify this class we will focus on REST services which handle JSON data.
</p>

</div>
<!-- EDIT1 SECTION "Lecture 2: Web Services" [1-1516] -->
<h2 class="sectionedit2" id="rest_apis">REST APIs</h2>
<div class="level2">

<p>
As mentioned before accessing is very similar to viewing the web. REST APIs work over HTTP protocol and even if they support all HTTP methods: HEAD, POST, GET , PUT, DELETE, UPDATE, OPTIONS , most of the time only the main 2 ones will be used:
</p>
<ul>
<li class="level1"><div class="li"> GET to retrieve data from the <abbr title="Application Programming Interface">API</abbr></div>
</li>
<li class="level1"><div class="li"> POST to create or update data server-side through the <abbr title="Application Programming Interface">API</abbr></div>
</li>
</ul>

<p>
GET and POST are the 2 main methods used also when browsing:
</p>
<ul>
<li class="level1"><div class="li"> your browser calls a server resource with the GET method each time you fetch a web page</div>
</li>
<li class="level1"><div class="li"> your browser calls a server resource with the POST method when you submit a secure form</div>
</li>
</ul>

<p>
The main difference between GET and POST is that the POST request HTTP packet also contains a body with the data you want sent to the server. In a form the browser sends the form fields inside this body (example: username and password).
</p>

<p>
The rest APIs use URLs to make the structure of the <abbr title="Application Programming Interface">API</abbr> easier to understand and also.
For example fetching the news for a news site can be as easy as accessing:
</p>
<pre class="code">news.com/api/news/latest</pre>

<p>
This call would retrieve the most recent news but unlike with a human redable format where we would see images, links, pictures and other content, the response will contain only the essential information:
</p>
<pre class="code javascript">  <span class="br0">&#91;</span>
    <span class="br0">&#123;</span>
      <span class="st0">&quot;news_id&quot;</span><span class="sy0">:</span><span class="st0">&quot;1312&quot;</span><span class="sy0">,</span>
      <span class="st0">&quot;news_title&quot;</span><span class="sy0">:</span><span class="st0">&quot;Title 1&quot;</span><span class="sy0">,</span>
      <span class="st0">&quot;news_content&quot;</span><span class="sy0">:</span><span class="st0">&quot;Content&quot;</span>
    <span class="br0">&#125;</span><span class="sy0">,</span>
    <span class="br0">&#123;</span>
      <span class="st0">&quot;news_id&quot;</span><span class="sy0">:</span><span class="st0">&quot;1313&quot;</span><span class="sy0">,</span>
      <span class="st0">&quot;news_title&quot;</span><span class="sy0">:</span><span class="st0">&quot;Title 2&quot;</span><span class="sy0">,</span>
      <span class="st0">&quot;news_content&quot;</span><span class="sy0">:</span><span class="st0">&quot;Content&quot;</span>
    <span class="br0">&#125;</span><span class="sy0">,</span>
    <span class="br0">&#123;</span>
      <span class="st0">&quot;news_id&quot;</span><span class="sy0">:</span><span class="st0">&quot;1314&quot;</span><span class="sy0">,</span>
      <span class="st0">&quot;news_title&quot;</span><span class="sy0">:</span><span class="st0">&quot;Title 3&quot;</span><span class="sy0">,</span>
      <span class="st0">&quot;news_content&quot;</span><span class="sy0">:</span><span class="st0">&quot;Content&quot;</span>
    <span class="br0">&#125;</span>
  <span class="br0">&#93;</span></pre>

<p>
The above answer represent the JSON encoding of an array containing 3 news. We will discus about JavaScript Object Notation later in this class.
If we would want to create a new news article and we assume we have the rights to do so we would most likely have to access via POST a link similar to
</p>
<pre class="code">news.com/api/news/create</pre>

<p>
and send as payload the info for the new news article
</p>
<pre class="code javascript">  <span class="br0">&#123;</span>
    <span class="st0">&quot;news_title&quot;</span><span class="sy0">:</span><span class="st0">&quot;New Article&quot;</span><span class="sy0">,</span>
    <span class="st0">&quot;news_content&quot;</span><span class="sy0">:</span><span class="st0">&quot;News content&quot;</span>
  <span class="br0">&#125;</span></pre>

<p>
In response to this the server will tell us if creating the new article was successful or not.
</p>

</div>
<!-- EDIT2 SECTION "REST APIs" [1517-3668] -->
<h2 class="sectionedit3" id="json_javascript_object_notation">JSON (JavaScript  Object Notation)</h2>
<div class="level2">

<p>
<a href="https://en.wikipedia.org/wiki/JSON" class="urlextern" title="https://en.wikipedia.org/wiki/JSON"  rel="nofollow"> JSON</a> is an open standard that uses human readable text to encode Objects.
It is an alternative to XML and has less overhead to represent the same information but has some limitations:
</p>
<ul>
<li class="level1"><div class="li"> limited supported data types:</div>
</li>
</ul>
<div class="table sectionedit4"><table class="inline">
	<tr class="row0">
		<th class="col0 leftalign">Data Type       </th><th class="col1 leftalign">Notation                              </th><th class="col2 leftalign">Example             </th>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign"> Number         </td><td class="col1 leftalign"> It can be either integer or double   </td><td class="col2 leftalign"> 2 or 3.84          </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> String         </td><td class="col1"> a series of characters delimited by &quot;</td><td class="col2"> &quot;word&quot; &quot;more words&quot;</td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> Boolean        </td><td class="col1" colspan="2"> either true or false</td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign"> Array          </td><td class="col1 leftalign"> An array can contain any type of data and the data should be delimited by ,                 </td><td class="col2"> [“sting”,2,”another string”] </td>
	</tr>
	<tr class="row5">
		<td class="col0 leftalign"> Object         </td><td class="col1"> An Object is more of a dictionary which contains key pair values, the start of an object is marked by { unlike [ for Arrays</td><td class="col2"> {“firstname”:“Maria” ,”lastname”:“Ioana”}</td>
	</tr>
	<tr class="row6">
		<td class="col0 leftalign"> null           </td><td class="col1" colspan="2"> empty</td>
	</tr>
</table></div>
<!-- EDIT4 TABLE [3975-4631] --><ul>
<li class="level1"><div class="li"> No support for grammar definition like XML Schema or DTD which is used to validate data. DTD and Schema are resources used by independent APIs to make sure they enforce the same data format.</div>
</li>
</ul>

<p>
Example of complex JSON object representing a product in a store (the comments bellow are just for explanatory purposes, not all JSON interpreters support comments since it&#039;s not standard) :
</p>
<pre class="code javascript">  <span class="br0">&#123;</span>
    product_id<span class="sy0">:</span> <span class="nu0">19</span><span class="sy0">,</span> <span class="co1">// numerical unique id of the product,</span>
    product_SKU<span class="sy0">:</span> <span class="st0">&quot;ER-271&quot;</span> <span class="co1">//Storage keeaping unit, an id identifying the products in the storage,</span>
    product_name<span class="sy0">:</span> <span class="st0">&quot;Some product name&quot;</span><span class="sy0">,</span>
    vendor_name<span class="sy0">:</span> <span class="st0">&quot;Ana's shop&quot;</span><span class="sy0">,</span>
    vendor_website<span class="sy0">:</span> <span class="kw2">null</span><span class="sy0">,</span> <span class="co1">// Ana's shop has no website so we left the value null</span>
    related_products<span class="sy0">:</span> <span class="br0">&#91;</span><span class="nu0">21</span><span class="sy0">,</span><span class="nu0">173</span><span class="sy0">,</span><span class="nu0">192</span><span class="br0">&#93;</span> <span class="co1">// array containing ids of related products</span>
    full_price<span class="sy0">:</span> <span class="nu0">200</span><span class="sy0">,</span>
    sale_price<span class="sy0">:</span> <span class="nu0">150</span><span class="sy0">,</span>
    product_tags<span class="sy0">:</span> <span class="br0">&#91;</span><span class="st0">&quot;rings&quot;</span><span class="sy0">,</span><span class="st0">&quot;gold&quot;</span><span class="br0">&#93;</span><span class="sy0">,</span>
    product_reviews<span class="sy0">:</span><span class="br0">&#91;</span> <span class="co1">// an array containing review objects</span>
      <span class="br0">&#123;</span> <span class="co1">// first review object</span>
        review_autor<span class="sy0">:</span><span class="st0">&quot;Dan&quot;</span><span class="sy0">,</span>
        review_rating<span class="sy0">:</span> <span class="nu0">5</span><span class="sy0">,</span>
        review_content<span class="sy0">:</span> <span class="st0">&quot;A great product! Happy with it.&quot;</span>
      <span class="br0">&#125;</span><span class="sy0">,</span>
      <span class="br0">&#123;</span> <span class="co1">//second review object</span>
        review_autor<span class="sy0">:</span><span class="st0">&quot;Mark&quot;</span><span class="sy0">,</span>
        review_rating<span class="sy0">:</span> <span class="nu0">4.5</span><span class="sy0">,</span>
        review_content<span class="sy0">:</span> <span class="st0">&quot;Great product but the price is a little too high.&quot;</span>
      <span class="br0">&#125;</span>
    <span class="br0">&#93;</span>
  <span class="br0">&#125;</span></pre>

</div>
<!-- EDIT3 SECTION "JSON (JavaScript  Object Notation)" [3669-5911] -->
<h2 class="sectionedit5" id="jquery_and_ajax_requests">jQuery and Ajax requests</h2>
<div class="level2">

<p>
In order to call an <abbr title="Uniform Resource Locator">URL</abbr> for a REST api from our javascript code inside the app we would need to make an AJAX call, but in order to simplify this process we included the jQuery javascript library inside the IoT template. This will allows you to write ajax get and post calls on the fly. Also jQuery will offer you a lot of tools to modify your <abbr title="HyperText Markup Language">HTML</abbr> elements and the overall design of the app from the javascript code.
</p>

</div>
<!-- EDIT5 SECTION "jQuery and Ajax requests" [5912-6367] -->
<h3 class="sectionedit6" id="get">GET</h3>
<div class="level3">

<p>
In order to GET data from an <abbr title="Uniform Resource Locator">URL</abbr> all we have to do is:
</p>
<pre class="code javascript">  $.<span class="kw1">get</span><span class="br0">&#40;</span><span class="st0">&quot;URL&quot;</span><span class="sy0">,</span><span class="kw1">function</span><span class="br0">&#40;</span>data<span class="br0">&#41;</span><span class="br0">&#123;</span>
    <span class="co1">//code runs on success and data is the response </span>
  <span class="br0">&#125;</span><span class="br0">&#41;</span></pre>

<p>
or
</p>
<pre class="code javascript">  $.<span class="kw1">get</span><span class="br0">&#40;</span><span class="st0">&quot;URL&quot;</span><span class="br0">&#41;</span>
    .<span class="me1">done</span><span class="br0">&#40;</span><span class="kw1">function</span><span class="br0">&#40;</span>data<span class="br0">&#41;</span><span class="br0">&#123;</span>
       <span class="co1">//code on success</span>
    <span class="br0">&#125;</span><span class="br0">&#41;</span>
    .<span class="me1">fail</span><span class="br0">&#40;</span><span class="kw1">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#123;</span>
       <span class="co1">//code on fail</span>
    <span class="br0">&#125;</span><span class="br0">&#41;</span>
    .<span class="me1">always</span><span class="br0">&#40;</span><span class="kw1">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#123;</span>
       <span class="co1">// code called at every end of ajax request for both success and failiure</span>
    <span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
For example let&#039;s assume we want to fetch the title of the latest news presented in the theoretical REST <abbr title="Application Programming Interface">API</abbr> at the start of this lesson with the <abbr title="Uniform Resource Locator">URL</abbr>
</p>
<pre class="code">  news.com/api/news/latest</pre>
<pre class="code javascript">  $.<span class="kw1">get</span><span class="br0">&#40;</span><span class="st0">&quot;news.com/api/news/latest&quot;</span><span class="sy0">,</span><span class="kw1">function</span><span class="br0">&#40;</span>data<span class="br0">&#41;</span><span class="br0">&#123;</span>
    <span class="kw1">var</span> latest_news <span class="sy0">=</span> JSON.<span class="me1">parse</span><span class="br0">&#40;</span>data<span class="br0">&#41;</span><span class="sy0">;</span> <span class="co1">// we decode the JSON object</span>
&nbsp;
    <span class="kw1">var</span> title <span class="sy0">=</span> latest_news<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>.<span class="me1">news_title</span><span class="sy0">;</span> 
    <span class="co1">// we fetch the news_title property of the first news in the array</span>
    console.<span class="me1">log</span><span class="br0">&#40;</span> title <span class="br0">&#41;</span><span class="sy0">;</span> <span class="co1">//and display the title in the javascript console of the browser</span>
  <span class="br0">&#125;</span><span class="br0">&#41;</span></pre>

</div>
<!-- EDIT6 SECTION "GET" [6368-7392] -->
<h3 class="sectionedit7" id="post">POST</h3>
<div class="level3">

<p>
In order to POST data to an <abbr title="Application Programming Interface">API</abbr>
</p>
<pre class="code javascript">  $.<span class="me1">post</span><span class="br0">&#40;</span><span class="st0">&quot;URL&quot;</span><span class="sy0">,</span>data<span class="sy0">,</span><span class="kw1">function</span><span class="br0">&#40;</span>response<span class="br0">&#41;</span><span class="br0">&#123;</span>
    <span class="co1">//code runs on success</span>
  <span class="br0">&#125;</span><span class="br0">&#41;</span>
  <span class="coMULTI">/*
   URL = URL for the API
   data = the data sent to the server (optional)
  */</span></pre>

<p>
or
</p>
<pre class="code javascript">  $.<span class="me1">post</span><span class="br0">&#40;</span><span class="st0">&quot;URL&quot;</span><span class="sy0">,</span>data<span class="br0">&#41;</span>
    .<span class="me1">done</span><span class="br0">&#40;</span><span class="kw1">function</span><span class="br0">&#40;</span>respose<span class="br0">&#41;</span><span class="br0">&#123;</span>
       <span class="co1">//code on success</span>
    <span class="br0">&#125;</span><span class="br0">&#41;</span>
    .<span class="me1">fail</span><span class="br0">&#40;</span><span class="kw1">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#123;</span>
       <span class="co1">//code on fail</span>
    <span class="br0">&#125;</span><span class="br0">&#41;</span>
    .<span class="me1">always</span><span class="br0">&#40;</span><span class="kw1">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#123;</span>
       <span class="co1">// code called at every end of ajax request for both success and failiure</span>
    <span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
Now let&#039;s try to imagine the scenario where we want to create an article with the <abbr title="Application Programming Interface">API</abbr> presented at the start of this class at:
</p>
<pre class="code">  news.com/api/news/create</pre>
<pre class="code javascript">  <span class="kw1">var</span> new_article <span class="sy0">=</span> <span class="br0">&#123;</span> newst_title<span class="sy0">:</span><span class="st0">&quot;My article&quot;</span><span class="sy0">,</span> news_content<span class="sy0">:</span><span class="st0">&quot;My content&quot;</span><span class="br0">&#125;</span><span class="sy0">;</span>
  <span class="co1">// we will be using JSON.stringify and JSON.parse to encode/decode</span>
  <span class="co1">// the JavaScript object into a JSON string</span>
  $.<span class="me1">post</span><span class="br0">&#40;</span><span class="st0">&quot;news.com/api/news/create&quot;</span><span class="sy0">,</span> JSON.<span class="me1">stringify</span><span class="br0">&#40;</span>new_article<span class="br0">&#41;</span><span class="sy0">,</span> <span class="kw1">function</span><span class="br0">&#40;</span>result<span class="br0">&#41;</span><span class="br0">&#123;</span>
    result <span class="sy0">=</span> JSON.<span class="me1">parse</span><span class="br0">&#40;</span>result<span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="co1">// we will assume that if the object returned by the server has</span>
    <span class="co1">// no &quot;error&quot; property the creation was a success</span>
    <span class="kw1">if</span><span class="br0">&#40;</span><span class="sy0">!</span>restul.<span class="me1">error</span><span class="br0">&#41;</span><span class="br0">&#123;</span>
       alert<span class="br0">&#40;</span><span class="st0">&quot;Article created!&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
  <span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

</div>
<!-- EDIT7 SECTION "POST" [7393-] --></div>
</body>
</html>
