    
    

<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <title>iot:labs:09</title>
<meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="date" content="2016-06-27T10:30:57+0300"/>
<meta name="keywords" content="iot,labs,09"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../../../lib/exe/opensearch.php" title="CS Open CourseWare"/>
<link rel="start" href="../../../../../courses.1.html"/>
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="../../../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="../../../../feed.php%3Fmode=list&amp;ns=iot:labs"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="09.html"/>
<link rel="canonical" href="../../../../iot/labs/09.html"/>
<link rel="stylesheet" type="text/css" href="../../../../lib/exe/css.php%3Ft=arctic&amp;tseed=1476798676.css"/>
<script type="text/javascript">/*<![CDATA[*/var NS='iot:labs';var JSINFO = {"id":"iot:labs:09","namespace":"iot:labs","isadmin":0,"isauth":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../../../lib/exe/js.php%3Ftseed=1476798676"></script>
<script type="text/x-mathjax-config">/*<![CDATA[*/MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ["$","$"], ["\\(","\\)"] ],
        displayMath: [ ["$$","$$"], ["\\[","\\]"] ],
        processEscapes: true
    }
});
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<script type="text/javascript">/*<![CDATA[*/
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
		  
/*!]]>*/</script>
<script type="text/javascript">/*<![CDATA[*/
var pageTracker = _gat._getTracker("UA-38383934-1");
pageTracker._initData();
pageTracker._trackPageview();
		  
/*!]]>*/</script>
</head>
<body>
<div class="dokuwiki export">
<!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="09.html#lab_9connect_and_use_an_lcd">Lab 9: Connect and use an LCD</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="09.html#what_you_need">What you need</a></div></li>
<li class="level2"><div class="li"><a href="09.html#the_setup">The Setup</a></div></li>
<li class="level2"><div class="li"><a href="09.html#the_code">The Code</a></div></li>
<li class="level2"><div class="li"><a href="09.html#exercises">Exercises</a></div></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="lab_9connect_and_use_an_lcd">Lab 9: Connect and use an LCD</h1>
<div class="level1">

<p>
In this project you are going to connect an LCD to your board and write a short message on it.
</p>

</div>
<!-- EDIT1 SECTION "Lab 9: Connect and use an LCD" [1-140] -->
<h2 class="sectionedit2" id="what_you_need">What you need</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li">  One Raspberry Pi connected to Wyliodrin STUDIO;</div>
</li>
<li class="level1"><div class="li">  One 16&times;2 LCD;</div>
</li>
<li class="level1"><div class="li">  One breadboard;</div>
</li>
<li class="level1"><div class="li"> Jumper wires;</div>
</li>
</ul>

</div>
<!-- EDIT2 SECTION "What you need" [141-279] -->
<h2 class="sectionedit3" id="the_setup">The Setup</h2>
<div class="level2">

<p>
<a href="../../../../_detail/iot/labs/lcd-expander.jpg%3Fid=iot%253Alabs%253A09.html" class="media" title="iot:labs:lcd-expander.jpg"><img src="../../../../_media/iot/labs/lcd-expander.jpg%3Fw=500&amp;tok=8a27b7" class="mediacenter" alt="" width="500" /></a>
The LCD in the kit is connected to a port expander (MCP23008). This allows the LCD to be controlled via the I2C protocol, thus reducing the number of pins you need to connect the LCD to. In this case, you just need to connect the expander to GND, 5V, SCL and SDA pins, according to the indicators on the expander. You can find the appropriate pins in the <strong>Pin Layout</strong> tab. You just need to connect the SDA port on the port expander with the SDA pin on the board and so on.
</p>

</div>
<!-- EDIT3 SECTION "The Setup" [280-814] -->
<h2 class="sectionedit4" id="the_code">The Code</h2>
<div class="level2">

<p>
<a href="../../../../_detail/iot/labs/lcd-simple-example.png%3Fid=iot%253Alabs%253A09.html" class="media" title="iot:labs:lcd-simple-example.png"><img src="../../../../_media/iot/labs/lcd-simple-example.png%3Fw=600&amp;tok=5c6854" class="mediacenter" alt="" width="600" /></a>
You go to the Wyliodrin Applications page and create a new application. You name it and select Streams as programming language. Once created, you click on the new application&#039;s name to open it.
</p>

<p>
First of all, you need to initialise the LCD. For this, you drag the <strong>run</strong> node and select <strong>Fire once at start</strong> so you make sure that once you run the application a first message is sent. This is only required to trigger the <strong>init LCD</strong> node, so you can assure there is no other message being sent again. For this, drag the <strong>trigger</strong> node and double click on it.
</p>

<p>
<a href="../../../../_detail/iot/labs/trigger-block.png%3Fid=iot%253Alabs%253A09.html" class="media" title="iot:labs:trigger-block.png"><img src="../../../../_media/iot/labs/trigger-block.png%3Fw=400&amp;tok=d8d3ee" class="mediacenter" alt="" width="400" /></a>
</p>

<p>
You need to set this node to <strong>wait until reset</strong>. This will make the node to send the first message and then wait until it receives a message containing the property <strong>reset</strong>, which will never happen. 
Next, the <strong>init LCD</strong> node initializes the LCD.
</p>

<p>
First of all, you need to require the <strong>wyliodrin</strong> module, which exposes some simple functions in order to control the LCD. Otherwise you would need to implement the protocol in order to control it. 
</p>

<p>
Once you have the <strong>wyliodrin</strong> variable, call the <strong>LiquidCrystal</strong> constructor in order to obtain a <strong>LiquidCrystal</strong> object. The constructer receives 0 as parameter.
</p>

<p>
Why is the value 0 the parameter of the contructor? This type of LCD communicates with the Raspberry Pi board via that I2C protocol. Taking into account how the I2C protocol behaves, you would need to mention the bus specific to the LCD, that usually is 32. However, in order to be able to connect multiple LCDs at once, they have three jumpers which can be connected in order to represent values from 0 to 7, thus being able to identify eight different LCDs. This is the value you need to pass to the constructor, in this case, no jumper is connected so we passed the value 0.
</p>

<p>
<a href="../../../../_detail/iot/labs/init-lcd.png%3Fid=iot%253Alabs%253A09.html" class="media" title="iot:labs:init-lcd.png"><img src="../../../../_media/iot/labs/init-lcd.png%3Fw=400&amp;tok=9f30ca" class="mediacenter" alt="" width="400" /></a>
</p>

<p>
What is new at the code presented above is the <strong>context.global.lcd</strong> structure. You need to use this because you want the <strong>lcd</strong> variable to be available from other nodes also (Display on LCD node) and <strong>context.global</strong> is a variable accessible to all the nodes, so you just set the lcd property and you will be able to use it from any other node.
</p>

<p>
<a href="../../../../_detail/iot/labs/display-lcd-simple.png%3Fid=iot%253Alabs%253A09.html" class="media" title="iot:labs:display-lcd-simple.png"><img src="../../../../_media/iot/labs/display-lcd-simple.png%3Fw=400&amp;tok=f3edf7" class="mediacenter" alt="" width="400" /></a>
</p>

<p>
The <strong>display LCD</strong> node is another function node which first clears the LCD, then prints a string on it. Notice that the global <strong>lcd</strong> variable is used.
</p>

</div>
<!-- EDIT4 SECTION "The Code" [815-3278] -->
<h2 class="sectionedit5" id="exercises">Exercises</h2>
<div class="level2">
<ol>
<li class="level1"><div class="li"> Use a temperature sensor and display the temperature on the LCD.</div>
</li>
</ol>

</div>
<!-- EDIT5 SECTION "Exercises" [3279-] --></div>
</body>
</html>
