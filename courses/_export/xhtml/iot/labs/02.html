    
    

<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <title>iot:labs:02</title>
<meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="date" content="2016-06-23T10:14:52+0300"/>
<meta name="keywords" content="iot,labs,02"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../../../lib/exe/opensearch.php" title="CS Open CourseWare"/>
<link rel="start" href="../../../../../courses.1.html"/>
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="../../../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="../../../../feed.php%3Fmode=list&amp;ns=iot:labs"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="02.html"/>
<link rel="canonical" href="../../../../iot/labs/02.html"/>
<link rel="stylesheet" type="text/css" href="../../../../lib/exe/css.php%3Ft=arctic&amp;tseed=1476798676.css"/>
<script type="text/javascript">/*<![CDATA[*/var NS='iot:labs';var JSINFO = {"id":"iot:labs:02","namespace":"iot:labs","isadmin":0,"isauth":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../../../lib/exe/js.php%3Ftseed=1476798676"></script>
<script type="text/x-mathjax-config">/*<![CDATA[*/MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ["$","$"], ["\\(","\\)"] ],
        displayMath: [ ["$$","$$"], ["\\[","\\]"] ],
        processEscapes: true
    }
});
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<script type="text/javascript">/*<![CDATA[*/
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
		  
/*!]]>*/</script>
<script type="text/javascript">/*<![CDATA[*/
var pageTracker = _gat._getTracker("UA-38383934-1");
pageTracker._initData();
pageTracker._trackPageview();
		  
/*!]]>*/</script>
</head>
<body>
<div class="dokuwiki export">
<!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level2"><div class="li"><a href="02.html#lab_2web_services">Lab 2: Web Services</a></div></li>
<li class="level2"><div class="li"><a href="02.html#chat">1) Chat</a></div></li>
<li class="level2"><div class="li"><a href="02.html#newsfeed">2) Newsfeed</a></div></li>
<li class="level2"><div class="li"><a href="02.html#comunicate_with_webservers_from_your_boards">3) Comunicate with webservers from your boards</a></div></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h2 class="sectionedit1" id="lab_2web_services">Lab 2: Web Services</h2>
<div class="level2">

</div>
<!-- EDIT1 SECTION "Lab 2: Web Services" [1-33] -->
<h2 class="sectionedit2" id="chat">1) Chat</h2>
<div class="level2">

<p>
Using the what you learned in course 11 continue the chat app you started in laboratory 10.
For this you have an api at
<a href="http://api.my-sandbox.co/chat/chat.php" class="urlextern" title="http://api.my-sandbox.co/chat/chat.php"  rel="nofollow">http://api.my-sandbox.co/chat/chat.php</a>
When you call get on it you will receive all the messages
When you send via post the variables username and msg to it, it will add a message to the chat.
For visibility show only last 5-10 messages. Each message is separated by “\n”
</p>

<p>
In order to fetch the messages you need to use the ajax get method from jquery and
replace the \n with &lt;br&gt; in order to display them
</p>
<pre class="code">$.get(&#039;http://api.my-sandbox.co/chat/chat.php&#039;, function(msgs){
  msgs = msgs.split(&quot;\n&quot;).slice(-5).join(&quot;&lt;br&gt;&quot;);
  //display msgs in some container
})</pre>

<p>
The split method applied on a string splits the string into an array of strings using the given separator.
The slice method is used to select certain elements of an array , here the last 5.
The join method applied on an array returns of string generated by concatenating the elements of the array
of delimiting them by the given separator.
</p>

<p>
In order to send a message you will need to use the post ajax call:
</p>
<pre class="code">$.post(&#039;http://api.my-sandbox.co/chat/chat.php&#039;,{username:&quot;some user name&quot;, msg:&quot;the contents of the msg&quot;}, function(result){
  //code to run when msg sent successfully 
})</pre>

<p>
In order to make the chat from the last laboratory to work, all you need to do is code the chatSend method to post
the latest message to the server as shown above  and retrieve the messages every second by calling the get
method shown above every 1000 ms with the help of an interval (setInterval).
</p>

<p>
Your chatSend method should now look like this:
</p>
<pre class="code">chatSend:function(){
  $.post(&#039;http://api.my-sandbox.co/chat/chat.php&#039;,
         {username:$(&quot;#username&quot;).val(), msg:$(&quot;#msg&quot;).val()}
  );
}</pre>

</div>
<!-- EDIT2 SECTION "1) Chat" [34-1832] -->
<h2 class="sectionedit3" id="newsfeed">2) Newsfeed</h2>
<div class="level2">

<p>
Continue the newsfeed you started in laboratory 10.
Implement support for reading the whole article bu showing it on a new page
and support for liking articles and display the number of likes.
</p>

<p>
For this you will have an api at:
</p>

<p>
<a href="http://api.my-sandbox.co/news/get.php" class="urlextern" title="http://api.my-sandbox.co/news/get.php"  rel="nofollow">http://api.my-sandbox.co/news/get.php</a>
used to fetch latest news and
<a href="http://api.my-sandbox.co/news/get.php?id=PRIMARY_KEY_OF_ARTICLE" class="urlextern" title="http://api.my-sandbox.co/news/get.php?id=PRIMARY_KEY_OF_ARTICLE"  rel="nofollow">http://api.my-sandbox.co/news/get.php?id=PRIMARY_KEY_OF_ARTICLE</a>
to fetch the full article
</p>

<p>
and for likes
</p>

<p>
GET <a href="http://api.my-sandbox.co/news/like.php" class="urlextern" title="http://api.my-sandbox.co/news/like.php"  rel="nofollow">http://api.my-sandbox.co/news/like.php</a> with
with id set in order to get the number of likes for an article
</p>

<p>
GET <a href="http://api.my-sandbox.co/news/like.php" class="urlextern" title="http://api.my-sandbox.co/news/like.php"  rel="nofollow">http://api.my-sandbox.co/news/like.php</a> with
with id and uuid set in order to get if you liked or not an article
</p>

<p>
POST <a href="http://api.my-sandbox.co/news/like.php" class="urlextern" title="http://api.my-sandbox.co/news/like.php"  rel="nofollow">http://api.my-sandbox.co/news/like.php</a> with a JSON
</p>
<pre class="code">{
  method:&quot;like&quot;,
  uuid:&quot;phone-uuid&quot;,
  pk:&quot;article-pk&quot;
}</pre>

<p>
in order to like an article
</p>

<p>
POST <a href="http://api.my-sandbox.co/news/like.php" class="urlextern" title="http://api.my-sandbox.co/news/like.php"  rel="nofollow">http://api.my-sandbox.co/news/like.php</a> with a JSON
</p>
<pre class="code">{
  method:&quot;unlike&quot;,
  uuid:&quot;phone-uuid&quot;,
  pk:&quot;article-pk&quot;
}</pre>

<p>
in order to dislike an article.
</p>

<p>
To get the uuid of the phone just access
device.uuid
The device plugin must be installed (it should be installed in your apps by default but you will have to move the config.xml from the root folder in the www folder)
</p>

<p>
Fetching of news is identical to fetching the text in exercise one. This is also true for fetching the
like count with or without id.
</p>

<p>
I order to set JSON encoded messages though you will need to use JSON.stringify method like in the following example:
</p>
<pre class="code">var json_object = { method:&quot;like&quot;, uuid:device.uuid, pk:1 }
$.post(URL,JSON.stringify(json_object), function(response){ //post respone action });</pre>

</div>
<!-- EDIT3 SECTION "2) Newsfeed" [1833-3427] -->
<h2 class="sectionedit4" id="comunicate_with_webservers_from_your_boards">3) Comunicate with webservers from your boards</h2>
<div class="level2">

<p>
Depending on what you made your boards try to make the phone communicate with the webserver from the boards.
</p>

</div>
<!-- EDIT4 SECTION "3) Comunicate with webservers from your boards" [3428-] --></div>
</body>
</html>
