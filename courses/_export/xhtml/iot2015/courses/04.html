    
    

<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <title>iot2015:courses:04</title>
<meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="date" content="2016-06-17T15:45:22+0300"/>
<meta name="keywords" content="iot2015,courses,04"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../../../lib/exe/opensearch.php" title="CS Open CourseWare"/>
<link rel="start" href="../../../../../courses.1.html"/>
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="../../../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="../../../../feed.php%3Fmode=list&amp;ns=iot2015:courses"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="04.html"/>
<link rel="canonical" href="../../../../iot2015/courses/04.html"/>
<link rel="stylesheet" type="text/css" href="../../../../lib/exe/css.php%3Ft=arctic&amp;tseed=1479898000.css"/>
<script type="text/javascript">/*<![CDATA[*/var NS='iot2015:courses';var JSINFO = {"id":"iot2015:courses:04","namespace":"iot2015:courses","isadmin":0,"isauth":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../../../lib/exe/js.php%3Ftseed=1479898000"></script>
<script type="text/x-mathjax-config">/*<![CDATA[*/MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ["$","$"], ["\\(","\\)"] ],
        displayMath: [ ["$$","$$"], ["\\[","\\]"] ],
        processEscapes: true
    }
});
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<script type="text/javascript">/*<![CDATA[*/
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
		  
/*!]]>*/</script>
<script type="text/javascript">/*<![CDATA[*/
var pageTracker = _gat._getTracker("UA-38383934-1");
pageTracker._initData();
pageTracker._trackPageview();
		  
/*!]]>*/</script>
</head>
<body>
<div class="dokuwiki export">
<!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="04.html#lecture_4sensors_and_peripherals">Lecture 4: Sensors and peripherals</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="04.html#sensors">Sensors</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="04.html#button">Button</a></div>
<ul class="toc">
<li class="level4"><div class="li"><a href="04.html#button_debounce">Button Debounce</a></div></li>
</ul>
</li>
<li class="level3"><div class="li"><a href="04.html#potentiometer">Potentiometer</a></div></li>
<li class="level3"><div class="li"><a href="04.html#thermistor">Thermistor</a></div></li>
<li class="level3"><div class="li"><a href="04.html#temperature_sensor">Temperature sensor</a></div></li>
<li class="level3"><div class="li"><a href="04.html#light_sensor">Light Sensor</a></div></li>
<li class="level3"><div class="li"><a href="04.html#gas_sensor">Gas Sensor</a></div></li>
<li class="level3"><div class="li"><a href="04.html#distance_sensor">Distance Sensor</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="04.html#digital_sensors">Digital sensors</a></div>
<ul class="toc">
<li class="clear">
<ul class="toc">
<li class="level4"><div class="li"><a href="04.html#spi">SPI</a></div></li>
<li class="level4"><div class="li"><a href="04.html#i2c">I2C</a></div></li>
</ul>
</li>
<li class="level3"><div class="li"><a href="04.html#accelerometer_and_gyroscope">Accelerometer and Gyroscope</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="04.html#peripherals">Peripherals</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="04.html#led">LED</a></div></li>
<li class="level3"><div class="li"><a href="04.html#segment_display">7 segment display</a></div></li>
<li class="level3"><div class="li"><a href="04.html#shift_register">Shift register</a></div></li>
<li class="level3"><div class="li"><a href="04.html#lcd">LCD</a></div></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="lecture_4sensors_and_peripherals">Lecture 4: Sensors and peripherals</h1>
<div class="level1">

<p>

<center>
<iframe width="640" height="360" src="https://www.youtube-nocookie.com/embed/7UZdECEYnBs" frameborder="0" allowfullscreen></iframe>
</center>

Slides are available from the <a href="http://www.slideshare.net/alexandruradovici/iot-4-49837669" class="urlextern" title="http://www.slideshare.net/alexandruradovici/iot-4-49837669"  rel="nofollow">link</a>
</p>

<p>
This course will go through both analog and digital sensors, describing how they function and different ways of comnnecting and using them. More than this, it will present some other important peripherals, from the basic ones: LEDs to more complicated- shift registers or significant ones- LCDs. 
</p>

</div>
<!-- EDIT1 SECTION "Lecture 4: Sensors and peripherals" [1-1232] -->
<h2 class="sectionedit2" id="sensors">Sensors</h2>
<div class="level2">

<p>
Sensors are devices that scan the environment and get data from it. Some examples of sensors are : thermistors , buttons (because they send a value, sensing the environment), photo resistors, infra-red sensors, distance sensors.
</p>

<p>
Types of sensors:
</p>
<ul>
<li class="level1"><div class="li"> Analog Sensors - send an analog value that <strong>needs to be processed by the ADC</strong></div>
</li>
<li class="level1"><div class="li"> Digital Sensors - send a digital value</div>
</li>
</ul>

<p>
<em>Basically, all the sensing parts are analog.</em>
</p>

<p>
For the analog sensor the sensing part is directly connected to a micro controller. They are easy to interface, you only need an ADC to do some computing to find the real value.
</p>

<p>
Digital sensors are more complicated  because the micro controller that processes the data is already in the box of the sensor and it sends the data out on a communication channel  that  implements some type of  protocol. In order to get the data, the device needs to communicate with the sensor via the protocol.
</p>

<p>
For the analog sensors there are two types: with two or three pins.
</p>

<p>
An analog sensors will most probably be connected as a <em>voltage divider</em>. Such a sensor has a variable resistance, according to a specific environment element. Take a <em>light sensor</em> as an example: the more light there is, the lower the resistance. For the <em>temperature sensor</em>, the higher the temperature, the lower the resistance. You practically measure the voltage drop in the circuit. 
The 2 leg and 3 leg analog sensors are mentioned above. 
The sensors that have 3 pins usually have the voltage divider already integrated: one pin goes to VCC, one to the Ground and the third pin goes to the analog input. 
For the sensors withe 2 legs, you have to build the voltage devider yourself by adding a resistance to the circuit
</p>

<p>
<p><div class="noteclassic"> If you switch VCC with ground, some sensors will burn. 
</div></p>
 Another particuparity of the sensors is that they will introduce some errors in the measurements, depending on the quality of the sensor. These parts usually increase in accuracy if they have the voltage devider inside as they bring some corrections. More to this, the sensors are not linear.
</p>

<p>
One simple way to connect errors in reading or the ones that occurred due to the fact that the circuit is not perfect is to average them (usually using 1000 samples). This works on micro controllers, but on computer boards, it might result in reading the same value over and over.
</p>

</div>
<!-- EDIT2 SECTION "Sensors" [1233-3625] -->
<h3 class="sectionedit3" id="button">Button</h3>
<div class="level3">

<p>
It is one of the simplest sensors that you can connect. It is in fact an analog sensor, but it can only report 2 values : either 1 or 0. If the button is released, the resistance is infinite, if it is pressed, the resistance becomes 0  and  the input will be directly connected to the ground.
</p>

<p>
<a href="../../../../_detail/iot2015/courses/pull-up_resistor.png%3Fid=iot2015%253Acourses%253A04.html" class="media" title="iot2015:courses:pull-up_resistor.png"><img src="../../../../_media/iot2015/courses/pull-up_resistor.png%3Fw=300&amp;tok=eee2d0" class="mediacenter" alt="" width="300" /></a>
</p>

<p>
The button becomes a pull-up resistor because when the button is not pressed it pulls up the voltage up to 5V. You need a really small resistor so that when the button is in the air the voltage drop will be insignificantly low, so that you can still read 5 volts. The problem comes up when you press the button for a longer period of time. In conclusion, you need a resistor sufficiently high that you won&#039;t drain the source too fast, but sufficiently low to be able to read the value 1.
</p>

<p>
If R1 is replaced by S1 it will be called a pull-down resistor: it will pull down the voltage from that point to the ground the moment the button is not pressed. When the button is pressed it will stop the current from flowing too fast and having a short circuit. The input will be connected to VCC.
</p>

</div>

<h4 id="button_debounce">Button Debounce</h4>
<div class="level4">

<p>
This problem is really visible on micro controllers because they sample fast. Buttons are imperfect, so from the moment you start pressing the button, there is a short time when the button&#039;s connectors start approaching and the distance is really small resulting in an electric discharge. The resistance will be neither 0, nor infinite, so for a short period of time the resistance will vary. 
</p>

<p>
<a href="../../../../_detail/iot2015/courses/button_debounce.png%3Fid=iot2015%253Acourses%253A04.html" class="media" title="iot2015:courses:button_debounce.png"><img src="../../../../_media/iot2015/courses/button_debounce.png%3Fw=300&amp;tok=5e5e77" class="mediacenter" alt="" width="300" /></a>
</p>

<p>
With the microelectronics, you will see many values of 1 and 0 continuously changing.
One way to debounce is to <em>average the values</em> and if the result is different from 0 or 1, then to discard the measurement because the button bounced. Another way is to <em>use a trigger</em> which, for an amount of time won&#039;t read any other value thus not detecting the edges.
Expensive microcontrollers have debouncing circuits.
</p>

</div>
<!-- EDIT3 SECTION "Button" [3626-5661] -->
<h3 class="sectionedit4" id="potentiometer">Potentiometer</h3>
<div class="level3">

<p>
A potentiometer is a variable resistance, with 3 pins. Usually it is a full resistor and the pin is connected in the middle (it can float around the full resistor and split it into two resistors so it works as a voltage divider).
You can connect it in two ways: either by <em>making a voltage divider</em>, choose R1 and connect two of the pins in the voltage divider (the middle one and one of the extremities), or by <em>connecting one pin to VCC, one the Ground and the middle one to the input</em>.
To have a linear function as input from the sensor some computing is requested.
</p>

</div>
<!-- EDIT4 SECTION "Potentiometer" [5662-6259] -->
<h3 class="sectionedit5" id="thermistor">Thermistor</h3>
<div class="level3">

<p>
Let&#039;s see an example of how an analog sensor can be connected to a board and how an application looks in Visual Programming for the thermistor, for instance. 
This sensor is still a variable resistor that changes its value with the temperature. You can compute the actual temperature using that value and a formula that takes into account the thermistor`s parameters, among which the resistance at 25 degrees. This kind of sensor has a low accuracy and is used to get a rough idea about the temperature.<br/>

<a href="../../../../_detail/iot2015/courses/termistor.png%3Fid=iot2015%253Acourses%253A04.html" class="media" title="iot2015:courses:termistor.png"><img src="../../../../_media/iot2015/courses/termistor.png%3Fw=400&amp;tok=e00bbf" class="mediacenter" alt="" width="400" /></a>
<a href="../../../../_detail/iot2015/courses/thermistorcode.png%3Fid=iot2015%253Acourses%253A04.html" class="media" title="iot2015:courses:thermistorcode.png"><img src="../../../../_media/iot2015/courses/thermistorcode.png%3Fw=550&amp;tok=98d7d5" class="mediacenter" alt="" width="550" /></a>
</p>

</div>
<!-- EDIT5 SECTION "Thermistor" [6260-6875] -->
<h3 class="sectionedit6" id="temperature_sensor">Temperature sensor</h3>
<div class="level3">

<p>
 Note that there is a difference between the two sensors, consisting of the fact that the temperature sensor has a linear resistance-temperature characteristic, while the thermistor usually has the output voltage as a logarithmic or exponential function. Also the formulas to find the temperature in Celsius degrees are different. 
</p>

</div>
<!-- EDIT6 SECTION "Temperature sensor" [6876-7238] -->
<h3 class="sectionedit7" id="light_sensor">Light Sensor</h3>
<div class="level3">

<p>
This is also a resistance that changes its value due to the amount of photons it receives. Measuring the voltage drop on the resistance, you can get an idea about the light intensity. How does it actually work? If there is much light, there will be many photons in the photocell, thus less electrons to stop the electric current, which means the resistance of the sensor is lower. 
</p>

<p>
<a href="../../../../_detail/iot2015/courses/sezor_lumin.png%3Fid=iot2015%253Acourses%253A04.html" class="media" title="iot2015:courses:sezor_lumin.png"><img src="../../../../_media/iot2015/courses/sezor_lumin.png%3Fw=400&amp;tok=98856d" class="mediacenter" alt="" width="400" /></a>
<a href="../../../../_detail/iot2015/courses/lightvisual.png%3Fid=iot2015%253Acourses%253A04.html" class="media" title="iot2015:courses:lightvisual.png"><img src="../../../../_media/iot2015/courses/lightvisual.png%3Fw=400&amp;tok=eb8989" class="mediacenter" alt="" width="400" /></a>
</p>

</div>
<!-- EDIT7 SECTION "Light Sensor" [7239-7734] -->
<h3 class="sectionedit8" id="gas_sensor">Gas Sensor</h3>
<div class="level3">

<p>
This sensor detects CO2. Pay attention that in order to detect gas it uses an exothermic chemical reaction therefore it heats up so don`t touch it while it is connected to the board.<br/>

More importantly <strong>pay attention that this sensor IS NOT for safety-important applications</strong>.
</p>

</div>
<!-- EDIT8 SECTION "Gas Sensor" [7735-8037] -->
<h3 class="sectionedit9" id="distance_sensor">Distance Sensor</h3>
<div class="level3">

<p>
This sensor works like a sonar. It has 4 pins. Two of them are the power pins: GND and VCC, and the other two are the trigger and the echo pins. The trigger  will send out an ultrasonic signal and wait for the response. The moment the signal is sent out, the echo pin is 1, when the response comes, this pin turns to 0. 
The distance is measured by multiplying the time needed for the response to come with the speed of sound. 
</p>

<p>
Another type of sensor is an infrared one. It has an ADC inside so computing the distance is after a simple formula. 
</p>

</div>
<!-- EDIT9 SECTION "Distance Sensor" [8038-8611] -->
<h2 class="sectionedit10" id="digital_sensors">Digital sensors</h2>
<div class="level2">

<p>
Digital sensors work with either of the two protocols: SPI or I2C.
</p>

</div>

<h4 id="spi">SPI</h4>
<div class="level4">

<p>
 This protocol involves several slaves and a master. The communication is always initiated by the master. The pins for such a sensor are SS(slave select}, MISO, MOSI, Clock, each with their role. <br/>
 MOSI stands for master out, slave in, which means that a line is created to send data from the master to the slave. MOSI is the line that facilitates the communication in the opposite direction: the slave writes on the line and the master samples.<br/>
The master is the one who generated the clock. SS pin will be 0 when the slave is active and conversely 1 when the slave is inactive. In the first case, the slave waits for the clock to transfer data. One master has pins for each slave, but it can&#039;t work with more than one slave at a time, since the MISO and MOSI lines would get impossible to use. <br/>
Communication in this protocol is always an exchange.
<a href="../../../../_detail/iot2015/courses/spi.png%3Fid=iot2015%253Acourses%253A04.html" class="media" title="iot2015:courses:spi.png"><img src="../../../../_media/iot2015/courses/spi.png%3Fw=400&amp;tok=4f4bc7" class="mediacenter" alt="" width="400" /></a>
</p>

</div>

<h4 id="i2c">I2C</h4>
<div class="level4">

<p>
 This protocol works with one master and several slaves as well. This time there is no slave selection, but each slave has a fixed address. <br/>
It only uses two lines: SDA and SCL: serial data and serial clock line. This protocol is called a half duplex as it only uses one line for communication. The transfer of data goes as follows. The master sends the address. The slave identifies itself, sends out and acknowledgement message, then the master writes or reads the data, all this on the same line.
<a href="../../../../_detail/iot2015/courses/i2c.png%3Fid=iot2015%253Acourses%253A04.html" class="media" title="iot2015:courses:i2c.png"><img src="../../../../_media/iot2015/courses/i2c.png%3Fw=500&amp;tok=fbb09e" class="mediacenter" alt="" width="500" /></a>
In general microcontrollers can be masters or slaves, but the computers can only be masters. 
</p>

</div>
<!-- EDIT10 SECTION "Digital sensors" [8612-10253] -->
<h3 class="sectionedit11" id="accelerometer_and_gyroscope">Accelerometer and Gyroscope</h3>
<div class="level3">

<p>
See below an example of wiring and programming for a digital sensor. 
</p>

<p>
Using this sensor you can determine acceleration on all three axis and also the rotation angle. An important note is that it also measures gravitational acceleration so don`t be surprised to get values different from 0 when the sensor is not moving.
</p>

<p>
<a href="../../../../_detail/iot2015/labs/accel.png%3Fid=iot2015%253Acourses%253A04.html" class="media" title="iot2015:labs:accel.png"><img src="../../../../_media/iot2015/labs/accel.png%3Fw=500&amp;tok=270503" class="mediacenter" alt="" width="500" /></a>
<a href="../../../../_detail/iot2015/labs/acceloblocks.png%3Fid=iot2015%253Acourses%253A04.html" class="media" title="iot2015:labs:acceloblocks.png"><img src="../../../../_media/iot2015/labs/acceloblocks.png%3Fw=500&amp;tok=e916a8" class="mediacenter" alt="" width="500" /></a>
</p>

</div>
<!-- EDIT11 SECTION "Accelerometer and Gyroscope" [10254-10694] -->
<h2 class="sectionedit12" id="peripherals">Peripherals</h2>
<div class="level2">

</div>
<!-- EDIT12 SECTION "Peripherals" [10695-10718] -->
<h3 class="sectionedit13" id="led">LED</h3>
<div class="level3">

<p>
An LED is a light emitting diode. A diode allows the current to pass only in one direction. Also, it has no resistance, which means it will be in a short circuit once it is wired to a circuit with no resistor. You will see when you look at the LED that it has two legs. One is longer, that one is usually the anode. This one has to be connected to the GPIO pin of the Edison. The shorter leg should to be connected to the resistor and then to the ground pin of the board. 
</p>

<p>
Although the position of the resistor is not fixed, it can can either connect the ground to the cathode or the anode to the GPIO pin, the cathode should be connected to the ground to obtain the usually desired behavior. That means that we want the LED to light when the GPIO is set to HIGH and not to light when the GPIO is set to LOW. If you put the legs the other way around, the effect will be the opposite. 
</p>

</div>
<!-- EDIT13 SECTION "LED" [10719-11619] -->
<h3 class="sectionedit14" id="segment_display">7 segment display</h3>
<div class="level3">

<p>
It is an electronic component consisting of 7 LEDs. These have either a common cathode or common anode. In the first case, the LEDs need the value 1 on the pins to be alight, but in the second case, the VCC will be common. The latter situation means that the LEDs are alight when the value on the pins is 0. 
</p>

<p>
How do you connect it? 
<a href="../../../../_detail/iot2015/courses/7segsch.png%3Fid=iot2015%253Acourses%253A04.html" class="media" title="iot2015:courses:7segsch.png"><img src="../../../../_media/iot2015/courses/7segsch.png%3Fw=400&amp;tok=e5adce" class="mediacenter" alt="" width="400" /></a>
</p>

<p>
In visual programming, there are special blocks for the piece. All you have to do is to look up your model&#039;s datasheet AND insert the number of the pins for each segment. 
<a href="../../../../_detail/iot2015/courses/7visual.png%3Fid=iot2015%253Acourses%253A04.html" class="media" title="iot2015:courses:7visual.png"><img src="../../../../_media/iot2015/courses/7visual.png%3Fw=300&amp;tok=d108ac" class="mediacenter" alt="" width="300" /></a>
</p>

</div>
<!-- EDIT14 SECTION "7 segment display" [11620-12234] -->
<h3 class="sectionedit15" id="shift_register">Shift register</h3>
<div class="level3">

<p>
It is a serial to parallel register. Being a register, it is actually a memory. The data stored inside goes from QA to QH. These are the GPIO pins. OE stands for output enable, it is used to disconnect the pins all at once. SER is the serioal input pin, RCLK latch clock, SCLK is the serial clock, SRCLR is the clear pin. 
The data is easy to read, paralleled, but written by shifting it inside. 
When the serial clock switches from 0 to 1 the register reads the value in the SER, puts the value from QH into QH, QG into QH and so on until it&#039;s QAs turn to go into QB and SER is now stored into QA. You would need 8 cycles to change all the values from a register. The bits can be read all at a time, but not written this way. <br/>

Two shift registers can be connected together. <br/>

A shift register offers 8 outputs using only 2 lines: the clock and the SER. 
When SRCLR is 1, everything is cleared out.
The shift register changes the values in the output as others come in, so this can be visible. To avoid this problem, good quality shift registers have a parallel to parallel register. This means that only when a cycle is complete the RCLK will switch and the values are given as output. This is why the latch clock is needed. 
<a href="../../../../_detail/iot2015/labs/595.png%3Fid=iot2015%253Acourses%253A04.html" class="media" title="iot2015:labs:595.png"><img src="../../../../_media/iot2015/labs/595.png%3Fw=400&amp;tok=76ba52" class="mediacenter" alt="" width="400" /></a>
<a href="../../../../_detail/iot2015/courses/595int.png%3Fid=iot2015%253Acourses%253A04.html" class="media" title="iot2015:courses:595int.png"><img src="../../../../_media/iot2015/courses/595int.png%3Fw=500&amp;tok=01f2a9" class="mediacenter" alt="" width="500" /></a>
</p>

</div>
<!-- EDIT15 SECTION "Shift register" [12235-13562] -->
<h3 class="sectionedit16" id="lcd">LCD</h3>
<div class="level3">

<p>
An LCD with 16 colons and 2 rows needs 16 pins to be controlled. It can use either a 4 pin protocol or an 8 pin protocol. The former will need 12 pins and the last, all the 16 pins. There are 4 power pins, meaning two groups of GND and VCC, one group being used by the backlights. 
Any LCD uses a potentiometer to set the contrast. The enable pin of an LCD can be connected to the ground or to a microcontroller. 
There are also I2C LCDs that work with only 4 pins, have an integrated potentiometer and can be connected in the same circuit only if they have different addresses. <br/>

<a href="../../../../_detail/iot2015/labs/lcdstreams_bb.png%3Fid=iot2015%253Acourses%253A04.html" class="media" title="iot2015:labs:lcdstreams_bb.png"><img src="../../../../_media/iot2015/labs/lcdstreams_bb.png%3Fw=300&amp;tok=c1636f" class="mediaright" alt="" width="300" /></a>
<a href="../../../../_detail/iot2015/courses/lcdvisual.png%3Fid=iot2015%253Acourses%253A04.html" class="media" title="iot2015:courses:lcdvisual.png"><img src="../../../../_media/iot2015/courses/lcdvisual.png%3Fw=300&amp;tok=a20452" class="medialeft" alt="" width="300" /></a>
</p>

</div>
<!-- EDIT16 SECTION "LCD" [13563-] --></div>
</body>
</html>
