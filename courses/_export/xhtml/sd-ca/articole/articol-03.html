    
    

<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <title>sd-ca:articole:articol-03</title>
<meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="date" content="2016-02-25T08:36:52+0200"/>
<meta name="keywords" content="sd-ca,articole,articol-03"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../../../lib/exe/opensearch.php" title="CS Open CourseWare"/>
<link rel="start" href="../../../../../courses.1.html"/>
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="../../../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="../../../../feed.php%3Fmode=list&amp;ns=sd-ca:articole"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="articol-03.html"/>
<link rel="canonical" href="../../../../sd-ca/articole/articol-03.html"/>
<link rel="stylesheet" type="text/css" href="../../../../lib/exe/css.php%3Ft=arctic&amp;tseed=1476798676.css"/>
<script type="text/javascript">/*<![CDATA[*/var NS='sd-ca:articole';var JSINFO = {"id":"sd-ca:articole:articol-03","namespace":"sd-ca:articole","isadmin":0,"isauth":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../../../lib/exe/js.php%3Ftseed=1476798676"></script>
<script type="text/x-mathjax-config">/*<![CDATA[*/MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ["$","$"], ["\\(","\\)"] ],
        displayMath: [ ["$$","$$"], ["\\[","\\]"] ],
        processEscapes: true
    }
});
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<script type="text/javascript">/*<![CDATA[*/
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
		  
/*!]]>*/</script>
<script type="text/javascript">/*<![CDATA[*/
var pageTracker = _gat._getTracker("UA-38383934-1");
pageTracker._initData();
pageTracker._trackPageview();
		  
/*!]]>*/</script>
</head>
<body>
<div class="dokuwiki export">
<!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="articol-03.html#articol_03_-_templates_in_c">Articol 03 - Templates in C++</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="articol-03.html#obiective">Obiective</a></div></li>
<li class="level2"><div class="li"><a href="articol-03.html#templates">Templates</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="articol-03.html#function_template">Function Template</a></div></li>
<li class="level3"><div class="li"><a href="articol-03.html#class_template">Class Template</a></div></li>
<li class="level3"><div class="li"><a href="articol-03.html#where_s_the_magic_happening">Where&#039;s the magic happening?</a></div></li>
<li class="level3"><div class="li"><a href="articol-03.html#guideline-uri_implementare">Guideline-uri implementare</a></div></li>
<li class="level3"><div class="li"><a href="articol-03.html#clasa_keystorage">Clasa KeyStorage</a></div></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="articol_03_-_templates_in_c">Articol 03 - Templates in C++</h1>
<div class="level1">

</div>
<!-- EDIT1 SECTION "Articol 03 - Templates in C++" [1-46] -->
<h2 class="sectionedit2" id="obiective">Obiective</h2>
<div class="level2">

<p>
În urma parcurgerii acestui articol studentul va:
</p>
<ul>
<li class="level1"><div class="li"> înțelege conceptul de template</div>
</li>
</ul>

</div>
<!-- EDIT2 SECTION "Obiective" [47-159] -->
<h2 class="sectionedit3" id="templates">Templates</h2>
<div class="level2">

<p>
Motivul principal pentru care folosim C++ în cadrul SD este datorită funcționalității oferite de template-uri.
</p>

<p>
Acestea permit generalizarea tipurilor de date folosite în interiorul funcțiilor și claselor.
</p>

<p>
Sintaxa pentru acestea este:
</p>
<pre class="code c++">template <span class="sy0">&lt;</span>class identifier<span class="sy0">&gt;</span> declaratie<span class="sy0">;</span>
template <span class="sy0">&lt;</span>typename identifier<span class="sy0">&gt;</span> declaratie<span class="sy0">;</span></pre>

<p>
<em>declaratie</em> poate fi fie o funcție, fie o clasă.
Nu există nicio diferență între keyword-ul <em>class</em> și <em>typename</em> - important este că ceea ce urmează după ele este un placeholder pentru un tip de date.
</p>

</div>
<!-- EDIT3 SECTION "Templates" [160-748] -->
<h3 class="sectionedit4" id="function_template">Function Template</h3>
<div class="level3">

<p>
În primul rând template-urile pot fi aplicate funcțiilor.
</p>

<p>
Un exemplu comun și simplu este următorul:
</p>
<pre class="code c++">template<span class="sy0">&lt;</span>typename T<span class="sy0">&gt;</span>
T getMax<span class="br0">&#40;</span>T a<span class="sy0">,</span> T b<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">return</span> a <span class="sy0">&gt;</span> b <span class="sy0">?</span> a <span class="sy0">:</span> b<span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

<p>
Funcția poate fi apelată astfel:
</p>
<pre class="code c++">getMax<span class="sy0">&lt;</span>int<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="nu0">2</span><span class="sy0">,</span> <span class="nu0">3</span><span class="br0">&#41;</span><span class="sy0">;</span>
getMax<span class="sy0">&lt;</span>double<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="nu16">3.2</span><span class="sy0">,</span> <span class="nu16">4.6</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

</div>
<!-- EDIT4 SECTION "Function Template" [749-1073] -->
<h3 class="sectionedit5" id="class_template">Class Template</h3>
<div class="level3">

<p>
Concret, să presupunem că avem o clasă numită KeyStorage care are:
</p>
<ul>
<li class="level1"><div class="li">o cheie (de tip int)</div>
</li>
<li class="level1"><div class="li">un membru de date generic (al cărui tip de date nu îl știm la momentul scrierii clasei).</div>
</li>
</ul>

<p>
Vrem să putem folosi codul clasei indiferent de tipul de date al membrului.
</p>

<p>
Iată cum putem face acest lucru:
</p>
<dl class="code">
<dt><a href="../../../code/sd-ca/articole/articol-03%3Fcodeblock=3" title="Download Snippet" class="mediafile mf_h">KeyStorage.h</a></dt>
<dd><pre class="code c++">template<span class="sy0">&lt;</span>typename T<span class="sy0">&gt;</span>
class KeyStorage <span class="br0">&#123;</span>
public<span class="sy0">:</span>
    <span class="kw4">int</span> key<span class="sy0">;</span>
    T member<span class="sy0">;</span>
<span class="br0">&#125;</span><span class="sy0">;</span></pre>
</dd></dl>

<p>
În funcția main, să presupunem că vrem să folosim clasa cu membrul de tip long.
</p>
<dl class="code">
<dt><a href="../../../code/sd-ca/articole/articol-03%3Fcodeblock=4" title="Download Snippet" class="mediafile mf_cpp">main.cpp</a></dt>
<dd><pre class="code c++"><span class="co2">#include &quot;KeyStorage.h&quot;</span>
&nbsp;
<span class="kw4">int</span> main<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    KeyStorage<span class="sy0">&lt;</span>long<span class="sy0">&gt;</span> keyElement<span class="sy0">;</span>
    <span class="kw1">return</span> <span class="nu0">0</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>
</dd></dl>

<p>
Practic, oriunde folosim tipul de date T în clasă, este înlocuit cu tipul pe care îl specificăm.
</p>

</div>
<!-- EDIT5 SECTION "Class Template" [1074-1816] -->
<h3 class="sectionedit6" id="where_s_the_magic_happening">Where&#039;s the magic happening?</h3>
<div class="level3">

<p>
Sunt destul de multe lucruri de spus despre template-uri, dar ne vom concentra pe lucrurile care schimbă modul în care ați implementat până acum.
</p>

<p>
Template-urile sunt de fapt indicii pentru compilator pentru a genera cod la rândul lui!
Practic, voi îi spuneți compilatorului un șablon generic pe care ați vrea să-l folosiți și el trebuie să fie pregătit să îl pună la dispoziția voastră când aveți nevoie.
</p>

<p>
Ce trebuie să rețineți din asta? Totul se întâmplă la <strong>compile time</strong>, nu la run time.
</p>

<p>
Compilatorul practic analizează modul în care voi folosiți clasa respectivă și generează pentru fiecare mod în care o folosiți șablonul corespunzător.
Folosirea KeyStorage&lt;int&gt; și KeyStorage&lt;float&gt; determină compilatorul să genereze cod pentru ambele clase (înlocuind o dată T cu int și altă cu float).
</p>

</div>
<!-- EDIT6 SECTION "Where's the magic happening?" [1817-2701] -->
<h3 class="sectionedit7" id="guideline-uri_implementare">Guideline-uri implementare</h3>
<div class="level3">

<p>
Pentru că totul se întâmplă la compile time, înseamnă că în momentul în care compilatorul întâlnește secvența de cod ce folosește template-uri trebuie să știe <em>toate</em> modurile în care aceasta este folosita.
</p>

<p>
Asta înseamnă că:
</p>
<ul>
<li class="level1"><div class="li">Trebuie să scrieți întreaga implementare în header! <em>sau</em></div>
</li>
<li class="level1"><div class="li">Scrieți descrierea clasei generice în header, în fișierul de implementare fiecare metodă declarată este de fapt o funcție cu template și la sfârșitul implementării adăugat <em>template class numeclasa&lt;numetip&gt;</em>;</div>
</li>
</ul>

<p>
Ultimul rând de fapt forțează folosirea template-ului cu un anumit tip de date și deci compilatorul generează cod corespunzător (trebuie să scrieți asta pentru toate tipurile).
</p>

</div>
<!-- EDIT7 SECTION "Guideline-uri implementare" [2702-3466] -->
<h3 class="sectionedit8" id="clasa_keystorage">Clasa KeyStorage</h3>
<div class="level3">

<p>
Iată mai jos o structură mai dezvoltată pentru clasa KeyStorage, în care cheia este setată în constructor.
.
</p>
<dl class="code">
<dt><a href="../../../code/sd-ca/articole/articol-03%3Fcodeblock=5" title="Download Snippet" class="mediafile mf_h">KeyStorage.h</a></dt>
<dd><pre class="code c++">template<span class="sy0">&lt;</span>typename T<span class="sy0">&gt;</span>
class KeyStorage <span class="br0">&#123;</span>
public<span class="sy0">:</span>
    KeyStorage<span class="br0">&#40;</span><span class="kw4">int</span> k<span class="br0">&#41;</span><span class="sy0">;</span>
    ~KeyStorage<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    T getMember<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    T setMember<span class="br0">&#40;</span>T element<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
private<span class="sy0">:</span>
    T member<span class="sy0">;</span>
    <span class="kw4">int</span> key<span class="sy0">;</span>
<span class="br0">&#125;</span><span class="sy0">;</span></pre>
</dd></dl>

<p>
Implementarea completa a ei poate fi realizată:
</p>
<ul>
<li class="level1"><div class="li">în header (în cazul template-urilor, acest mod este cel mai indicat).</div>
</li>
<li class="level1"><div class="li">în fișierul de implementare .cc / .cpp (al cărui schelet parțial îl găsiți mai jos).</div>
</li>
</ul>
<dl class="code">
<dt><a href="../../../code/sd-ca/articole/articol-03%3Fcodeblock=6" title="Download Snippet" class="mediafile mf_cpp">KeyStorage.cpp</a></dt>
<dd><pre class="code c++"><span class="co2">#include &quot;KeyStorage.h&quot;</span>
&nbsp;
template<span class="sy0">&lt;</span>typename T<span class="sy0">&gt;</span>
KeyStorage<span class="sy0">&lt;</span>T<span class="sy0">&gt;::</span><span class="me2">KeyStorage</span><span class="br0">&#40;</span><span class="kw4">int</span> k<span class="br0">&#41;</span> <span class="br0">&#123;</span>
<span class="co1">//TODO</span>
<span class="br0">&#125;</span>
&nbsp;
template<span class="sy0">&lt;</span>typename T<span class="sy0">&gt;</span>
KeyStorage<span class="sy0">&lt;</span>T<span class="sy0">&gt;::</span>~KeyStorage<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="co1">//TODO: restul metodelor.</span>
&nbsp;
<span class="co1">// La sfarsit, cu tipurile de date pe care le veti folosi.</span>
template class KeyStorage<span class="sy0">&lt;</span>int<span class="sy0">&gt;;</span>
template class KeyStorage<span class="sy0">&lt;</span>long<span class="sy0">&gt;;</span></pre>
</dd></dl>

</div>
<!-- EDIT8 SECTION "Clasa KeyStorage" [3467-] --></div>
</body>
</html>
