    
    

<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <title>ep:laboratoare:03</title>
<meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="date" content="2016-11-16T14:02:13+0200"/>
<meta name="keywords" content="ep,laboratoare,03"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../../../lib/exe/opensearch.php" title="CS Open CourseWare"/>
<link rel="start" href="../../../../../courses.1.html"/>
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="../../../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="../../../../feed.php%3Fmode=list&amp;ns=ep:laboratoare"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="03.html"/>
<link rel="canonical" href="../../../../ep/laboratoare/03.html"/>
<link rel="stylesheet" type="text/css" href="../../../../lib/exe/css.php%3Ft=arctic&amp;tseed=1476798676.css"/>
<script type="text/javascript">/*<![CDATA[*/var NS='ep:laboratoare';var JSINFO = {"id":"ep:laboratoare:03","namespace":"ep:laboratoare","isadmin":0,"isauth":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../../../lib/exe/js.php%3Ftseed=1476798676"></script>
<script type="text/x-mathjax-config">/*<![CDATA[*/MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ["$","$"], ["\\(","\\)"] ],
        displayMath: [ ["$$","$$"], ["\\[","\\]"] ],
        processEscapes: true
    }
});
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<script type="text/javascript">/*<![CDATA[*/
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
		  
/*!]]>*/</script>
<script type="text/javascript">/*<![CDATA[*/
var pageTracker = _gat._getTracker("UA-38383934-1");
pageTracker._initData();
pageTracker._trackPageview();
		  
/*!]]>*/</script>
</head>
<body>
<div class="dokuwiki export">
<!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="03.html#tutorial_03">Tutorial 03</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="03.html#tutorial_objectives">00 Tutorial objectives</a></div></li>
<li class="level2"><div class="li"><a href="03.html#gnuplot_introduction">01 Gnuplot Introduction</a></div></li>
<li class="level2"><div class="li"><a href="03.html#exercises">02 Exercises</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="03.html#exercise_01_basic_plotting">Exercise 01 – Basic Plotting</a></div></li>
<li class="level3"><div class="li"><a href="03.html#exercise_02_-_fitting">Exercise 02 - Fitting</a></div></li>
<li class="level3"><div class="li"><a href="03.html#exercise_03_gnuplot_scripts">Exercise 03 – Gnuplot Scripts</a></div></li>
<li class="level3"><div class="li"><a href="03.html#exercise_04_animations">Exercise 04 – Animations</a></div></li>
<li class="level3"><div class="li"><a href="03.html#exercise_05">Exercise 05</a></div></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="tutorial_03">Tutorial 03</h1>
<div class="level1">

</div>
<!-- EDIT1 SECTION "Tutorial 03" [1-28] -->
<h2 class="sectionedit2" id="tutorial_objectives">00 Tutorial objectives</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> Offer an introduction to Gnuplot</div>
</li>
<li class="level1"><div class="li"> Getting you familiarised with basic plots in Gnuplot</div>
</li>
</ul>

</div>
<!-- EDIT2 SECTION "00 Tutorial objectives" [29-159] -->
<h2 class="sectionedit3" id="gnuplot_introduction">01 Gnuplot Introduction</h2>
<div class="level2">

<p>
Gnuplot is a free, command-driven, interactive, function and data plotting program. It can be downloaded at <a href="https://sourceforge.net/projects/gnuplot/" class="urlextern" title="https://sourceforge.net/projects/gnuplot/"  rel="nofollow">https://sourceforge.net/projects/gnuplot/</a>. The official Gnuplot documentation can be found at <a href="http://gnuplot.sourceforge.net/documentation.html" class="urlextern" title="http://gnuplot.sourceforge.net/documentation.html"  rel="nofollow">http://gnuplot.sourceforge.net/documentation.html</a>.
</p>

<p>
It was originally created to allow scientists and students to visualize mathematical functions and data interactively, but has grown to support many non-interactive uses such as web scripting. It is also used as a plotting engine by third-party applications such as Octave.
</p>

<p>
The command language of Gnuplot is case sensitive, i.e. commands and function names written in lowercase are not the same as those written in capitals. All command names may be abbreviated as long as the abbreviation is not ambiguous. Any number of commands may appear on a line, separated by semicolons (;). Strings may be set off by either single or double quotes, although there are some subtle differences. See syntax (p. 44) and quotes (p. 44) for more details in the Gnuplot documentation (<a href="http://gnuplot.sourceforge.net/docs_5.0/gnuplot.pdf" class="urlextern" title="http://gnuplot.sourceforge.net/docs_5.0/gnuplot.pdf"  rel="nofollow">http://gnuplot.sourceforge.net/docs_5.0/gnuplot.pdf</a>).
</p>

<p>
Commands may extend over several input lines by ending each line but the last with a backslash (\). The backslash must be the last character on each line. The effect is as if the backslash and newline were not there. That is, no white space is implied, nor is a comment terminated. 
</p>

<p>
For built-in help on any topic, type <strong>help</strong> followed by the name of the topic or <strong>help ?</strong> to get a menu of available topics.
</p>

</div>
<!-- EDIT3 SECTION "01 Gnuplot Introduction" [160-1691] -->
<h2 class="sectionedit4" id="exercises">02 Exercises</h2>
<div class="level2">

</div>
<!-- EDIT4 SECTION "02 Exercises" [1692-1718] -->
<h3 class="sectionedit5" id="exercise_01_basic_plotting">Exercise 01 – Basic Plotting</h3>
<div class="level3">

<p>
Download the following sets of data: <a href="../../../../_media/ep/laboratoare/data1.txt" class="media mediafile mf_txt" title="ep:laboratoare:data1.txt (11.8 KB)">data1.txt</a> and <a href="../../../../_media/ep/laboratoare/data2.txt" class="media mediafile mf_txt" title="ep:laboratoare:data2.txt (15.6 KB)">data2.txt</a>, and update gnuplot:
</p>

<p>
<code>$ sudo apt-get install gnuplot</code>
</p>

<p>
Start gnuplot by using the command:
</p>

<p>
<code>$ gnuplot</code>
</p>

<p>
The default terminal type is dependent on your environment. One of the recommended terminal types in terms of flexibility and functionality is <em>wxt enhanced</em>. To set the terminal type use:
</p>

<p>
<code>gnuplot&gt; set terminal wxt enhanced</code>
</p>

<p>
If it is desired to display the terminal parameters at any point, use:
</p>

<p>
<code>gnuplot&gt; show terminal</code>
</p>

<p>
Plot the sets of data found in <em>data1.txt</em> and <em>data2.txt</em> on the same graph:
</p>

<p>
<code>gnuplot&gt; plot &#039;data1.txt&#039;, &#039;data2.txt</code>&#039;
</p>

<p>
In case the window plot does not appear, you might be missing gnuplot-x11. Try installing it:
</p>

<p>
<code>$ sudo apt-get install gnuplot-x11</code>
</p>

<p>
Set a title for the plot:
</p>

<p>
<code>gnuplot&gt; set title &#039;Example 1</code>&#039;
</p>

<p>
Plot the data again for the title to appear. Notice that Gnuplot automatically selects different colours for each dataset. Change the colour for both datasets to black. This can be done with the lc parameter (stands for line colour). The command below changes the colour of the data from data2.txt to black.
</p>

<p>
<code>gnuplot&gt; plot &#039;data1.txt&#039;, &#039;data2.txt&#039; lc rgb &#039;black</code>&#039;
</p>

<p>
The next step is to assign label names to the two axis:
</p>

<p>
<code>gnuplot&gt; set xlabel &#039;X Label&#039; <br/>

gnuplot&gt; set ylabel &#039;Y Label&#039; <br/>

gnuplot&gt; plot &#039;data1.txt&#039; lc rgb &#039;black&#039;, &#039;data2.txt&#039; lc rgb &#039;black</code>&#039;
</p>

<p>
The top-right corner of the plot area displays the names of the files containing the data, along with the symbol type associated with each data file. This is usually not something you would want to have on a plot. To remove it use:
</p>

<p>
<code>gnuplot&gt; unset key <br/>

gnuplot&gt; plot &#039;data1.txt&#039; lc rgb &#039;black&#039;, &#039;data2.txt&#039; lc rgb &#039;black</code>&#039;
</p>

<p>
If you want to set it back you can use the set key command:
</p>

<p>
<code>gnuplot&gt; set key</code>
</p>

<p>
The text of the keys can be changed when plotting the data like this:
</p>

<p>
<code>gnuplot&gt; plot &#039;data1.txt&#039; lc rgb &#039;black&#039; title &#039;Data 1&#039;, &#039;data2.txt&#039; lc rgb &#039;black&#039; title &#039;Data 2</code>&#039;
</p>

<p>
This is how the plot should look like so far:
</p>

<p>
<a href="../../../../_detail/ep/laboratoare/ep_l3_p1.png%3Fid=ep%253Alaboratoare%253A03.html" class="media" title="ep:laboratoare:ep_l3_p1.png"><img src="../../../../_media/ep/laboratoare/ep_l3_p1.png%3Fw=500&amp;tok=c1be3e" class="mediacenter" alt="" width="500" /></a>
</p>

<p>
It can be noticed that the data is obscuring the keys. In order to get the data off the keys, we can increase the Y axis to go all the way to 900. The X and Y ranges can be set as follows, using hard brackets and separating the low and high ranges by semicolon:
</p>

<p>
<code>gnuplot&gt; plot [:] [:900] &#039;data1.txt&#039; lc rgb &#039;black&#039; title &#039;Data 1&#039;, &#039;data2.txt&#039; lc rgb &#039;black&#039; title &#039;Data 2</code>&#039;
</p>

<p>
There is a gap showing on the right-hand side of the graph. This can be eliminated by setting the high range for the X axis to the number of rows in the data files which is 1024:
</p>

<p>
<code>gnuplot&gt; plot [:1024] [:900] &#039;data1.txt&#039; lc rgb &#039;black&#039; title &#039;Data 1&#039;, &#039;data2.txt&#039; lc rgb &#039;black&#039; title &#039;Data 2</code>&#039;
</p>

<p>
Saving the plot to an encapsulated postscript (eps is a vector graphic that can used in a Latex documents) can be done as follows:
</p>

<p>
<code>gnuplot&gt; set terminal postscript eps enhanced “Helvetica” 24 <br/>

gnuplot&gt; set output &#039;exercise1.eps&#039; <br/>

gnuplot&gt; replot</code>
</p>

<p>
Exit gnuplot, and notice that exercise1.eps was created. Open it and check how it looks.
</p>

</div>
<!-- EDIT5 SECTION "Exercise 01 – Basic Plotting" [1719-4903] -->
<h3 class="sectionedit6" id="exercise_02_-_fitting">Exercise 02 - Fitting</h3>
<div class="level3">

<p>
This exercise is aiming to familiarise you with using Gnuplot to do fitting.
Start Gnuplot, change terminal to <em>wxt enhanced</em> and plot the data from <a href="../../../../_media/ep/laboratoare/data3.txt" class="media mediafile mf_txt" title="ep:laboratoare:data3.txt (30.5 KB)">data3.txt</a>.
The aim here is to fit a straight line between 800 and 1500. Plot the data from 800 to 1500 for a better look. This will give you the section that you will be trying to fit on a straight line (use <em>w l</em> (<em>with line</em>) to connect the points).
</p>

<p>
<code>gnuplot&gt; plot [800:1500] &#039;data3.txt&#039; <br/>

gnuplot&gt; plot [800:1500] &#039;data3.txt&#039; w l</code>
</p>

<p>
You need to specify the straight line:
</p>

<p>
<code>gnuplot&gt; f(x) = a + b*x</code>
</p>

<p>
Fit the data between 800 and 1500 using the function that was just defined <em>f(x)</em>, by varying the parameters <em>a</em> and <em>b</em>:
</p>

<p>
<code>gnuplot&gt; fit [800:1500] f(x) &#039;data3.txt&#039; via a,b</code>
</p>

<p>
<a href="../../../../_detail/ep/laboratoare/ep_l3_p2.png%3Fid=ep%253Alaboratoare%253A03.html" class="media" title="ep:laboratoare:ep_l3_p2.png"><img src="../../../../_media/ep/laboratoare/ep_l3_p2.png%3Fw=500&amp;tok=93ad97" class="mediacenter" alt="" width="500" /></a>
</p>

<p>
The fit information shows the reduced chi-squared statistic which is used in the goodness of fit testing (<a href="https://en.wikipedia.org/wiki/Reduced_chi-squared_statistic" class="urlextern" title="https://en.wikipedia.org/wiki/Reduced_chi-squared_statistic"  rel="nofollow">https://en.wikipedia.org/wiki/Reduced_chi-squared_statistic</a>), along with the slope parameter (<em>b</em>) with its uncertainty and the uncertainty percentage, the offset parameter (<em>a</em>) with the uncertainty in the offset and the uncertainty percentage, and the correlation matrix of the fit parameters.
</p>

<p>
Plot the fit on top of the initial data (use <em>lw</em> (<em>line width</em>) to set the thickness of the line):
</p>

<p>
<code>Gnuplot&gt; plot [800:1500] &#039;data3.txt&#039; w l, f(x) lw 3</code>
</p>

<p>
<a href="../../../../_detail/ep/laboratoare/ep_l3_p3.png%3Fid=ep%253Alaboratoare%253A03.html" class="media" title="ep:laboratoare:ep_l3_p3.png"><img src="../../../../_media/ep/laboratoare/ep_l3_p3.png%3Fw=500&amp;tok=00a73f" class="mediacenter" alt="" width="500" /></a>
</p>

<p>
Look again at the data from <em>data3.txt</em>, and fit a polynomical line between 0 and 1300:
</p>

<p>
<code>gnuplot&gt; f(x) = a+ b*x+ c*x*x <br/>

gnuplot&gt; fit [0:1300] f(x) &#039;data3.txt&#039; via a,b,c <br/>

gnuplot&gt; plot [0:1300] &#039;data3.txt&#039; w l, f(x) lw 3</code>
</p>

<p>
<a href="../../../../_detail/ep/laboratoare/ep_l3_p4.png%3Fid=ep%253Alaboratoare%253A03.html" class="media" title="ep:laboratoare:ep_l3_p4.png"><img src="../../../../_media/ep/laboratoare/ep_l3_p4.png%3Fw=500&amp;tok=94b880" class="mediacenter" alt="" width="500" /></a>
</p>

</div>
<!-- EDIT6 SECTION "Exercise 02 - Fitting" [4904-6629] -->
<h3 class="sectionedit7" id="exercise_03_gnuplot_scripts">Exercise 03 – Gnuplot Scripts</h3>
<div class="level3">

<p>
The benefit of using a script is that you do not have to retype everything every time you want to make a change or want to reproduce your plot. The following is an example of a Gnuplot script that plots two graphs on a single plot.
</p>

<p>
<code>reset # flush all the variables <br/>
<br/>


set size 1,1 # use default pallet size (100% of width and height) <br/>

set multiplot <br/>
<br/>


#Graph 1 <br/>

set size 0.5,1 #half the width and full height <br/>

set origin 0,0 #x,y <br/>

plot &#039;data2.txt&#039; w l lw 0.5 <br/>
<br/>


#Graph 2 <br/>

set size 0.5,1 <br/>

set origin 0.5,0 <br/>

plot &#039;data3.txt&#039; w l lw 0.5 <br/>
<br/>


unset multiplot</code>
</p>

<p>
Run the script:
</p>

<p>
<code>$ gnuplot <br/>

gnuplot&gt; load &#039;script_name</code>&#039;
</p>

</div>
<!-- EDIT7 SECTION "Exercise 03 – Gnuplot Scripts" [6630-7335] -->
<h3 class="sectionedit8" id="exercise_04_animations">Exercise 04 – Animations</h3>
<div class="level3">

<p>
For very basic animations in Gnuplot you would need to set up a loop, decide what commands to give to Gnuplot and use the pipe utility to pipe that command into Gnuplot.
</p>

<p>
Example 1:
</p>
<pre class="code">$ for ((i=-70; i&lt;70; i++)); do echo -e &quot;set sample 50000; set yrange [-40:40]; plot $i*sin(x)*cos(x) \n&quot;; done | gnuplot</pre>

<p>
Example 2:
</p>
<pre class="code">$ for ((i=-100; i&lt;100; i++)); do echo -e &quot;set isosample 100; spl [:] [:] [-100:100] $i*(sin(sqrt(x**2+y**2))/sqrt(x**2+y**2)) \n&quot;; done | gnuplot -persist</pre>

</div>
<!-- EDIT8 SECTION "Exercise 04 – Animations" [7336-7874] -->
<h3 class="sectionedit9" id="exercise_05">Exercise 05</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> Using the Gnuplot documentation, implement a script that plots four graphs. Use the data from <a href="../../../../_media/ep/laboratoare/data4.txt" class="media mediafile mf_txt" title="ep:laboratoare:data4.txt (238.3 KB)">data4.txt</a> as follows: the first graph should plot columns 1 and 2, the second columns 1 and 3, the third one columns 1 and 4, and the fourth one should be a 3D graph plotting columns 1, 2 and 3.</div>
</li>
<li class="level1"><div class="li"> Use different colours for the data in each graph.</div>
</li>
<li class="level1"><div class="li"> Remove the keys for each graph.</div>
</li>
<li class="level1"><div class="li"> Give a title to each graph.</div>
</li>
<li class="level1"><div class="li"> Give names to each of the axes: X or Y (or Z for the 3D graph). In the case of the 3D graph: Make the numbers on the axes readable, and correct the position of the names of the axes if these are displayed over the axes numbers.</div>
</li>
<li class="level1"><div class="li"> Make the script generate the .eps file containing your plot.</div>
</li>
</ul>

<p>
Hint
Consider the following commands: set key, xlabel, set title, set xtics, set terminal, set output, using.
</p>

</div>
<!-- EDIT9 SECTION "Exercise 05" [7875-] --></div>
</body>
</html>
