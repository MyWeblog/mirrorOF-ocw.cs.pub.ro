    
    

<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <title>eim:laboratoare:laborator02</title>
<meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="date" content="2016-03-04T09:45:17+0200"/>
<meta name="keywords" content="eim,laboratoare,laborator02"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../../../lib/exe/opensearch.php" title="CS Open CourseWare"/>
<link rel="start" href="../../../../../courses.1.html"/>
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="../../../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="../../../../feed.php%3Fmode=list&amp;ns=eim:laboratoare"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="laborator02.html"/>
<link rel="canonical" href="../../../../eim/laboratoare/laborator02.html"/>
<link rel="stylesheet" type="text/css" href="../../../../lib/exe/css.php%3Ft=arctic&amp;tseed=1479898000.css"/>
<script type="text/javascript">/*<![CDATA[*/var NS='eim:laboratoare';var JSINFO = {"id":"eim:laboratoare:laborator02","namespace":"eim:laboratoare","isadmin":0,"isauth":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../../../lib/exe/js.php%3Ftseed=1479898000"></script>
<script type="text/x-mathjax-config">/*<![CDATA[*/MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ["$","$"], ["\\(","\\)"] ],
        displayMath: [ ["$$","$$"], ["\\[","\\]"] ],
        processEscapes: true
    }
});
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<script type="text/javascript">/*<![CDATA[*/
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
		  
/*!]]>*/</script>
<script type="text/javascript">/*<![CDATA[*/
var pageTracker = _gat._getTracker("UA-38383934-1");
pageTracker._initData();
pageTracker._trackPageview();
		  
/*!]]>*/</script>
</head>
<body>
<div class="dokuwiki export">
<!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="laborator02.html#laborator_02_structura_unei_aplicatii_i">Laborator 02. Structura unei Aplicații (I)</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="laborator02.html#contextul">Contextul</a></div></li>
<li class="level2"><div class="li"><a href="laborator02.html#activitatea">Activitatea</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="laborator02.html#componentele_unei_activitati">Componentele unei Activități</a></div></li>
<li class="level3"><div class="li"><a href="laborator02.html#ciclul_de_viata_al_unei_activitati">Ciclul de Viață al unei Activități</a></div></li>
<li class="level3"><div class="li"><a href="laborator02.html#gestiunea_starii_unei_activitati">Gestiunea Stării unei Activități</a></div>
<ul class="toc">
<li class="level4"><div class="li"><a href="laborator02.html#salvarea_starii">Salvarea Stării</a></div></li>
<li class="level4"><div class="li"><a href="laborator02.html#restaurarea_starii">Restaurarea Stării</a></div></li>
</ul>
</li>
<li class="level3"><div class="li"><a href="laborator02.html#coordonarea_activitatilor">Coordonarea Activităților</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="laborator02.html#structura_unui_proiect_android_in_eclipse_luna_sr1a_441">Structura unui Proiect Android în Eclipse Luna SR1a (4.4.1)</a></div></li>
<li class="level2"><div class="li"><a href="laborator02.html#rularea_si_depanarea_unei_aplicatii_android">Rularea și Depanarea unei aplicații Android</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="laborator02.html#rularea_unei_aplicatii_android">Rularea unei aplicații Android</a></div></li>
<li class="level3"><div class="li"><a href="laborator02.html#depanarea_unei_aplicatii_android">Depanarea unei aplicații Android</a></div>
<ul class="toc">
<li class="level4"><div class="li"><a href="laborator02.html#android_debug_bridge_adb">Android Debug Bridge (ADB)</a></div></li>
<li class="level4"><div class="li"><a href="laborator02.html#logcat">LogCat</a></div></li>
<li class="level4"><div class="li"><a href="laborator02.html#ddms">DDMS</a></div></li>
<li class="level4"><div class="li"><a href="laborator02.html#hierarchy_view">Hierarchy View</a></div></li>
</ul>
</li>
</ul>
</li>
<li class="level2"><div class="li"><a href="laborator02.html#activitate_de_laborator">Activitate de Laborator</a></div></li>
<li class="level2"><div class="li"><a href="laborator02.html#resurse_utile">Resurse Utile</a></div></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="laborator_02_structura_unei_aplicatii_i">Laborator 02. Structura unei Aplicații (I)</h1>
<div class="level1">

<p>
O aplicație Android poate conține mai multe componente:
</p>
<ol>
<li class="level1"><div class="li"> <a href="http://developer.android.com/reference/android/content/Context.html" class="urlextern" title="http://developer.android.com/reference/android/content/Context.html"  rel="nofollow">contextul</a> reprezintă punctul central al unei aplicații Android, oferind acces către mai multe funcționalități ale acesteia (inclusiv la resursele dizpozitivului mobil, serviciile sistemului de operare, diferite fișiere de configurare); este instanțiat sub forma unui obiect de tip <code>android.app.Application</code>;</div>
</li>
<li class="level1"><div class="li"> <a href="http://developer.android.com/reference/android/app/Activity.html" class="urlextern" title="http://developer.android.com/reference/android/app/Activity.html"  rel="nofollow">activitatea</a> realizează sarcini a căror execuție nu influențează timpul de răspuns al aplicației Android, astfel încât să nu aibă un impact asupra experienței utilizatorului; de aceea, este asociată unei ferestre (interfețe grafice), o aplicație Android fiind formată din una sau mai multe activități;</div>
</li>
<li class="level1"><div class="li"> <a href="http://developer.android.com/reference/android/app/Fragment.html" class="urlextern" title="http://developer.android.com/reference/android/app/Fragment.html"  rel="nofollow">fragmentul</a> conține interfața grafică și logica aplicației corespunzătoare unei părți din cadrul unei activități; motivul pentru care se recurge la modularizarea unei activități prin intermediul a mai multor fragmente este asigurarea consistenței și flexibilității aplicației Android pe mai multe echipamente mobile, cu dispozitive de afișare de dimensiuni și rezoluții diferite;</div>
</li>
<li class="level1"><div class="li"> <a href="http://developer.android.com/reference/android/app/Service.html" class="urlextern" title="http://developer.android.com/reference/android/app/Service.html"  rel="nofollow">serviciul</a> încapsulează procese mai complexe, executate în fundal (și posibil la intervale de timp regulate) a căror rulare durează o perioadă de timp semnificativă, astfel încât să nu poată fi plasate în cadrul aceluiași fir de execuție ca și interfața grafică prin care se asigură interacțiunea cu utilizatorul;</div>
</li>
<li class="level1"><div class="li"> <a href="http://developer.android.com/reference/android/content/Intent.html" class="urlextern" title="http://developer.android.com/reference/android/content/Intent.html"  rel="nofollow">intenția</a> este mecanismul de comunicare între elementele unei aplicații Android (activități și servicii); prin intermediul unui sistem de mesagerie (asincronă), sistemul de operare Android mapează o solicitare (împachetată sub forma unei intenții) către componenta adecvată.</div>
</li>
</ol>

<p>
<img src="../../../../_media/eim/laboratoare/laborator02/structura_unei_aplicatii_android.png%3Fw=500&amp;tok=795513" class="mediacenter" alt="" width="500" />
</p>

</div>
<!-- EDIT1 SECTION "Laborator 02. Structura unei Aplicații (I)" [1-2227] -->
<h2 class="sectionedit2" id="contextul">Contextul</h2>
<div class="level2">

<p>
Contexul este utilizat pentru a implementa diferite funcționalități la nivelul întregii aplicații:
</p>
<ul>
<li class="level1"><div class="li"> obținerea de referințe la resursele aplicației (șiruri de caractere, elemente grafice, fișiere XML);</div>
</li>
<li class="level1"><div class="li"> accesarea preferințelor aplicației;</div>
</li>
<li class="level1"><div class="li"> gestiunea sistemului de fișiere corespunzător aplicației;</div>
</li>
<li class="level1"><div class="li"> lucrul cu resurse necompilate ale aplicației;</div>
</li>
<li class="level1"><div class="li"> utilizarea serviciilor de sistem;</div>
</li>
<li class="level1"><div class="li"> folosirea unei baza de date SQLite;</div>
</li>
<li class="level1"><div class="li"> administrarea permisiunilor aplicației.</div>
</li>
</ul>

<p>
În clasele de tip <code>Activity</code> sau <code>Service</code>, contextul aplicației poate fi obținut printr-un apel de forma:
</p>
<pre class="code java"><a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+context"><span class="kw3">Context</span></a> context <span class="sy0">=</span> getApplicationContext<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span> <span class="co1">// definita in clasa Context</span></pre>
<pre class="code java"><a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+context"><span class="kw3">Context</span></a> context <span class="sy0">=</span> getApplication<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>        <span class="co1">// definita in clasa Activity</span></pre>

<p>
<p><div class="notetip">Pentru a se evita utilizarea ineficientă a memoriei (<em>eng.</em> memory leak), în situația în care obiectele trebuie să existe pe toată durata aplicației, se recomandă ca acestea să refere contextul aplicației (nu al activității), astfel încât să nu fie condiționate de diverse evenimente din ciclul de viață al acestora.
</div></p>
</p>

</div>
<!-- EDIT2 SECTION "Contextul" [2228-3403] -->
<h2 class="sectionedit3" id="activitatea">Activitatea</h2>
<div class="level2">

<p>
Activitatea reprezintă o componenta a aplicației Android ce oferă o interfață grafică cu care utilizatorul poate să interacționeze. Cele mai multe activități ocupă întreaga suprafață de afișare, însă acest lucru nu este obligatoriu.
</p>

<p>
O aplicație Android este formată din una sau mai multe activități (slab cuplate între ele). Există întotdeauna o activitate principală care este afișată atunci când aplicația Android este lansată în execuție inițial.
</p>

<p>
O activitate poate invoca o altă activitate pentru a realiza diferite sarcini, prin intermediul unei intenții. În acest moment, activitatea veche este oprită și salvată pe stivă (<em>eng.</em> back stack), după care este pornită activitatea nouă. Restaurarea și (re)începerea activității vechi este realizată în momentul în care activitatea nouă (curentă) este terminată. Un comportament similar are loc în momentul în care se produce un eveniment (primirea unui apel telefonic, apăsarea tastelor <em>Home</em> sau <em>Back</em>, lansarea altei aplicații).
</p>

<p>
<p><div class="noteimportant">O activitate trebuie să își gestioneze corespunzător comportamentul (inclusiv folosirea memoriei) în cazul producerii diferitelor evenimente, salvând și restaurând starea de fiecare dată când aplicația este oprită, respectiv (re)pornită.
</div></p>
</p>

</div>
<!-- EDIT3 SECTION "Activitatea" [3404-4755] -->
<h3 class="sectionedit4" id="componentele_unei_activitati">Componentele unei Activități</h3>
<div class="level3">

<p>
O activitate poate fi utilizată numai dacă este definită în fișierul <code>AndroidManifest.xml</code>, în cadrul elementului de tip <code>&lt;application&gt;</code>. Pentru fiecare activitate trebuie creată o intrare de tip <a href="http://developer.android.com/guide/topics/manifest/activity-element.html" class="urlextern" title="http://developer.android.com/guide/topics/manifest/activity-element.html"  rel="nofollow">&lt;activity&gt;</a> pentru care se specifică diferite atribute, dintre care obligatoriu este numai denumirea activității (<code>android:name</code>). Din momentul în care aplicația Android este publicată, conținutul manifestului devine un contract față de utilizatori, iar denumirile componentelor nu mai pot fi modificate întrucât pot genera erori în cazul producerii unor actualizări.
</p>

<p>
Pentru o activitate se poate specifica și un filtru de intenții, în cadrul elementului <a href="http://developer.android.com/guide/topics/manifest/intent-filter-element.html" class="urlextern" title="http://developer.android.com/guide/topics/manifest/intent-filter-element.html"  rel="nofollow">&lt;intent-filter&gt;</a>, spre a indica modul în care componentele aplicației o pot accesa. Acesta este necesar pentru ca activitatea să poată fi rulată folosind intenții implicite (furnizate de alte aplicații). Așadar, o astfel de intrare va fi necesară pentru fiecare tip de intenție, precizând elementele <code>&lt;action&gt;</code> și opțional <code>&lt;category&gt;</code> / <code>&lt;data&gt;</code>. În cazul activităților care nu vor fi accesibile din cadrul altor aplicații Android, nu este necesară definirea unui filtru de intenții.
</p>

<p>
<p><div class="notetip">O activitate principală din cadrul unei aplicații Android este caracterizată prin următoarele proprietăți:
</p>
<ul>
<li class="level1"><div class="li"> acțiunea are valoarea <code>android.intent.action.MAIN</code>, întrucât reprezintă punctul de intrare al aplicației Android;</div>
</li>
<li class="level1"><div class="li"> categoria are valoarea <code>android.intent.category.LAUNCHER</code>, întrucât activitatea trebuie inclusă în meniul dispozitivului mobil pentru a putea fi lansată în execuție.</div>
</li>
</ul>

<p>

</div></p>
</p>
<dl class="file">
<dt><a href="../../../code/eim/laboratoare/laborator02%3Fcodeblock=2" title="Download Snippet" class="mediafile mf_xml">AndroidManifest.xml</a></dt>
<dd><pre class="code file xml"><span class="sc3"><span class="re1">&lt;?xml</span> <span class="re0">version</span>=<span class="st0">&quot;1.0&quot;</span> <span class="re0">encoding</span>=<span class="st0">&quot;utf-8&quot;</span><span class="re2">?&gt;</span></span>
<span class="sc3"><span class="re1">&lt;manifest</span> ... <span class="re2">&gt;</span></span>
  <span class="sc-1">&lt;!-- ... --&gt;</span>
  <span class="sc3"><span class="re1">&lt;application</span> ... <span class="re2">&gt;</span></span>
    <span class="sc3"><span class="re1">&lt;activity</span></span>
<span class="sc3">      <span class="re0">android:name</span>=<span class="st0">&quot;.LifecycleMonitorActivity&quot;</span></span>
<span class="sc3">      <span class="re0">android:label</span>=<span class="st0">&quot;@string/app_name&quot;</span> <span class="re2">&gt;</span></span>
      <span class="sc3"><span class="re1">&lt;intent-filter<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;action</span> <span class="re0">android:name</span>=<span class="st0">&quot;android.intent.action.MAIN&quot;</span> <span class="re2">/&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;category</span> <span class="re0">android:name</span>=<span class="st0">&quot;android.intent.category.LAUNCHER&quot;</span> <span class="re2">/&gt;</span></span>
      <span class="sc3"><span class="re1">&lt;/intent-filter<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;/activity<span class="re2">&gt;</span></span></span>
  <span class="sc3"><span class="re1">&lt;/application<span class="re2">&gt;</span></span></span>
<span class="sc3"><span class="re1">&lt;/manifest<span class="re2">&gt;</span></span></span></pre>
</dd></dl>

<p>
Ulterior, se va implementa și clasa identificată prin denumirea activității. Aceasta trebuie să fie derivată din <code>android.app.Activity</code> și să implementeze cel puțin metoda <code>onCreate()</code> în care sunt inițializate componentele sale.
</p>
<dl class="file">
<dt><a href="../../../code/eim/laboratoare/laborator02%3Fcodeblock=3" title="Download Snippet" class="mediafile mf_java">LifecycleMonitorActivity.java</a></dt>
<dd><pre class="code file java"><span class="kw1">public</span> <span class="kw1">class</span> LifecycleMonitorActivity <span class="kw1">extends</span> Activity <span class="br0">&#123;</span>
&nbsp;
  @Override
  <span class="kw1">protected</span> <span class="kw4">void</span> onCreate<span class="br0">&#40;</span>Bundle savedInstanceState<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">super</span>.<span class="me1">onCreate</span><span class="br0">&#40;</span>savedInstanceState<span class="br0">&#41;</span><span class="sy0">;</span>
    setContentView<span class="br0">&#40;</span>R.<span class="me1">layout</span>.<span class="me1">activity_lifecycle_monitor</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="co1">// ...</span>
  <span class="br0">&#125;</span>
&nbsp;
  <span class="co1">// ...</span>
&nbsp;
<span class="br0">&#125;</span></pre>
</dd></dl>

<p>
Este obligatoriu ca metoda <code>onCreate()</code> să apeleze metoda părinte, în caz contrar generându-se o excepție. 
</p>

<p>
Pentru fiecare activitate, este necesar să se descrie interfața grafică în cadrul unui fișier .xml (încărcat manual, în cadrul metodei <code>onCreate()</code>, printr-un apel al metodei <code>setContentView()</code>) în care elementul părinte este un mecanism de dispunere a conținutului (derivat din clasa <code>android.view.ViewGroup</code>). Acest fișier este plasat în directorul <code>res/layout</code> și conține referințe către toate obiectele care vor fi afișate în cadrul ferestrei. În urma compilării, vor fi generate niște referințe (adrese în cadrul pachetului de resurse) prin intermediul cărora resursele vor putea fi accesate.
</p>
<dl class="file">
<dt><a href="../../../code/eim/laboratoare/laborator02%3Fcodeblock=4" title="Download Snippet" class="mediafile mf_xml">activity_lifecycle_monitor.xml</a></dt>
<dd><pre class="code file xml"><span class="sc3"><span class="re1">&lt;LinearLayout</span> <span class="re0">xmlns:android</span>=<span class="st0">&quot;http://schemas.android.com/apk/res/android&quot;</span></span>
<span class="sc3">    <span class="re0">xmlns:tools</span>=<span class="st0">&quot;http://schemas.android.com/tools&quot;</span></span>
<span class="sc3">    <span class="re0">android:layout_width</span>=<span class="st0">&quot;match_parent&quot;</span></span>
<span class="sc3">    <span class="re0">android:layout_height</span>=<span class="st0">&quot;wrap_content&quot;</span></span>
<span class="sc3">    <span class="re0">android:paddingBottom</span>=<span class="st0">&quot;@dimen/activity_vertical_margin&quot;</span></span>
<span class="sc3">    <span class="re0">android:paddingLeft</span>=<span class="st0">&quot;@dimen/activity_horizontal_margin&quot;</span></span>
<span class="sc3">    <span class="re0">android:paddingRight</span>=<span class="st0">&quot;@dimen/activity_horizontal_margin&quot;</span></span>
<span class="sc3">    <span class="re0">android:paddingTop</span>=<span class="st0">&quot;@dimen/activity_vertical_margin&quot;</span></span>
<span class="sc3">    <span class="re0">android:orientation</span>=<span class="st0">&quot;vertical&quot;</span></span>
<span class="sc3">    <span class="re0">tools:context</span>=<span class="st0">&quot;ro.pub.cs.systems.pdsd.lab02.graphicuserinterface.LifecycleMonitorActivity&quot;</span> <span class="re2">&gt;</span></span>
&nbsp;
    <span class="sc-1">&lt;!-- ... --&gt;</span>
&nbsp;
<span class="sc3"><span class="re1">&lt;/LinearLayout<span class="re2">&gt;</span></span></span></pre>
</dd></dl>

<p>
Prin urmare, componentele definitorii ale unei activități sunt clasa în care este implementat comportamentul în urma interacțiunii cu utilizatorul și fișierul .xml care descrie modelul static al interfeței grafice.
</p>

<p>
<img src="../../../../_media/eim/laboratoare/laborator02/activity_relationships.png%3Fw=700&amp;tok=09fa8a" class="mediacenter" alt="" width="700" />
</p>

<p>
O activitate poate fi pornită în mod explicit prin intermediul metodei <code>startActivity()</code> care primește ca parametru un obiect de tip intenție (căruia i se pot atașa și niște date, transferate activității). În cazul în care se așteaptă ca activitatea să producă unele rezultate, se va apela metoda <code>startActivityForResult()</code> - furnizându-se și un cod de cerere -, fiind necesar ca activitatea astfel invocată să implementeze metoda <code>onActivityResult()</code>.
</p>

<p>
O activitate poate fi oprită în mod explicit prin intermediul metodei <code>finish()</code>. De regulă, folosirea unei astfel de metode este descurajată, datorită impactului pe care îl poate avea asupra experienței utilizatorului. 
</p>

</div>
<!-- EDIT4 SECTION "Componentele unei Activități" [4756-10016] -->
<h3 class="sectionedit5" id="ciclul_de_viata_al_unei_activitati">Ciclul de Viață al unei Activități</h3>
<div class="level3">

<p>
Din momentul în care activitatea este creată și până la momentul în care este distrusă, ea trece printr-o serie de etape, cunoscute sub denumirea de <strong>ciclul de viață al activității</strong>:
</p>
<ul>
<li class="level1"><div class="li"> <strong>în execuție</strong> (<em>eng.</em> running) - activitatea se află în prim plan și este vizibilă, astfel încât utilizatorul poate interacționa cu aceasta prin intermediul interfeței grafice pe care o oferă;</div>
</li>
<li class="level1"><div class="li"> <strong>întreruptă temporar</strong> (<em>eng.</em> paused) - activitatea se află în fundal și este (parțial) vizibilă; o astfel de situație este întâlnită în momentul în care o altă activitate a fost pornită, însă interfața sa grafică este transparentă sau nu ocupă întreaga suprafață a dispozitivului de afișare; în acest caz, activitatea este încă activă în sensul că obiectul de tip <code>Activity</code> este stocat în memorie, fiind atașată în continuare procesului responsabil cu gestiunea ferestrelor și menținându-se starea tuturor componentelor sale; totuși, ea poate fi distrusă de sistemul de operare dacă necesarul de memorie disponibilă nu poate fi întrunit din cauza sa;</div>
</li>
<li class="level1"><div class="li"> <strong>oprită</strong> (<em>eng.</em> stopped) - activitatea se află în fundal și este complet ascunsă; o astfel de situație este întâlnită în momentul în care o altă activitate a fost pornită, iar interfața sa grafică ocupă întreaga suprafață a dispozitivului de afișare; și în acest caz, activitatea este activă în sensul că obiectul de tip <code>Activity</code> fiind stocat în memorie, menținându-se starea tuturor componentelor sale, dar detașându-se de procesul responsabil cu gestiunea ferestrelor; ea poate fi distrusă de sistemul de operare dacă necesarul de memorie disponibilă nu poate fi întrunit din cauza sa;</div>
</li>
<li class="level1"><div class="li"> <strong>inexistentă</strong> - activitatea a fost terminată sau distrusă de sistemul de operare, rularea sa impunând crearea tuturor componentelor sale ca și când ar fi accesată inițial.</div>
</li>
</ul>

<p>
<img src="../../../../_media/eim/laboratoare/laborator02/ciclul_de_viata_al_unei_activitati_1.png%3Fw=300&amp;tok=5c2a64" class="mediacenter" alt="" width="300" />
</p>

<p>
Tranziția unei activități dintr-o stare în alta este notificată prin intermediul unor metode (<em>eng.</em> callbacks), care pot fi suprascrise pentru a realiza diferite operații necesare pentru gestiunea memoriei, asigurarea persistenței informațiilor și a consistenței aplicației Android în situația producerii de diferite evenimente:
</p>
<ul>
<li class="level1"><div class="li"> <code>onCreate(Bundle)</code> - apelată în momentul în care activitatea este creată; această metodă va fi folosită pentru inițializări statice:</div>
<ul>
<li class="level2"><div class="li"> încărcarea interfeței grafice printr-un apel al metodei <code>setContentView(int)</code> (al cărei parametru reprezintă referința către resursa de tip <code>.xml</code> care descrie interfața grafică);</div>
</li>
<li class="level2"><div class="li"> obținerea de referințe către componentele interfeței grafice printr-un apel al metodei <code>findViewById(int)</code> (al cărei parametru reprezintă referința către componenta respectivă - <em>eng.</em> widget - așa cum apare în resurse);</div>
</li>
<li class="level2"><div class="li"> indicarea unor obiecte de tip ascultător care să gestioneze evenimentele legate de interacțiunea cu utilizatorul;</div>
</li>
<li class="level2"><div class="li"> realizarea unor conexiuni către alte modele de date.</div>
</li>
</ul>
</li>
</ul>

<p>
<p><div class="noteimportant">Crearea activității este diferită de apariția acesteia pe ecran.
</div></p>
</p>

<p>
<p><div class="noteclassic">Metoda <code>onCreate()</code> este întotdeauna urmată de metoda <code>onStart()</code>.
</div></p>
</p>
<ul>
<li class="level1"><div class="li"> <code>onRestart()</code> - apelată atunci când activitatea a fost oprită și ulterior repornită; este urmată întotdeauna de metoda <code>onStart()</code>;</div>
</li>
<li class="level1"><div class="li"> <code>onStart()</code> - apelată înainte ca activitatea să apară pe ecran; poate fi urmată de metoda <code>onResume()</code> dacă activitatea trece în prim-plan sau de metoda <code>onPause()</code> dacă activitatea trece în fundal;</div>
</li>
<li class="level1"><div class="li"> <code>onResume()</code> - apelată înainte ca activitatea să interacționeze cu utilizatorul; această metodă va fi folosită pentru a porni servicii sau cod care trebuie să ruleze atâta timp cât aplicația este afișată pe ecran; este urmată întotdeauna de metoda <code>onPause()</code>;</div>
</li>
<li class="level1"><div class="li"> <code>onPause()</code> - apelată înainte ca activitatea să fie întreruptă temporar, iar o altă activitate să fie reluată; această metodă va fi utilizată pentru a opri servicii sau cod care nu trebuie să ruleze atâta timp cât activitatea se află în fundal (întrucât consumă timp de procesor) și pentru a salva starea diferitelor componente în vederea asigurării persistenței și a consistenței aplicației înainte și după evenimentul care a produs suspendarea sa; poate fi urmată de metoda <code>onResume()</code> dacă activitatea trece în prim-plan sau de metoda <code>onStop()</code> dacă activitatea este ascunsă;</div>
</li>
</ul>

<p>
<p><div class="notetip">Procesările realizate în metoda <code>onPause()</code> nu trebuie să ocupe un interval de timp prea mare întrucât în caz contrar ar bloca noua activitate care urmează să fie lansată în execuție.
</div></p>
</p>

<p>
<p><div class="notetip">Procesul în contextul căruia rulează o activitate nu poate fi distrus de sistemul de operare până ce nu s-a terminat apelul metodei <code>onPause()</code>, aceasta fiind singura metodă care este apelată în mod garantat <strong>înainte</strong> de a se solicita memoria pe care activitatea o folosește.
</div></p>
</p>
<ul>
<li class="level1"><div class="li"> <code>onStop()</code> - apelată în momentul în care activitatea este ascunsă, fie din cauză că urmează să fie distrusă, fie din cauză că o altă activitate, a cărei interfață grafică ocupă întreaga suprafață a dispozitivului de afișare, urmează să devină vizibilă; poate fi urmată de metoda <code>onRestart()</code>, dacă activitatea urmează să interacționeze (din nou) cu utilizatorul, sau de metoda <code>onDestroy()</code> dacă activitatea urmează să fie terminată sau distrusă de sistemul de operare;</div>
</li>
<li class="level1"><div class="li"> <code>onDestroy()</code> - apelată înainte ca activitatea să se termine sau să fie distrusă de către sistemul de operare (fie manual, fie automat) din lipsă de memorie; această metodă va fi utilizată pentru a elibera resursele ocupate.</div>
</li>
</ul>

<p>
<p><div class="notetip">Distincția între cele două situații în care o activitate este distrusă poate fi realizată prin intermediul metodei <code>isFinishing()</code>.
</div></p>
</p>

<p>
<img src="../../../../_media/eim/laboratoare/laborator02/ciclul_de_viata_al_unei_activitati_2.png%3Fw=700&amp;tok=1e9fbc" class="mediacenter" alt="" width="700" />
</p>

<p>
<p><div class="noteimportant">Fiecare dintre metodele ce gestionează ciclul de viață al activității trebuie să apeleze metoda părintelui. În cazul metodei <code>onCreate()</code>, este necesar ca acest lucru să fie realizat la începutul metodei.
</div></p>
</p>

<p>
<p><div class="notewarning">În cadrul unei activități, este interzisă apelarea manuală a metodelor legate de ciclul de viață, acestea fiind invocate în mod automat de sistemul de operare Android la producerea diferitelor evenimente.
</div></p>
</p>
<dl class="file">
<dt><a href="../../../code/eim/laboratoare/laborator02%3Fcodeblock=5" title="Download Snippet" class="mediafile mf_java">LifecycleMonitorActivity.java</a></dt>
<dd><pre class="code file java"><span class="kw1">public</span> <span class="kw1">class</span> LifecycleMonitorActivity <span class="kw1">extends</span> Activity <span class="br0">&#123;</span>
&nbsp;
  @Override
  <span class="kw1">protected</span> <span class="kw4">void</span> onCreate<span class="br0">&#40;</span>Bundle savedInstanceState<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">super</span>.<span class="me1">onCreate</span><span class="br0">&#40;</span>savedInstanceState<span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="co1">// ...</span>
  <span class="br0">&#125;</span>
&nbsp;
  @Override
  <span class="kw1">protected</span> <span class="kw4">void</span> onStart<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">super</span>.<span class="me1">onStart</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="co1">// ...</span>
  <span class="br0">&#125;</span>
&nbsp;
  @Override
  <span class="kw1">protected</span> <span class="kw4">void</span> onResume<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">super</span>.<span class="me1">onResume</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="co1">// ...</span>
  <span class="br0">&#125;</span>
&nbsp;
  @Override
  <span class="kw1">protected</span> <span class="kw4">void</span> onPause<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">super</span>.<span class="me1">onPause</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="co1">// ...</span>
  <span class="br0">&#125;</span>
&nbsp;
  @Override
  <span class="kw1">protected</span> <span class="kw4">void</span> onStop<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">super</span>.<span class="me1">onStop</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="co1">// ...</span>
  <span class="br0">&#125;</span>
&nbsp;
  @Override
  <span class="kw1">protected</span> <span class="kw4">void</span> onDestroy<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">super</span>.<span class="me1">onDestroy</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="co1">// ...</span>
  <span class="br0">&#125;</span>
&nbsp;
  @Override
  <span class="kw1">protected</span> <span class="kw4">void</span> onRestart<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">super</span>.<span class="me1">onRestart</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="co1">// ...</span>
  <span class="br0">&#125;</span>
&nbsp;
  <span class="co1">// metode folosite pentru salvarea si restaurarea starii    </span>
&nbsp;
  @Override
  <span class="kw1">protected</span> <span class="kw4">void</span> onSaveInstanceState<span class="br0">&#40;</span>Bundle savedInstanceState<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="co1">// apelarea metodei din activitatea parinte este recomandata, dar nu obligatorie</span>
    <span class="kw1">super</span>.<span class="me1">onSaveInstanceState</span><span class="br0">&#40;</span>savedInstanceState<span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="co1">// ...</span>
  <span class="br0">&#125;</span>
&nbsp;
  @Override
  <span class="kw1">protected</span> <span class="kw4">void</span> onRestoreInstanceState<span class="br0">&#40;</span>Bundle savedInstanceState<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="co1">// apelarea metodei din activitatea parinte este recomandata, dar nu obligatorie</span>
    <span class="kw1">super</span>.<span class="me1">onRestoreInstanceState</span><span class="br0">&#40;</span>savedInstanceState<span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="co1">// ...</span>
  <span class="br0">&#125;</span>
&nbsp;
<span class="br0">&#125;</span></pre>
</dd></dl>

</div>
<!-- EDIT5 SECTION "Ciclul de Viață al unei Activități" [10017-17929] -->
<h3 class="sectionedit6" id="gestiunea_starii_unei_activitati">Gestiunea Stării unei Activități</h3>
<div class="level3">

<p>
Unele dintre metodele care gestionează ciclul de viață al unei activități primesc ca parametru un obiect de tip <a href="http://developer.android.com/reference/android/os/Bundle.html" class="urlextern" title="http://developer.android.com/reference/android/os/Bundle.html"  rel="nofollow">Bundle</a>, utilizat pentru gestiunea stării în cazul în care activitatea este distrusă din lipsă de memorie:
</p>
<ul>
<li class="level1"><div class="li"> <code>onCreate()</code> - parametrul <code>savedInstance</code> poate să fie <code>null</code>, daca activitatea nu a mai fost rulată anterior, fie este o instanță a unui obiect de tip <code>Bundle</code> în care se găsește starea anterioară (așa cum a fost reținută de metoda <code>onSaveInstanceState()</code>);</div>
</li>
<li class="level1"><div class="li"> <code>onSaveInstanceState()</code> - este apelată când activitatea urmează să fie ascunsă și există posibilitatea ca procesul acesteia să fie terminat din lipsă de memorie, pentru a salva starea activității;</div>
</li>
<li class="level1"><div class="li"> <code>onRestoreInstanceState()</code> - este apelată doar dacă există o stare a activității care ar trebui să fie restaurată.</div>
</li>
</ul>

<p>
<img src="../../../../_media/eim/laboratoare/laborator02/gestiune_stare_activitati.png%3Fw=700&amp;tok=1ea70f" class="mediacenter" alt="" width="700" />
</p>

<p>
Obiectul de tip <code>Bundle</code> este o formă de hash map, în care cheia este întotdeauna de tip <code>String</code>, iar valorile au tipul <code>android.os.Parcelable</code> (asemănător cu <code>Serializable</code> din Java, deși acesta nu este un mecanism de serializare în sine). Astfel, tipurile de date care pot fi salvate și încărcate prin intermediul unui obiect de tip <code>Bundle</code> sunt:
</p>

<center>
<div class="table sectionedit7"><table class="inline">
	<tr class="row0">
		<td class="col0 leftalign"> <code>boolean</code>      </td><td class="col1 leftalign"> <code>boolean[]</code>      </td><td class="col2 leftalign">                             </td>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign" colspan="3"> <code>Bundle</code>                                                        </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> <code>byte</code>         </td><td class="col1 leftalign"> <code>byte[]</code>         </td><td class="col2 leftalign">                             </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> <code>char</code>         </td><td class="col1 leftalign"> <code>char[]</code>         </td><td class="col2 leftalign">                             </td>
	</tr>
	<tr class="row4">
		<td class="col0"> <code>CharSequence</code> </td><td class="col1"> <code>CharSequence[]</code> </td><td class="col2"> <code>ArrayList&lt;CharSequence&gt;</code> </td>
	</tr>
	<tr class="row5">
		<td class="col0 leftalign"> <code>double</code>       </td><td class="col1 leftalign"> <code>double[]</code>       </td><td class="col2 leftalign">                             </td>
	</tr>
	<tr class="row6">
		<td class="col0 leftalign"> <code>float</code>        </td><td class="col1 leftalign"> <code>float[]</code>        </td><td class="col2 leftalign">                             </td>
	</tr>
	<tr class="row7">
		<td class="col0 leftalign"> <code>int</code>          </td><td class="col1 leftalign"> <code>int[]</code>          </td><td class="col2 leftalign"> <code>ArrayList&lt;Integer&gt;</code>      </td>
	</tr>
	<tr class="row8">
		<td class="col0 leftalign"> <code>long</code>         </td><td class="col1 leftalign"> <code>long[]</code>         </td><td class="col2 leftalign">                             </td>
	</tr>
	<tr class="row9">
		<td class="col0 leftalign" colspan="3"> <code>Serializable</code>                                                  </td>
	</tr>
	<tr class="row10">
		<td class="col0 leftalign"> <code>short</code>        </td><td class="col1 leftalign"> <code>short[]</code>        </td><td class="col2 leftalign">                             </td>
	</tr>
	<tr class="row11">
		<td class="col0 leftalign" colspan="3"> <code>SparseArray</code>                                                   </td>
	</tr>
	<tr class="row12">
		<td class="col0 leftalign"> <code>String</code>       </td><td class="col1 leftalign"> <code>String[]</code>       </td><td class="col2 leftalign"> <code>ArrayList&lt;String&gt;</code>       </td>
	</tr>
</table></div>
<!-- EDIT7 TABLE [19372-20307] -->
</center>

<p>
Starea unei activități este menținută atâta vreme cât ea este activă (deci inclusiv când au fost apelate metodele <code>onPause()</code> și <code>onStop()</code>), aceasta putând fi restaurată corespunzător. Necesitatea asigurării consistenței activității de către programator apare în momentul în care activitatea este terminată/distrusă și apoi (re)pornită. O astfel de situație este frecventă în cazul în care se produce o schimbare de configurație (se modifică orientarea dispozitivului de afișare - portrait vs. landscape, limba, disponibilitatea tastaturii), întrucât de fiecare dată este necesar să se (re)încarce resursele specifice pentru valorile respective.
</p>

<p>
Ținându-se cont de faptul că activitatea poate fi terminată/distrusă în orice moment după ce nu se mai găsește în prim-plan / este ascunsă, asigurarea consistenței trebuie realizată de fiecare dată.
</p>

</div>

<h4 id="salvarea_starii">Salvarea Stării</h4>
<div class="level4">

<p>
Metoda <code>onSaveInstanceState()</code> este înainte de metoda <code>onStop()</code> și posibil înainte de metoda <code>onPause()</code>, deși acest lucru nu este garantat. Ea primește ca parametru un obiect de tip <code>Bundle</code> în care vor fi plasate datele din cadrul activității care se doresc a fi salvate, acestea putând fi identificate prin intermediul unei chei (de tip <code>String</code>).
</p>

<p>
<p><div class="noteclassic">Apelul metodei <code>onSaveInstanceState()</code> nu este garantat să fie realizat de fiecare dată întrucât pot fi situații în care nu este necesar ca starea activității să fie restaurată (utilizatorul a terminat activitatea prin apăsarea butonului <em>Back</em>).
</div></p>
</p>

<p>
În cazul în care se dorește salvarea explicită a conținutului unui obiect <code>EditText</code>, se poate proceda astfel:
</p>
<pre class="code java">@Override
<span class="kw1">protected</span> <span class="kw4">void</span> onSaveInstanceState<span class="br0">&#40;</span>Bundle savedInstanceState<span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="kw1">super</span>.<span class="me1">onSaveInstanceState</span><span class="br0">&#40;</span>savedInstanceState<span class="br0">&#41;</span><span class="sy0">;</span>
  EditText usernameEditText <span class="sy0">=</span> <span class="br0">&#40;</span>EditText<span class="br0">&#41;</span>findViewById<span class="br0">&#40;</span>R.<span class="me1">id</span>.<span class="me1">username_edit_text</span><span class="br0">&#41;</span><span class="sy0">;</span>
  savedInstanceState.<span class="me1">putString</span><span class="br0">&#40;</span>Constants.<span class="me1">USERNAME_EDIT_TEXT</span>, usernameEditText.<span class="me1">getText</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

<p>
Valoarea introdusă de utilizator va fi salvată în obiectul de tip <code>Bundle</code> sub denumirea <code>userNameEditText</code>, acesta fiind menținut și prin urmare utilizat între mai multe instanțe ale acestei activități.
</p>

<p>
Apelarea metodei părinte este necesară întrucât <abbr title="Application Programming Interface">API</abbr>-ul Android furnizează o implementare implicită pentru salvarea stării unei activități, parcurgând ierarhia de componente grafice (obiecte de tip <code>View</code>) care au asociat un identificator (<code>android:id</code>), folosit drept cheie în obiectul <code>Bundle</code>. Astfel, de regulă, pentru elementele interfeței grafice, nu este necesar să se mențină starea, acest lucru fiind realizat în mod automat, cu respectarea condiției menționate. De aceea, în metoda <code>onSaveInstanceState</code>, va fi realizată salvarea unor informații (obiecte ale clasei) pentru care procesul de salvare a stării nu este apelat. Totuși, asigurarea persistenței datelor nu se va realiza niciodată aici (întrucât nu se garantează apelarea sa), ci în metoda <code>onPause()</code>.
</p>

<p>
În obiectul de tip <code>Bundle</code>, prin cheia <code>android:viewHierarchyState</code> se va reține un alt obiect de tip <code>Bundle</code> care reține starea tuturor obiectelor de tip <code>View</code> din cadrul activității (care sunt identificate prin intermediul unui câmp <code>android:id</code>). În cadrul acestuia, prin cheia <code>android:views</code> se reține un obiect de tip <code>SparseArray</code> (un tip de dată specific Android care realizează mapări între întregi și obiecte, mai eficient decât un hashmap) care conține starea fiecărui obiect de tip <code>View</code> prin intermediul identificatorului său.
</p>
<pre class="code java">Bundle viewHierarchy <span class="sy0">=</span> savedInstanceState.<span class="me1">getBundle</span><span class="br0">&#40;</span><span class="st0">&quot;android:viewHierarchyState&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="kw1">if</span> <span class="br0">&#40;</span>viewHierarchy <span class="sy0">!=</span> <span class="kw2">null</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
  SparseArray<span class="sy0">&lt;?</span> <span class="kw1">extends</span> Parcelable<span class="sy0">&gt;</span> views <span class="sy0">=</span> viewHierarchy.<span class="me1">getSparseParcelableArray</span><span class="br0">&#40;</span><span class="st0">&quot;android:views&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw4">int</span> k<span class="sy0">=</span><span class="nu0">0</span><span class="sy0">;</span> k <span class="sy0">&lt;</span> views.<span class="me1">size</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span> k<span class="sy0">++</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    Log.<span class="me1">d</span><span class="br0">&#40;</span>Constants.<span class="me1">TAG</span>, views.<span class="me1">get</span><span class="br0">&#40;</span>k<span class="br0">&#41;</span> <span class="sy0">+</span> <span class="st0">&quot;-&gt;&quot;</span> <span class="sy0">+</span> views.<span class="me1">valueAt</span><span class="br0">&#40;</span>k<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span>
<span class="kw1">else</span> <span class="br0">&#123;</span>
  Log.<span class="me1">d</span><span class="br0">&#40;</span>Constants.<span class="me1">TAG</span>, <span class="st0">&quot;No view information was saved!&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

<p>
Prin urmare, dacă aplicația este oprită și apoi pornită din nou, obiectele de tip <code>View</code> vor avea conținutul existent în prealabil. Pentru a dezactiva această opțiune, trebuie specificată în fișierul .xml care descrie interfața grafică a activității, în elementul corespunzător obiectului de tip <code>View</code> proprietatea <code>android:saveEnabled=“false”</code>.
</p>

<p>
<p><div class="noteclassic">Dezactivarea se poate realiza și programatic, folosind metoda <code>setSaveEnabled(boolean)</code>.
</div></p>
</p>

</div>

<h4 id="restaurarea_starii">Restaurarea Stării</h4>
<div class="level4">

<p>
Încărcarea conținutului din obiectul de tip <code>Bundle</code> (în vederea restaurării stării) poate fi realizată:
</p>
<ol>
<li class="level1"><div class="li"> în metoda <code>onCreate()</code><br/>
<pre class="code java">@Override
<span class="kw1">protected</span> <span class="kw4">void</span> onCreate<span class="br0">&#40;</span>Bundle savedInstanceState<span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="kw1">super</span>.<span class="me1">onCreate</span><span class="br0">&#40;</span>savedInstanceState<span class="br0">&#41;</span><span class="sy0">;</span>
  setContentView<span class="br0">&#40;</span>R.<span class="me1">layout</span>.<span class="me1">activity_lifecycle_monitor</span><span class="br0">&#41;</span><span class="sy0">;</span>
  EditText usernameEditText <span class="sy0">=</span> <span class="br0">&#40;</span>EditText<span class="br0">&#41;</span>findViewById<span class="br0">&#40;</span>R.<span class="me1">id</span>.<span class="me1">username_edit_text</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="kw1">if</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>savedInstanceState <span class="sy0">!=</span> <span class="kw2">null</span><span class="br0">&#41;</span> <span class="sy0">&amp;&amp;</span> <span class="br0">&#40;</span>savedInstanceState.<span class="me1">getString</span><span class="br0">&#40;</span>Constants.<span class="me1">USERNAME_EDIT_TEXT</span><span class="br0">&#41;</span> <span class="sy0">!=</span> <span class="kw2">null</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    usernameEditText.<span class="me1">setText</span><span class="br0">&#40;</span>bundle.<span class="me1">getString</span><span class="br0">&#40;</span>Constants.<span class="me1">USERNAME_EDIT_TEXT</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
</div>
</li>
<li class="level1"><div class="li"> prin intermediul metodei <code>onRestoreInstanceState()</code>, apelată în mod automat între metodele <code>onStart()</code> și <code>onResume()</code>; această abordare permite separarea dintre codul folosit la crearea ferestrei și codul utilizat la restaurarea stării unei ferestre<br/>
<pre class="code java">@Override
<span class="kw1">protected</span> <span class="kw4">void</span> onRestoreInstanceState<span class="br0">&#40;</span>Bundle savedInstanceState<span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="kw1">super</span>.<span class="me1">onRestoreInstanceState</span><span class="br0">&#40;</span>bundle<span class="br0">&#41;</span><span class="sy0">;</span>
  EditText usernameEditText<span class="sy0">=</span> <span class="br0">&#40;</span>EditText<span class="br0">&#41;</span>findViewById<span class="br0">&#40;</span>R.<span class="me1">id</span>.<span class="me1">username_edit_text</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="kw1">if</span> <span class="br0">&#40;</span>savedInstanceState.<span class="me1">getString</span><span class="br0">&#40;</span>Constants.<span class="me1">USERNAME_EDIT_TEXT</span><span class="br0">&#41;</span> <span class="sy0">!=</span> <span class="kw2">null</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
      usernameEditText.<span class="me1">setText</span><span class="br0">&#40;</span>savedInstanceState.<span class="me1">getString</span><span class="br0">&#40;</span>Constants.<span class="me1">USERNAME_EDIT_TEXT</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
</div>
</li>
</ol>

</div>
<!-- EDIT6 SECTION "Gestiunea Stării unei Activități" [17930-26129] -->
<h3 class="sectionedit8" id="coordonarea_activitatilor">Coordonarea Activităților</h3>
<div class="level3">

<p>
În situația în care o activitate nouă este pornită în timp ce o activitate veche este în execuție, fiind necesară transmiterea de informații dintre acestea, este util să se cunoască ordinea în care sunt apelate metodele care gestionează ciclul de viață al celor două activități, astfel încât comunicarea dintre acestea să se realizeze în mod corect:
</p>
<ol>
<li class="level1"><div class="li"> se apelează metoda <code>onPause()</code> a activității vechi - aici trebuie realizată partea de scriere a informațiilor care trebuie să fie trimise;</div>
</li>
<li class="level1"><div class="li"> se apelează metodele <code>onCreate()</code>, <code>onStart()</code> și <code>onResume()</code> ale activității noi - aici trebuie realizată partea de citire a informațiilor care trebuie să fie primite;</div>
</li>
<li class="level1"><div class="li"> se apelează metoda <code>onStop()</code> a activității vechi;</div>
</li>
<li class="level1"><div class="li"> în situația în care necesarul de memorie nu este satisfăcut, este posibil să se apeleze metoda <code>onDestroy()</code> a activității vechi.</div>
</li>
</ol>

<p>
<img src="../../../../_media/eim/laboratoare/laborator02/coordonare_activitati.png%3Fw=400&amp;tok=9ca472" class="mediacenter" alt="" width="400" />
</p>

</div>
<!-- EDIT8 SECTION "Coordonarea Activităților" [26130-27156] -->
<h2 class="sectionedit9" id="structura_unui_proiect_android_in_eclipse_luna_sr1a_441">Structura unui Proiect Android în Eclipse Luna SR1a (4.4.1)</h2>
<div class="level2">

<p>
Structura unui proiect Android în mediul integrat de dezvoltare Eclipse Luna SR1a (4.4.1) poate fi observată în fereastra <em>Package Explorer</em>.
</p>

<p>
<img src="../../../../_media/eim/laboratoare/laborator02/eclipse_package_explorer.png%3Fw=300&amp;tok=705474" class="mediacenter" alt="" width="300" />
</p>
<ul>
<li class="level1"><div class="li"> biblioteca <strong>Android 4.1.2</strong> (Google APIs) - conține mai multe fișiere:</div>
<ul>
<li class="level2"><div class="li"> <code>android.jar</code> - cuprinde toate clasele necesare pentru aplicația Android;</div>
</li>
<li class="level2"><div class="li"> <code>usb.jar</code> - încapsulează clase necesare instalării aplicației Android prin USB și comunicării cu dispozitivul fizic;</div>
</li>
<li class="level2"><div class="li"> <code>effects.jar</code> - utilizată pentru aplicarea de diferite efecte;</div>
</li>
<li class="level2"><div class="li"> <code>maps.jar</code> - folosită de aplicațiile Android care implementează funcționalități legate de localizare.</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> <strong>Android Private Libraries</strong> conține un singur fișier <code>android-support-v4.jar</code>;</div>
</li>
<li class="level1"><div class="li"> <strong>src</strong> - conține sursele <code>.java</code> ale proiectului, organizate pe pachete. În exemplu, codul este organizat pe trei pachete, cea mai importanta clasa fiind <code>LifecycleMonitorActivity.java</code> (în pachetul <code>ro.pub.cs.systems.pdsd.lab02.graphicuserinterface</code>) continand activitatea principala a aplicației Android.</div>
</li>
<li class="level1"><div class="li"> <strong>gen</strong> - cuprinde fișiere generate:</div>
<ul>
<li class="level2"><div class="li"> <code>BuildConfig.java</code> - definește unele proprietăți ale aplicației (cum ar fi activarea sau nu a modului de depanare);</div>
</li>
<li class="level2"><div class="li"> <code>R.java</code> - include identificatori către toate resursele din cadrul proiectului, prin intermediul cărora pot fi obținute referințe către acestea; conține subclasele:</div>
<ul>
<li class="level3"><div class="li"> <code>attr</code> - diferite atribute;</div>
</li>
<li class="level3"><div class="li"> <code>color</code> - culorile utilizate ca fundal pentru diferite componente grafice afișate în cadrul activităților din cadrul aplicației;</div>
</li>
<li class="level3"><div class="li"> <code>dimen</code> - dimensiunile dispozitivului de afișare, pentru fiecare configurație suportată de aplicație;</div>
</li>
<li class="level3"><div class="li"> <code>drawable</code> - resurse de tip grafic, utilizate în cadrul aplicației;</div>
</li>
<li class="level3"><div class="li"> <code>id</code> - identificatori pentru toate resursele care pot fi referite prin intermediul unui câmp de tipul <code>android:id</code>;</div>
</li>
<li class="level3"><div class="li"> <code>layout</code> - mecanisme de dispunere a conținutului aferente activităților (interfețelor grafice), pentru fiecare configurație suportată de aplicație;</div>
</li>
<li class="level3"><div class="li"> <code>menu</code> - diferitele meniuri atașate activităților (interfețelor grafice) din cadrul aplicației;</div>
</li>
<li class="level3"><div class="li"> <code>string</code> - șirurile de caractere definite în cadrul aplicației;</div>
</li>
<li class="level3"><div class="li"> <code>style</code> - stilurile (temele) folosite în cadrul aplicației.</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>

<p>
<p><div class="notewarning">Este interzisă modificarea fișierelor din directorul <code>gen</code>.<br/>
În cazul în care fișierul <code>R.java</code> este șters manual, acesta va fi imediat generat de către mediul de dezvoltare, cu condiția ca proiectul să nu conțină erori (erori de sintaxă în cazul codului sursă sau documente XML care nu sunt bine formate).

</div></p>
</p>
<ul>
<li class="level1"><div class="li"> <strong>assets</strong> - cuprinde toate activele utilizate de aplicație (fișiere text, pagini <abbr title="HyperText Markup Language">HTML</abbr>, baze de date), acestea fiind necompilate;</div>
</li>
<li class="level1"><div class="li"> <strong>bin</strong> - include fișierele construite de ADT în timpul procesului de generare, mai ales fișierul <code>.apk</code> (Android Package), un binar care conține toate resursele necesare pentru a rula o aplicație Android;</div>
</li>
<li class="level1"><div class="li"> <strong>libs</strong> - cuprinde toate bibliotecile necesare pentru compilarea și rularea proiectului;</div>
</li>
<li class="level1"><div class="li"> <strong>res</strong> - deține toate resursele folosite în cadrul aplicației</div>
<ul>
<li class="level2"><div class="li"> <code>drawable-&lt;resolution&gt;</code>: imaginile utilizate in aplicație, în funcție de rezoluție (ldpi, mdpi, hdpi, xhdpi, xxhdpi)</div>
</li>
<li class="level2"><div class="li"> <code>layout</code>: fișierul <code>activity_lifecycle_monitor.xml</code> care descrie modul de dispunere a elementelor grafice în cadrul interfaței cu utilizatorul, separată de codul programului (de asemenea, sunt conținute și fișierele care descriu mecanismele de dispunere pentru ferestrele care indică rezultatul operației de autentificare: <code>popup_window_authentication_success.xml</code> și <code>popup_window_authentication_fail.xml</code>);<br/>
<dl class="file">
<dt><a href="../../../code/eim/laboratoare/laborator02%3Fcodeblock=10" title="Download Snippet" class="mediafile mf_xml">activity_lifecycle_monitor.xml</a></dt>
<dd><pre class="code file xml"><span class="sc3"><span class="re1">&lt;LinearLayout</span> <span class="re0">xmlns:android</span>=<span class="st0">&quot;http://schemas.android.com/apk/res/android&quot;</span></span>
<span class="sc3">    <span class="re0">xmlns:tools</span>=<span class="st0">&quot;http://schemas.android.com/tools&quot;</span></span>
<span class="sc3">    <span class="re0">android:layout_width</span>=<span class="st0">&quot;match_parent&quot;</span></span>
<span class="sc3">    <span class="re0">android:layout_height</span>=<span class="st0">&quot;wrap_content&quot;</span></span>
<span class="sc3">    <span class="re0">android:paddingBottom</span>=<span class="st0">&quot;@dimen/activity_vertical_margin&quot;</span></span>
<span class="sc3">    <span class="re0">android:paddingLeft</span>=<span class="st0">&quot;@dimen/activity_horizontal_margin&quot;</span></span>
<span class="sc3">    <span class="re0">android:paddingRight</span>=<span class="st0">&quot;@dimen/activity_horizontal_margin&quot;</span></span>
<span class="sc3">    <span class="re0">android:paddingTop</span>=<span class="st0">&quot;@dimen/activity_vertical_margin&quot;</span></span>
<span class="sc3">    <span class="re0">android:orientation</span>=<span class="st0">&quot;vertical&quot;</span></span>
<span class="sc3">    <span class="re0">tools:context</span>=<span class="st0">&quot;ro.pub.cs.systems.pdsd.lab02.graphicuserinterface.LifecycleMonitorActivity&quot;</span> <span class="re2">&gt;</span></span>
&nbsp;
    <span class="sc3"><span class="re1">&lt;ImageView</span></span>
<span class="sc3">        <span class="re0">android:id</span>=<span class="st0">&quot;@+id/icon_image_view&quot;</span></span>
<span class="sc3">        <span class="re0">android:layout_width</span>=<span class="st0">&quot;wrap_content&quot;</span></span>
<span class="sc3">        <span class="re0">android:layout_height</span>=<span class="st0">&quot;wrap_content&quot;</span></span>
<span class="sc3">        <span class="re0">android:layout_gravity</span>=<span class="st0">&quot;center&quot;</span></span>
<span class="sc3">        <span class="re0">android:contentDescription</span>=<span class="st0">&quot;@string/icon_image_view_content_description&quot;</span></span>
<span class="sc3">        <span class="re0">android:src</span>=<span class="st0">&quot;@drawable/ic_launcher&quot;</span> <span class="re2">/&gt;</span></span>
&nbsp;
    <span class="sc3"><span class="re1">&lt;EditText</span></span>
<span class="sc3">        <span class="re0">android:id</span>=<span class="st0">&quot;@+id/username_edit_text&quot;</span></span>
<span class="sc3">        <span class="re0">android:layout_width</span>=<span class="st0">&quot;match_parent&quot;</span></span>
<span class="sc3">        <span class="re0">android:layout_height</span>=<span class="st0">&quot;wrap_content&quot;</span></span>
<span class="sc3">        <span class="re0">android:layout_gravity</span>=<span class="st0">&quot;center&quot;</span></span>
<span class="sc3">        <span class="re0">android:ems</span>=<span class="st0">&quot;10&quot;</span></span>
<span class="sc3">        <span class="re0">android:hint</span>=<span class="st0">&quot;@string/username&quot;</span> <span class="re2">&gt;</span></span>
&nbsp;
        <span class="sc3"><span class="re1">&lt;requestFocus</span> <span class="re2">/&gt;</span></span>
    <span class="sc3"><span class="re1">&lt;/EditText<span class="re2">&gt;</span></span></span>
&nbsp;
    <span class="sc3"><span class="re1">&lt;EditText</span></span>
<span class="sc3">        <span class="re0">android:id</span>=<span class="st0">&quot;@+id/password_edit_text&quot;</span></span>
<span class="sc3">        <span class="re0">android:layout_width</span>=<span class="st0">&quot;match_parent&quot;</span></span>
<span class="sc3">        <span class="re0">android:layout_height</span>=<span class="st0">&quot;wrap_content&quot;</span></span>
<span class="sc3">        <span class="re0">android:layout_gravity</span>=<span class="st0">&quot;center&quot;</span></span>
<span class="sc3">        <span class="re0">android:ems</span>=<span class="st0">&quot;10&quot;</span></span>
<span class="sc3">        <span class="re0">android:inputType</span>=<span class="st0">&quot;textPassword&quot;</span></span>
<span class="sc3">        <span class="re0">android:hint</span>=<span class="st0">&quot;@string/password&quot;</span> <span class="re2">/&gt;</span></span>
&nbsp;
    <span class="sc3"><span class="re1">&lt;CheckBox</span></span>
<span class="sc3">        <span class="re0">android:id</span>=<span class="st0">&quot;@+id/remember_me_checkbox&quot;</span></span>
<span class="sc3">        <span class="re0">android:layout_width</span>=<span class="st0">&quot;wrap_content&quot;</span></span>
<span class="sc3">        <span class="re0">android:layout_height</span>=<span class="st0">&quot;wrap_content&quot;</span></span>
<span class="sc3">        <span class="re0">android:text</span>=<span class="st0">&quot;@string/remember_me_checkbox_content&quot;</span> <span class="re2">/&gt;</span></span>
&nbsp;
    <span class="sc3"><span class="re1">&lt;LinearLayout</span></span>
<span class="sc3">        <span class="re0">android:layout_width</span>=<span class="st0">&quot;wrap_content&quot;</span></span>
<span class="sc3">    	<span class="re0">android:layout_height</span>=<span class="st0">&quot;wrap_content&quot;</span></span>
<span class="sc3">    	<span class="re0">android:layout_gravity</span>=<span class="st0">&quot;center&quot;</span></span>
<span class="sc3">    	<span class="re0">android:orientation</span>=<span class="st0">&quot;horizontal&quot;</span> <span class="re2">&gt;</span></span>
&nbsp;
	<span class="sc3"><span class="re1">&lt;Button</span></span>
<span class="sc3">	    <span class="re0">android:id</span>=<span class="st0">&quot;@+id/ok_button&quot;</span></span>
<span class="sc3">	    <span class="re0">android:layout_width</span>=<span class="st0">&quot;wrap_content&quot;</span></span>
<span class="sc3">	    <span class="re0">android:layout_height</span>=<span class="st0">&quot;wrap_content&quot;</span></span>
<span class="sc3">	    <span class="re0">android:layout_gravity</span>=<span class="st0">&quot;center&quot;</span></span>
<span class="sc3">	    <span class="re0">android:text</span>=<span class="st0">&quot;@string/ok_button_content&quot;</span> <span class="re2">/&gt;</span></span>
&nbsp;
	<span class="sc3"><span class="re1">&lt;Space</span></span>
<span class="sc3">	    <span class="re0">android:layout_width</span>=<span class="st0">&quot;0dp&quot;</span></span>
<span class="sc3">	    <span class="re0">android:layout_height</span>=<span class="st0">&quot;0dp&quot;</span></span>
<span class="sc3">	    <span class="re0">android:layout_weight</span>=<span class="st0">&quot;1&quot;</span> <span class="re2">/&gt;</span></span>	        
&nbsp;
	<span class="sc3"><span class="re1">&lt;Button</span></span>
<span class="sc3">	    <span class="re0">android:id</span>=<span class="st0">&quot;@+id/cancel_button&quot;</span></span>
<span class="sc3">	    <span class="re0">android:layout_width</span>=<span class="st0">&quot;wrap_content&quot;</span></span>
<span class="sc3">	    <span class="re0">android:layout_height</span>=<span class="st0">&quot;wrap_content&quot;</span></span>
<span class="sc3">	    <span class="re0">android:layout_gravity</span>=<span class="st0">&quot;center&quot;</span></span>
<span class="sc3">	    <span class="re0">android:text</span>=<span class="st0">&quot;@string/cancel_button_content&quot;</span> <span class="re2">/&gt;</span></span>
&nbsp;
    <span class="sc3"><span class="re1">&lt;/LinearLayout<span class="re2">&gt;</span></span></span>
&nbsp;
<span class="sc3"><span class="re1">&lt;/LinearLayout<span class="re2">&gt;</span></span></span></pre>
</dd></dl>

<p>
 Astfel, interfața grafică este dispusă folosind un mecanism de aliniere verticală, fiind formată din:
</p>
</div>
<ul>
<li class="level3"><div class="li"> un element <code>ImageView</code> prin intermediul căruia poate fi vizualizată o imagine;</div>
</li>
<li class="level3"><div class="li"> două elemente de tip <code>EditText</code> prin intermediul cărora care se vor transmite un nume de utilizator, respectiv o parolă (numele de utilizator fiind afișat în clar, în timp ce parola este ascunsă);</div>
</li>
<li class="level3"><div class="li"> un element de tip <code>CheckBox</code> prin intermediul căruia utilizatorul va putea să indice dacă dorește ca informațiile sale de autentificare să fie reținute sau nu;</div>
</li>
<li class="level3"><div class="li"> două butoane, dispuse folosind un mecanism de aliniere orizontală, prin intermediul cărora utilizatorul poate să transmită (către un server) informațiile sale de autentificare, pentru a fi procesate, respectiv dorește să anuleze informațiile introduse;</div>
</li>
</ul>
</li>
<li class="level2"><div class="li"> <code>menu</code>: fișierul <code>main.xml</code> conține un meniu care se va afișa la accesarea butonului <code>Options</code>, fiind folosit de metoda <code>onCreateOptionsMenu()</code>;</div>
</li>
<li class="level2"><div class="li"> <code>values</code></div>
<ul>
<li class="level3"><div class="li"> <code>colors.xml</code>: conține definițiile pentru culorile utilizate în cadrul interfeței grafice, ca fundal; <dl class="file">
<dt><a href="../../../code/eim/laboratoare/laborator02%3Fcodeblock=11" title="Download Snippet" class="mediafile mf_xml">colors.xml</a></dt>
<dd><pre class="code file xml"><span class="sc3"><span class="re1">&lt;?xml</span> <span class="re0">version</span>=<span class="st0">&quot;1.0&quot;</span> <span class="re0">encoding</span>=<span class="st0">&quot;utf-8&quot;</span><span class="re2">?&gt;</span></span>
<span class="sc3"><span class="re1">&lt;resources<span class="re2">&gt;</span></span></span>
&nbsp;
    <span class="sc3"><span class="re1">&lt;color</span> <span class="re0">name</span>=<span class="st0">&quot;light_green&quot;</span><span class="re2">&gt;</span></span>#bfd1bc<span class="sc3"><span class="re1">&lt;/color<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;color</span> <span class="re0">name</span>=<span class="st0">&quot;light_red&quot;</span><span class="re2">&gt;</span></span>#efcad1<span class="sc3"><span class="re1">&lt;/color<span class="re2">&gt;</span></span></span>
&nbsp;
<span class="sc3"><span class="re1">&lt;/resources<span class="re2">&gt;</span></span></span></pre>
</dd></dl>
</div>
</li>
<li class="level3"><div class="li"> <code>dimens.xml</code>: definește dimensiunile dispozitivului de afișare (<code>activity_horizontal_margin</code> și <code>activity_vertical_margin</code>);</div>
</li>
<li class="level3"><div class="li"> <code>strings.xml</code>: se recomandă ca toate șirurile de caractere constante definite în cadrul aplicației să fie definite aici, fiind referite prin intermediul unui identificator; astfel, în cazul în care este necesar să se localizeze aplicația în altă limbă, tot ce trebuie făcut este să se creeze o copie a directorului <code>values</code>, modificându-se corespunzător valorile din acest fișier pentru a conține textele în cauză; <dl class="file">
<dt><a href="../../../code/eim/laboratoare/laborator02%3Fcodeblock=12" title="Download Snippet" class="mediafile mf_xml">strings.xml</a></dt>
<dd><pre class="code file xml"><span class="sc3"><span class="re1">&lt;?xml</span> <span class="re0">version</span>=<span class="st0">&quot;1.0&quot;</span> <span class="re0">encoding</span>=<span class="st0">&quot;utf-8&quot;</span><span class="re2">?&gt;</span></span>
<span class="sc3"><span class="re1">&lt;?xml</span> <span class="re0">version</span>=<span class="st0">&quot;1.0&quot;</span> <span class="re0">encoding</span>=<span class="st0">&quot;utf-8&quot;</span><span class="re2">?&gt;</span></span>
<span class="sc3"><span class="re1">&lt;resources<span class="re2">&gt;</span></span></span>
&nbsp;
    <span class="sc3"><span class="re1">&lt;string</span> <span class="re0">name</span>=<span class="st0">&quot;app_name&quot;</span><span class="re2">&gt;</span></span>Activity Lifecycle Monitor<span class="sc3"><span class="re1">&lt;/string<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;string</span> <span class="re0">name</span>=<span class="st0">&quot;action_settings&quot;</span><span class="re2">&gt;</span></span>Settings<span class="sc3"><span class="re1">&lt;/string<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;string</span> <span class="re0">name</span>=<span class="st0">&quot;icon_image_view_content_description&quot;</span><span class="re2">&gt;</span></span>This is the application icon.<span class="sc3"><span class="re1">&lt;/string<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;string</span> <span class="re0">name</span>=<span class="st0">&quot;introduce_yourself_text_view_content&quot;</span><span class="re2">&gt;</span></span>Introduce yourself<span class="sc3"><span class="re1">&lt;/string<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;string</span> <span class="re0">name</span>=<span class="st0">&quot;username&quot;</span><span class="re2">&gt;</span></span>Username<span class="sc3"><span class="re1">&lt;/string<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;string</span> <span class="re0">name</span>=<span class="st0">&quot;password&quot;</span><span class="re2">&gt;</span></span>Password<span class="sc3"><span class="re1">&lt;/string<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;string</span> <span class="re0">name</span>=<span class="st0">&quot;remember_me_checkbox_content&quot;</span><span class="re2">&gt;</span></span>Remember me<span class="sc3"><span class="re1">&lt;/string<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;string</span> <span class="re0">name</span>=<span class="st0">&quot;ok_button_content&quot;</span><span class="re2">&gt;</span></span>OK<span class="sc3"><span class="re1">&lt;/string<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;string</span> <span class="re0">name</span>=<span class="st0">&quot;cancel_button_content&quot;</span><span class="re2">&gt;</span></span>Cancel<span class="sc3"><span class="re1">&lt;/string<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;string</span> <span class="re0">name</span>=<span class="st0">&quot;authentication_success&quot;</span><span class="re2">&gt;</span></span>The authentication process was successful!<span class="sc3"><span class="re1">&lt;/string<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;string</span> <span class="re0">name</span>=<span class="st0">&quot;authentication_fail&quot;</span><span class="re2">&gt;</span></span>The authentication process failed!<span class="sc3"><span class="re1">&lt;/string<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;string</span> <span class="re0">name</span>=<span class="st0">&quot;dismiss_button_content&quot;</span><span class="re2">&gt;</span></span>Dismiss<span class="sc3"><span class="re1">&lt;/string<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;string</span> <span class="re0">name</span>=<span class="st0">&quot;empty&quot;</span><span class="re2">&gt;</span><span class="re1">&lt;/string<span class="re2">&gt;</span></span></span>
&nbsp;
<span class="sc3"><span class="re1">&lt;/resources<span class="re2">&gt;</span></span></span></pre>
</dd></dl>
</div>
</li>
<li class="level3"><div class="li"> <code>styles.xml</code>: temele aplicației;</div>
</li>
</ul>
</li>
</ul>
</li>
<li class="level1"><div class="li"> <strong>AndroidManifest.xml</strong> - conține informații detaliate despre aplicație<br/>
<dl class="file">
<dt><a href="../../../code/eim/laboratoare/laborator02%3Fcodeblock=13" title="Download Snippet" class="mediafile mf_xml">AndroidManifest.xml</a></dt>
<dd><pre class="code file xml"><span class="sc3"><span class="re1">&lt;?xml</span> <span class="re0">version</span>=<span class="st0">&quot;1.0&quot;</span> <span class="re0">encoding</span>=<span class="st0">&quot;utf-8&quot;</span><span class="re2">?&gt;</span></span>
<span class="sc3"><span class="re1">&lt;?xml</span> <span class="re0">version</span>=<span class="st0">&quot;1.0&quot;</span> <span class="re0">encoding</span>=<span class="st0">&quot;utf-8&quot;</span><span class="re2">?&gt;</span></span>
<span class="sc3"><span class="re1">&lt;manifest</span> <span class="re0">xmlns:android</span>=<span class="st0">&quot;http://schemas.android.com/apk/res/android&quot;</span></span>
<span class="sc3">    <span class="re0">package</span>=<span class="st0">&quot;ro.pub.cs.systems.pdsd.lab02&quot;</span></span>
<span class="sc3">    <span class="re0">android:versionCode</span>=<span class="st0">&quot;1&quot;</span></span>
<span class="sc3">    <span class="re0">android:versionName</span>=<span class="st0">&quot;1.0&quot;</span> <span class="re2">&gt;</span></span>
&nbsp;
    <span class="sc3"><span class="re1">&lt;uses-sdk</span></span>
<span class="sc3">        <span class="re0">android:minSdkVersion</span>=<span class="st0">&quot;16&quot;</span></span>
<span class="sc3">        <span class="re0">android:targetSdkVersion</span>=<span class="st0">&quot;16&quot;</span> <span class="re2">/&gt;</span></span>
&nbsp;
    <span class="sc3"><span class="re1">&lt;application</span></span>
<span class="sc3">        <span class="re0">android:allowBackup</span>=<span class="st0">&quot;true&quot;</span></span>
<span class="sc3">        <span class="re0">android:icon</span>=<span class="st0">&quot;@drawable/ic_launcher&quot;</span></span>
<span class="sc3">        <span class="re0">android:label</span>=<span class="st0">&quot;@string/app_name&quot;</span></span>
<span class="sc3">        <span class="re0">android:theme</span>=<span class="st0">&quot;@style/AppTheme&quot;</span> <span class="re2">&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;activity</span></span>
<span class="sc3">            <span class="re0">android:name</span>=<span class="st0">&quot;ro.pub.cs.systems.pdsd.lab02.graphicuserinterface.LifecycleMonitorActivity&quot;</span></span>
<span class="sc3">            <span class="re0">android:label</span>=<span class="st0">&quot;@string/app_name&quot;</span> <span class="re2">&gt;</span></span>
            <span class="sc3"><span class="re1">&lt;intent-filter<span class="re2">&gt;</span></span></span>
                <span class="sc3"><span class="re1">&lt;action</span> <span class="re0">android:name</span>=<span class="st0">&quot;android.intent.action.MAIN&quot;</span> <span class="re2">/&gt;</span></span>
                <span class="sc3"><span class="re1">&lt;category</span> <span class="re0">android:name</span>=<span class="st0">&quot;android.intent.category.LAUNCHER&quot;</span> <span class="re2">/&gt;</span></span>
            <span class="sc3"><span class="re1">&lt;/intent-filter<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;/activity<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;/application<span class="re2">&gt;</span></span></span>
&nbsp;
<span class="sc3"><span class="re1">&lt;/manifest<span class="re2">&gt;</span></span></span></pre>
</dd></dl>
</div>
<ul>
<li class="level2"><div class="li"> denumirea pachetului aplicației este <code>ro.pub.cs.systems.pdsd.lab02</code>;</div>
</li>
<li class="level2"><div class="li"> versiunea codului aplicației este 1 (definit prin intermediul atributului <code>android:versionCode</code>); această valoare este utilizată pentru a identifica numărul de versiune al aplicației, putând fi folosit pentru a determina (programatic) dacă o aplicație trebuie să fie actualizată;</div>
</li>
<li class="level2"><div class="li"> denumirea versiunii aplicației este 1.0 (definită prin intermediul atributului <code>android:versionName</code>); această valoare este afișată utilizatorului, recomandându-se să se utilizeze formatul <code>&lt;major&gt;.&lt;minor&gt;.&lt;build&gt;</code></div>
</li>
<li class="level2"><div class="li"> atributul <code>android:minSdkVersion</code> al elementului <code>&lt;uses-sdk&gt;</code> specifică versiunea minimă a sistemului de operare pe care va rula aplicația;</div>
</li>
<li class="level2"><div class="li"> aplicația folosește drept pictogramă imaginea <code>ic_launcher.png</code> din directorul <code>drawable</code>;</div>
</li>
<li class="level2"><div class="li"> denumirea aplicației este dată de șirul de caractere <code>app_name</code> definit în fișierul <code>strings.xml</code>;</div>
</li>
<li class="level2"><div class="li"> există o singură activitate în cadrul aplicației, definită în fișierul <code>LifecycleMonitorActivity.java</code>, eticheta afișată pentru aceasta fiind aceeași ca și denumirea aplicației; există și un element <code>&lt;intent-filter&gt;</code>:</div>
<ul>
<li class="level3"><div class="li"> acțiunea pentru filtrul de intenții este denumit <code>android.intent.action.MAIN</code> pentru a indica faptul că activitatea reprezintă punctul de intrare pentru aplicație;</div>
</li>
<li class="level3"><div class="li"> categoria pentru filtrul de intenții este denumită <code>android.intent.category.LAUNCHER</code> pentru a indica faptul că aplicația poate fi lansată prin intermediul pictogramei afișată în contextul dispozitivului;</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>

<p>
Pentru a specifica o acțiune asociată butoanelor <em>OK</em> respectiv <em>Cancel</em> (deschiderea unei ferestre prin care se indică rezultatul operației de autentificare, respectiv ștergerea datelor din câmpurile ce conțin credențialele), se modifică codul sursă (fișierul <code>LifecycleMinitorActivity.java</code> din directorul <code>src</code>).
</p>

<p>
În  acest sens, se va defini o clasă ascultător (de tip <code>Button.OnClickListener</code>) internă, cu nume, a cărui instanță va fi atașată obiectului pe care se realizează evenimentul:
</p>
<pre class="code java"><span class="kw1">private</span> <span class="kw1">class</span> ButtonClickListener <span class="kw1">implements</span> <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+button"><span class="kw3">Button</span></a>.<span class="me1">OnClickListener</span> <span class="br0">&#123;</span>
&nbsp;
  @Override
  @SuppressWarnings<span class="br0">&#40;</span><span class="st0">&quot;all&quot;</span><span class="br0">&#41;</span>
  <span class="kw1">public</span> <span class="kw4">void</span> onClick<span class="br0">&#40;</span><a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+view"><span class="kw3">View</span></a> view<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    EditText usernameEditText <span class="sy0">=</span> <span class="br0">&#40;</span>EditText<span class="br0">&#41;</span>findViewById<span class="br0">&#40;</span>R.<span class="me1">id</span>.<span class="me1">username_edit_text</span><span class="br0">&#41;</span><span class="sy0">;</span>
    EditText passwordEditText <span class="sy0">=</span> <span class="br0">&#40;</span>EditText<span class="br0">&#41;</span>findViewById<span class="br0">&#40;</span>R.<span class="me1">id</span>.<span class="me1">password_edit_text</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span>getResources<span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">getString</span><span class="br0">&#40;</span>R.<span class="me1">string</span>.<span class="me1">ok_button_content</span><span class="br0">&#41;</span>.<span class="me1">equals</span><span class="br0">&#40;</span><span class="br0">&#40;</span><span class="br0">&#40;</span><a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+button"><span class="kw3">Button</span></a><span class="br0">&#41;</span>view<span class="br0">&#41;</span>.<span class="me1">getText</span><span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">toString</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
&nbsp;
      LayoutInflater layoutInflater <span class="sy0">=</span> <span class="br0">&#40;</span>LayoutInflater<span class="br0">&#41;</span>getBaseContext<span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">getSystemService</span><span class="br0">&#40;</span>LAYOUT_INFLATER_SERVICE<span class="br0">&#41;</span><span class="sy0">;</span>  		
&nbsp;
      <span class="kw1">if</span> <span class="br0">&#40;</span><a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+utilities"><span class="kw3">Utilities</span></a>.<span class="me1">allowAccess</span><span class="br0">&#40;</span>getApplicationContext<span class="br0">&#40;</span><span class="br0">&#41;</span>, usernameEditText.<span class="me1">getText</span><span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">toString</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, passwordEditText.<span class="me1">getText</span><span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">toString</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+view"><span class="kw3">View</span></a> popupContent <span class="sy0">=</span> layoutInflater.<span class="me1">inflate</span><span class="br0">&#40;</span>R.<span class="me1">layout</span>.<span class="me1">popup_window_authentication_success</span>, <span class="kw2">null</span><span class="br0">&#41;</span><span class="sy0">;</span>  
        <span class="kw1">final</span> PopupWindow popupWindow <span class="sy0">=</span> <span class="kw1">new</span> PopupWindow<span class="br0">&#40;</span>popupContent, LayoutParams.<span class="me1">WRAP_CONTENT</span>, LayoutParams.<span class="me1">WRAP_CONTENT</span><span class="br0">&#41;</span><span class="sy0">;</span>  
&nbsp;
        <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+button"><span class="kw3">Button</span></a> dismissButton <span class="sy0">=</span> <span class="br0">&#40;</span><a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+button"><span class="kw3">Button</span></a><span class="br0">&#41;</span>popupContent.<span class="me1">findViewById</span><span class="br0">&#40;</span>R.<span class="me1">id</span>.<span class="me1">dismiss_button</span><span class="br0">&#41;</span><span class="sy0">;</span>
        dismissButton.<span class="me1">setOnClickListener</span><span class="br0">&#40;</span><span class="kw1">new</span> <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+button"><span class="kw3">Button</span></a>.<span class="me1">OnClickListener</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#123;</span>	
          @Override
          <span class="kw1">public</span> <span class="kw4">void</span> onClick<span class="br0">&#40;</span><a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+view"><span class="kw3">View</span></a> view<span class="br0">&#41;</span> <span class="br0">&#123;</span>
            popupWindow.<span class="me1">dismiss</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
          <span class="br0">&#125;</span>
        <span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span>
	popupWindow.<span class="me1">showAtLocation</span><span class="br0">&#40;</span>view, Gravity.<span class="me1">CENTER</span>, <span class="nu0">0</span>, <span class="nu0">0</span><span class="br0">&#41;</span><span class="sy0">;</span>	
      <span class="br0">&#125;</span> <span class="kw1">else</span> <span class="br0">&#123;</span>
        <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+view"><span class="kw3">View</span></a> popupContent <span class="sy0">=</span> layoutInflater.<span class="me1">inflate</span><span class="br0">&#40;</span>R.<span class="me1">layout</span>.<span class="me1">popup_window_authentication_fail</span>, <span class="kw2">null</span><span class="br0">&#41;</span><span class="sy0">;</span>  
        <span class="kw1">final</span> PopupWindow popupWindow <span class="sy0">=</span> <span class="kw1">new</span> PopupWindow<span class="br0">&#40;</span>popupContent, LayoutParams.<span class="me1">WRAP_CONTENT</span>, LayoutParams.<span class="me1">WRAP_CONTENT</span><span class="br0">&#41;</span><span class="sy0">;</span>  
&nbsp;
        <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+button"><span class="kw3">Button</span></a> dismissButton <span class="sy0">=</span> <span class="br0">&#40;</span><a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+button"><span class="kw3">Button</span></a><span class="br0">&#41;</span>popupContent.<span class="me1">findViewById</span><span class="br0">&#40;</span>R.<span class="me1">id</span>.<span class="me1">dismiss_button</span><span class="br0">&#41;</span><span class="sy0">;</span>
        dismissButton.<span class="me1">setOnClickListener</span><span class="br0">&#40;</span><span class="kw1">new</span> <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+button"><span class="kw3">Button</span></a>.<span class="me1">OnClickListener</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#123;</span>	
          @Override
          <span class="kw1">public</span> <span class="kw4">void</span> onClick<span class="br0">&#40;</span><a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+view"><span class="kw3">View</span></a> view<span class="br0">&#41;</span> <span class="br0">&#123;</span>
            popupWindow.<span class="me1">dismiss</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
          <span class="br0">&#125;</span>
        <span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        popupWindow.<span class="me1">showAtLocation</span><span class="br0">&#40;</span>view, Gravity.<span class="me1">CENTER</span>, <span class="nu0">0</span>, <span class="nu0">0</span><span class="br0">&#41;</span><span class="sy0">;</span>					
      <span class="br0">&#125;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="kw1">if</span> <span class="br0">&#40;</span>getResources<span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">getString</span><span class="br0">&#40;</span>R.<span class="me1">string</span>.<span class="me1">cancel_button_content</span><span class="br0">&#41;</span>.<span class="me1">equals</span><span class="br0">&#40;</span><span class="br0">&#40;</span><span class="br0">&#40;</span><a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+button"><span class="kw3">Button</span></a><span class="br0">&#41;</span>view<span class="br0">&#41;</span>.<span class="me1">getText</span><span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">toString</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
      usernameEditText.<span class="me1">setText</span><span class="br0">&#40;</span>getResources<span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">getString</span><span class="br0">&#40;</span>R.<span class="me1">string</span>.<span class="me1">empty</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
      passwordEditText.<span class="me1">setText</span><span class="br0">&#40;</span>getResources<span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">getString</span><span class="br0">&#40;</span>R.<span class="me1">string</span>.<span class="me1">empty</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>

<p>
Se observă faptul că elementele din cadrul interfeței grafice sunt identificate prin intermediul valorilor generate în clasa <code>R</code>, transmise ca parametri metodei <code>findViewById()</code>. De asemenea, trebuie realizat cast-ul explicit la tipul respectiv.
</p>

<p>
Pentru șirurile de caractere se folosește metoda <code>getString()</code> aplicabilă unui obiect <code>Resources()</code>, obținut prin apelul metodei <code>getResources()</code> din clasa <code>Context</code>.
</p>

<p>
În cadrul metodei <code>onClick()</code> se preia textul corespunzător butonului care a fost apăsat, comparându-se cu valorile posibile (pentru ambele butoane se va folosi același obiect ascultător):
</p>
<ul>
<li class="level1"><div class="li"> în cazul în care s-a apăsat butonul <em>OK</em>, se parsează fișierul .xml din <code>assets</code> (<code>credentials.xml</code>), preluându-se de acolo toate combinațiile de nume de utilizator și parolă cu care se permite accesul în cadrul aplicației; în funcție de datele pe care le furnizează în câmpurile <em>Username</em> și <em>Password</em>, utilizatorul este informat, prin intermediul unei ferestre, de rezultatul operației de autentificare (succes sau eșec);</div>
</li>
<li class="level1"><div class="li"> în cazul în care s-a apăsat butonul <em>Cancel</em>, se șterg datele din câmpurile ce conțin credențialele (nume de utilizator și parolă), precizându-se pentru acestea un text asociat vid.</div>
</li>
</ul>

<p>
Pentru ca metoda să fie apelată la apăsarea butonului, va trebui realizată legătura dintre metodă și buton. Acest lucru se poate realiza în două moduri:
</p>
<ol>
<li class="level1"><div class="li"> programatic, în codul sursă:<br/>
<pre class="code java"><span class="kw1">private</span> ButtonClickListener buttonClickListener <span class="sy0">=</span> <span class="kw1">new</span> ButtonClickListener<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+button"><span class="kw3">Button</span></a> okButton <span class="sy0">=</span> <span class="br0">&#40;</span><a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+button"><span class="kw3">Button</span></a><span class="br0">&#41;</span>findViewById<span class="br0">&#40;</span>R.<span class="me1">id</span>.<span class="me1">ok_button</span><span class="br0">&#41;</span><span class="sy0">;</span>
okButton.<span class="me1">setOnClickListener</span><span class="br0">&#40;</span>buttonClickListener<span class="br0">&#41;</span><span class="sy0">;</span>
<a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+button"><span class="kw3">Button</span></a> cancelButton <span class="sy0">=</span> <span class="br0">&#40;</span><a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+button"><span class="kw3">Button</span></a><span class="br0">&#41;</span>findViewById<span class="br0">&#40;</span>R.<span class="me1">id</span>.<span class="me1">cancel_button</span><span class="br0">&#41;</span><span class="sy0">;</span>
cancelButton.<span class="me1">setOnClickListener</span><span class="br0">&#40;</span>buttonClickListener<span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>
</li>
<li class="level1"><div class="li"> în fișierul <code>activity_lifecycle_monitor.xml</code>, prin specificarea proprietății <code>android:onClick</code> asociată elementului buton având ca valoare denumirea metodei în cauză:<br/>
<pre class="code">android:onClick=&quot;onClick&quot;</pre>
</div>
</li>
</ol>

<p>
La compilare, este posibil ca unele clase să nu poată fi rezolvate. Se folosește <code>Ctrl+Shift+O</code> pentru a adăuga automat importurile necesare. 
</p>

</div>
<!-- EDIT9 SECTION "Structura unui Proiect Android în Eclipse Luna SR1a (4.4.1)" [27157-44128] -->
<h2 class="sectionedit10" id="rularea_si_depanarea_unei_aplicatii_android">Rularea și Depanarea unei aplicații Android</h2>
<div class="level2">

</div>
<!-- EDIT10 SECTION "Rularea și Depanarea unei aplicații Android" [44129-44187] -->
<h3 class="sectionedit11" id="rularea_unei_aplicatii_android">Rularea unei aplicații Android</h3>
<div class="level3">

<p>
Pentru a rula aplicația, este necesar un dispozitiv mobil fizic sau un dispozitiv mobil virtual (emulator).
</p>
<ul>
<li class="level1"><div class="li"> În cazul în care se folosește <strong>GenyMotion</strong>, se pornește un dispozitiv virtual, starea acestuia putând fi monitorizată folosind Genymotion Virtual Devices Manager, fereastră ce se deschide în momentul în care se accesează plugin-ul de Eclipse corespunzător (<code>Ctrl+6</code>).<br/>
<img src="../../../../_media/eim/laboratoare/laborator02/genymotion_virtual_devices_manager.png%3Fw=600&amp;tok=32f8d8" class="mediacenter" alt="" width="600" /></div>
</li>
<li class="level1"><div class="li"> În cazul în care se folosește <strong>emulatorul AVD</strong> livrat împreună cu SDK-ul de Android, se va crea un dispozitiv virtual accesând <em>Window</em> → <em>Android Virtual Device Manager</em> <br/>
<img src="../../../../_media/eim/laboratoare/laborator02/android_virtual_devices_manager.png%3Fw=600&amp;tok=6c1585" class="mediacenter" alt="" width="600" /> <br/>
Acesta permite gestiunea dispozitivelor virtuale (<em>New</em> / <em>Edit</em> / <em>Delete</em>) prin specificarea unor parametrii precum dispozitivul (poate fi utilizat un dispozitiv predefinit sau un dispozitiv definit de utilizator, pornind de la configurațiile existente în <em>Device Definitions</em>), versiunea de Android pe care se va rula, caracteristicile referitoare la memorie (RAM, heap-ul pentru mașina virtuală), dimensiunea spațiului de stocare, emularea unui card de memorie (dimensiune, fișier pe disc). Pornirea propriu-zisă a dispozitivului se face prin opțiunea <em>Start</em>. <br/>
<img src="../../../../_media/eim/laboratoare/laborator02/android_virtual_device_configuration.png%3Fw=300&amp;tok=25d5e2" class="mediacenter" alt="" width="300" /></div>
</li>
</ul>

<p>
Ulterior se poate rula aplicația, accesând din meniul contextual al proiectului (click dreapta) <em>Run As..</em> → <em>Android Application</em> (sau <code>Ctrl+F11</code>). În acest moment, se vor identifica toate dispozitivele Android (fizice sau virtuale) care sunt disponibile (conectate) și care rulează un sistem de operare având cel puțin un nivel de <abbr title="Application Programming Interface">API</abbr> specificat de proprietatea <code>android:minSdkVersion</code> în cadrul fișierului <code>AndroidManifest.xml</code>, afișându-se lista acestora, astfel încât utilizatorul să își poată alege unul dintre ele.
</p>

<p>
<img src="../../../../_media/eim/laboratoare/laborator02/android_devices.png%3Fw=600&amp;tok=5c2204" class="mediacenter" alt="" width="600" />
</p>

</div>
<!-- EDIT11 SECTION "Rularea unei aplicații Android" [44188-46284] -->
<h3 class="sectionedit12" id="depanarea_unei_aplicatii_android">Depanarea unei aplicații Android</h3>
<div class="level3">

<p>
Depanarea unei aplicații Android poate fi realizată în mod clasic, ca în cazul oricărui proiect (prin stabilirea unor puncte în care execuția codului sursă este întreruptă și rularea pas cu pas) sau prin intermediul unor utilitare specifice.
</p>

<p>
În cadrul mediului integrat de dezvoltare Eclipse Luna SR1a (4.4.1), depanarea unei aplicații este facilitată prin împărțirea ecranului în mai multe perspective între care programatorul are posibilitatea de a comuta:
</p>
<ul>
<li class="level1"><div class="li"> Java - pentru realizarea de modificări la nivelul codului sursă</div>
</li>
<li class="level1"><div class="li"> Debug - pentru monitorizarea pas cu pas a execuției programului, cu posibilitatea de consultare a valorilor pe care le au la un moment dat diferite obiecte</div>
</li>
<li class="level1"><div class="li"> DDMS - pentru furnizarea de informații detaliate la nivel de procese, fire de execuție, sistem de fișiere, memorie ocupată, evenimente specifice dispozitivelor mobile</div>
</li>
<li class="level1"><div class="li"> Hierarchy View - pentru vizualizarea ierarhiei de componente grafice din cadrul interfeței afișate utilizatorului</div>
</li>
</ul>

<p>
<img src="../../../../_media/eim/laboratoare/laborator02/eclipse_perspectives_for_android.png" class="mediacenter" alt="" />
</p>

</div>

<h4 id="android_debug_bridge_adb">Android Debug Bridge (ADB)</h4>
<div class="level4">

<p>
Android Debug Bridge este un utilitar în linie de comandă care permite comunicarea cu cu un dispozitiv mobil fizic sau cu un emulator, prin intermediul unui program client-server ce include 3 componente:
</p>
<ul>
<li class="level1"><div class="li"> un client, apelat prin comanda <code>adb</code> (alți clienți sunt plugin-ul ADT, DDMS-ul, Hierarchy View);</div>
</li>
<li class="level1"><div class="li"> un server (rulează ca proces de fundal), care gestionează comunicarea dintre client și daemonul ce rulează pe emulator sau dispozitivul mobil fizic;</div>
</li>
<li class="level1"><div class="li"> un daemon, care rulează ca un proces de fundal pentru fiecare emulator sau dispozitiv mobil fizic.</div>
</li>
</ul>

<p>
ADB este integrat în SDK-ul de Android, regăsindu-se în directorul <code>platform-tools</code>.
</p>

<p>
<strong>Comenzi ADB</strong>
</p>
<ul>
<li class="level1"><div class="li"> pentru a folosi ADB shell, device-ul Android trebuie să fie root-at (imaginile genymotion sunt deja).</div>
</li>
<li class="level1"><div class="li"> comenzile ADB pot fi rulate din linia de comandă sau din script, având următorul format:<pre class="code">student@eim2016:/opt/android-sdk-linux/platform-tools$ adb [-d|-e|-s &lt;serialNumber&gt;] &lt;command&gt;</pre>
</div>
</li>
<li class="level1"><div class="li"> înainte de a utiliza comenzi <code>adb</code> este important să fie cunoscut identificatorul dispozitivului care este conectat la serverul adb, acesta putând fi identificat prin comanda <code>adb devices</code>:<pre class="code">student@eim2016:/opt/android-sdk-linux/platform-tools$ adb devices
List of devices attached 
emulator-5556           device
192.168.56.101:5555	device
0123456789ABCDEF	device</pre>
</div>
</li>
<li class="level1"><div class="li"> conexiunea la emulator se realizează folosind comanda <code>adb -s &lt;serialNumber&gt; shell</code></div>
</li>
</ul>

<p>
Depanarea este foarte importantă în procesul de realizare a aplicațiilor pentru dispozitive mobile. Există însă unele diferențe față de depanarea programelor pentru calculator, întrucât aplicațiile rulează pe un alt dispozitiv, fiind necesare programe specializate. De asemenea, fiind vorba de dispozitive mobile, apar și anumite evenimente specifice, cum ar fi apeluri telefonice, primirea unui mesaj, descărcărea bateriei, întreruperi ce trebuie tratate intr-un fel sau altul.
</p>

</div>

<h4 id="logcat">LogCat</h4>
<div class="level4">

<p>
Jurnalele sistemului de operare conțin cele mai importante informații pentru programator. Acestea descriu toate acțiunile realizate de către dispozitivul mobil, excepțiile apărute precum și alte informații necesare depanării. Ele pot fi vizualizate în panoul denumit <strong>LogCat</strong>.
</p>

<p>
<p><div class="noteimportant">LogCat nu trebuie confundat cu Console, în care sunt afișate mesajele provenind de la Eclipse.
</div></p>
</p>

<p>
De regulă, la pornirea unei aplicații, utilizatorul este întrebat dacă dorește să monitorizeze mesajele provenind de la dispozitivul mobil, indicându-se și nivelul de prioritate prin care acestea vor fi filtrate (<code>verbose</code>, <code>debug</code>, <code>info</code>, <code>warning</code>, <code>error</code>, <code>assert</code>).
</p>

<p>
<img src="../../../../_media/eim/laboratoare/laborator02/logcat_launch1.png%3Fw=500&amp;tok=b92484" class="mediacenter" alt="" width="500" />
</p>

<p>
Ulterior, acest <em>Window</em> → <em>Show View</em> → <em>Other…</em> → <em>Android</em> → <em>LogCat</em>
</p>

<p>
<img src="../../../../_media/eim/laboratoare/laborator02/logcat_launch2.png%3Fw=300&amp;tok=7afc2d" class="mediacenter" alt="" width="300" />
</p>

<p>
Fiecare mesaj din această listă este insoțit de următoarele informații (fiecare pe cate o coloană):
</p>
<ul>
<li class="level1"><div class="li"> <em>Level</em> (tipul mesajului)</div>
<ul>
<li class="level2"><div class="li"> <strong>V</strong> - <em>Verbose</em> - informații suplimentare afișate de programe (de obicei la cerere, se folosesc la depistarea problemelor de funcționare rezultate din cauza configurării greșite a programelor)</div>
</li>
<li class="level2"><div class="li"> <strong>D</strong> - <em>Debug</em> - mesaj utile la depanare</div>
</li>
<li class="level2"><div class="li"> <strong>I</strong> - <em>Information</em> - mesaj informativ</div>
</li>
<li class="level2"><div class="li"> <strong>W</strong> - <em>Warning</em> - mesaj de avertizare (excepțiile ce nu sunt foarte importante, neavând un impact semnificativ asupra componentei)</div>
</li>
<li class="level2"><div class="li"> <strong>E</strong> - <em>Error</em> - mesaj de eroare (excepțiile ce întrerup o componentă)</div>
</li>
<li class="level2"><div class="li"> <strong>A</strong> - <em>Assert</em> - mesaj ce indică faptul că o condiție esențială pentru rularea aplicației nu a fost îndeplinită</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> <em>Time</em> - data și ora la care a fost generat mesajul  </div>
</li>
<li class="level1"><div class="li"> <em>PID</em> - identificatorul procesului ce a generat mesajul </div>
</li>
<li class="level1"><div class="li"> <em>TID</em> - identificatorul firului de execuție ce a general mesajul</div>
</li>
<li class="level1"><div class="li"> <em>Application</em> - aplicațtia care a generat mesajul</div>
</li>
<li class="level1"><div class="li"> <em>Tag</em> - eticheta sau categoria mesajului (util pentru definirea de filtre)</div>
</li>
<li class="level1"><div class="li"> <em>Text</em> - conținutul propriu-zis al mesajului  </div>
</li>
</ul>

<p>
Este de remarcat faptul că fiecare mesaj reprezintă câte o linie de text. În cazul excepțiilor, întrucât acestea conțin în general mai multe linii, cuprinzând foarte multă informație, ele vor fi reprezentate de mai multe mesaje.
</p>

<p>
<img src="../../../../_media/eim/laboratoare/laborator02/logcat_messages.png%3Fw=700&amp;tok=d59f82" class="mediacenter" alt="" width="700" />
</p>

<p>
Există două mecanisme prin care utilizatorii pot genera astfel de mesaje:
</p>
<ul>
<li class="level1"><div class="li"> metodele statice ale clasei <a href="http://developer.android.com/reference/android/util/Log.html" class="urlextern" title="http://developer.android.com/reference/android/util/Log.html"  rel="nofollow">Log</a>, care primesc ca parametru prioritatea mesajului, eticheta și mesajul propriu zis<pre class="code java">Log.<span class="me1">println</span> <span class="br0">&#40;</span>Log.<span class="me1">DEBUG</span>, <span class="st0">&quot;log sample&quot;</span>, <span class="st0">&quot;this is a log message using 'log sample' tag&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
Pentru a se evita specificarea priorității mesajului de fiecare dată, se pot utiliza metode specifice, care primesc ca parametrii doar denumirea etichetei și mesajul ce se dorește a fi jurnalizat:
</p>
</div>
</li>
</ul>

<center>
<div class="table sectionedit13"><table class="inline">
	<tr class="row0">
		<th class="col0 centeralign">  Nivel de Prioritate  </th><th class="col1 centeralign">  Metodă  </th><th class="col2 centeralign">  Observații  </th>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  <code>ERROR</code>  </td><td class="col1 centeralign">  <code>Log.e(…)</code>  </td><td class="col2"> erori </td>
	</tr>
	<tr class="row2">
		<td class="col0 centeralign">  <code>WARNING</code>  </td><td class="col1 centeralign">  <code>Log.w(…)</code>  </td><td class="col2"> avertismente </td>
	</tr>
	<tr class="row3">
		<td class="col0 centeralign">  <code>INFO</code>  </td><td class="col1 centeralign">  <code>Log.i(…)</code>  </td><td class="col2"> mesaje de informare </td>
	</tr>
	<tr class="row4">
		<td class="col0 centeralign">  <code>DEBUG</code>  </td><td class="col1 centeralign">  <code>Log.d(…)</code>  </td><td class="col2"> mesaje utilizate pentru depanare; pot fi filtrate (ignorate) </td>
	</tr>
	<tr class="row5">
		<td class="col0 centeralign">  <code>VERBOSE</code>  </td><td class="col1 centeralign">  <code>Log.v(…)</code>  </td><td class="col2"> utilizate doar de programatori, pentru dezvoltarea aplicațiilor </td>
	</tr>
</table></div>
<!-- EDIT13 TABLE [52457-52864] -->
</center>
<ul>
<li class="level1"><div class="li"> <em>System.out.println</em> mesajele către consola standard (stdout)<pre class="code java"><a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+system"><span class="kw3">System</span></a>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">&#40;</span><span class="st0">&quot;this is a message to the standard console&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
Mesajele transmise sub această formă vor fi de tipul <code>Information</code> și vor avea eticheta <code>System.out</code>.
</p>
</div>
</li>
</ul>

<p>
O altă funcționalitate importantă este posibilitatea de filtrare a mesajelor de tip jurnal. Deoarece LogCat afișează toate mesajele de log din sistem, urmărirea unor anumite mesaje poate fi dificilă. Pentru a facilita această sarcină, se pot genera filtre în funcție de anumite valori ale:
</p>
<ul>
<li class="level1"><div class="li"> etichetei </div>
</li>
<li class="level1"><div class="li"> mesajului propriu-zis</div>
</li>
<li class="level1"><div class="li"> PID</div>
</li>
<li class="level1"><div class="li"> denumirii aplicației</div>
</li>
<li class="level1"><div class="li"> nivelului minim al tipului de mesaj (<code>verbose</code> → <code>assert</code>)</div>
</li>
</ul>

<p>
Un filtru se creează prin apăsarea butonului plus de culoare verde din bara panoului Log (respectiv LogCat în Eclipse).
</p>

<p>
<img src="../../../../_media/eim/laboratoare/laborator02/logcat_message_filter_settings.png" class="mediacenter" alt="" />
</p>

<p>
Se recomandă să se configureze un număr cât mai mare de mesaje de jurnalizare care să fie stocate în memoria tampon (<em>Window</em> → <em>Preferences</em> → <em>Android</em> → <em>LogCat</em>) întrucât după depășirea valorii respective, monitorizarea nu va mai fi posibilă.
</p>

<p>
<img src="../../../../_media/eim/laboratoare/laborator02/logcat_configuration.png%3Fw=700&amp;tok=553089" class="mediacenter" alt="" width="700" />
</p>

</div>

<h4 id="ddms">DDMS</h4>
<div class="level4">

<p>
Utilitarul pentru depanarea aplicațiilor pentru Android se numește <strong>DDMS (Dalvik Debug Monitor System)</strong>. Acesta folosește <strong>ADB (Android Debug Bridge)</strong>, pentru a se conecta dispozitive fizice sau la emulatoare. Prin intermediul DDMS se pot vizualiza parametrii dispozitivului si a aplicațiilor ce ruleaza pe acesta. DDMS poate fi accesat sub forma unei perspective Eclipse, care va fi deschisă prin <em>Window</em> → <em>Open Perspective</em> → <em>DDMS</em>.
</p>

<p>
<img src="../../../../_media/eim/laboratoare/laborator02/ddms.png%3Fw=300&amp;tok=69f6ad" class="mediacenter" alt="" width="300" />
</p>

<p>
DDMS va afișa lista tuturor dispozitivelor mobile conectate (fizice sau virtuale), pentru fiecare indicându-se toate procesele care rulează (identificabile prin denumirea pachetului), numărul de proces și numărul firului de execuție. Alegerea dispozitivului curent se face prin selectarea lui din panoul <code>Devices</code>. Operațiile disponibile pentru fiecare proces în parte sunt: depanarea, actualizarea informațiilor cu privire la memoria utilizată, rularea (forțată) procesului de colectare a memoriei disponibile, afișarea firelor de execuție asociate, analiza metodelor, oprirea, realizarea unei capturi de ecran, vizualizarea ierarhiei de componente grafice.
</p>

<p>
Cele mai importante funcționalități pe care le oferă DDMS sunt:
</p>
<ul>
<li class="level1"><div class="li"> afișarea informațiilor despre procesele curente și firele lor de execuție</div>
</li>
<li class="level1"><div class="li"> afișarea informațiilor cu privire la utilizarea memoriei</div>
</li>
<li class="level1"><div class="li"> monitorizarea alocărilor de memorie</div>
</li>
<li class="level1"><div class="li"> vizualizarea unor statistici cu privire la traficul generat prin rețea</div>
</li>
<li class="level1"><div class="li"> consultarea sistemului de fișiere</div>
</li>
<li class="level1"><div class="li"> simularea unor evenimente de tip întrerupere în cadrul emulatoarelor</div>
</li>
<li class="level1"><div class="li"> furnizarea unor mesaje generale cu privire la sistemul de operare</div>
</li>
</ul>

<p>
<strong>Procese și Fire de Execuție</strong>
</p>

<p>
În panoul <strong><em>Threads</em></strong> sunt afișate informațiile despre fiecare fir de execuție corespunzător unui proces. Întrucât aceste informații sunt preluate prin intermediul unei legături de rețea, astfel încât traficul generat este destul de mare, pentru nu a se încetini semnificativ funcționarea dispozitivului mobil (care este nevoit sa transmită aceste date permanent), vizualizarea trebuie activată manual. Astfel, se selectează dispozitivul mobil dorit și procesul respectiv (din panoul <em>Devices</em>) și se apasă butonul <em>Refresh</em>.
</p>

<p>
<img src="../../../../_media/eim/laboratoare/laborator02/ddms_threads.png%3Fw=600&amp;tok=11ece2" class="mediacenter" alt="" width="600" />
</p>

<p>
<strong>Utilizarea Memoriei</strong>
</p>

<p>
DDMS oferă posibilitatea de a monitoriza utilizarea memoriei în cadrul panourilor <strong><em>Heap</em></strong> și <strong><em>Allocation Tracker</em></strong>, oferind informații cu privire la gradul de ocupare a memoriei, defalcată pe tipuri de obiecte (obiecte, clase, tablouri conținând elemente stocate pe 1, 2, 4, 8 octeți, date non-Java). 
</p>

<p>
<img src="../../../../_media/eim/laboratoare/laborator02/ddms_heap.png%3Fw=600&amp;tok=650c4d" class="mediacenter" alt="" width="600" />
</p>

<p>
<strong>Sistemul de Fișiere</strong>
</p>

<p>
Consultarea sistemului de fișiere al dispozitivului mobil poate fi realizat prin intermediul panoului <strong><em>File Explorer</em></strong>, putând fi vizualizate datele aplicației, stocate în <code>data/data/&lt;package-name&gt;</code>, unde <code>&lt;package-name&gt;</code> este denumirea pachetului corespunzător aplicației investigate.
</p>

<p>
<img src="../../../../_media/eim/laboratoare/laborator02/ddms_file_explorer.png%3Fw=600&amp;tok=1cec82" class="mediacenter" alt="" width="600" />
</p>

<p>
<strong>Simularea unor evenimente de tip întrerupere pentru emulator</strong>
</p>

<p>
Întrucât emulatorul de Android nu poate simula toate funcțiile unui telefon real, pentru a se putea testa comportamentul aplicațiilor în cazul apariției unor evenimente de tip întrerupere, DDMS pune la dispoziție un panou <strong><em>Emulator Control</em></strong>, prin care pot fi controlate:
</p>
<ul>
<li class="level1"><div class="li"> starea conexiunii de voce / date</div>
</li>
<li class="level1"><div class="li"> primirea unui apel telefonic / SMS (apel, pierdere apel)</div>
</li>
<li class="level1"><div class="li"> date primite de la GPS </div>
</li>
</ul>

<p>
<img src="../../../../_media/eim/laboratoare/laborator02/ddms_emulator_control.png%3Fw=600&amp;tok=9602b9" class="mediacenter" alt="" width="600" />
</p>

<p>
<p><div class="noteimportant">În cazul testării pe dispozitive mobile reale, aceste funcționalități nu vor fi disponibile prin intermediul DDMS.
</div></p>
</p>

<p>
<p><div class="notewarning">Emulatorul Genymotion nu permite simularea nici unuia dintre evenimentele de mai sus prin intermediul DDMS.
</div></p>
</p>

<p>
Din cadrul emulatoarelor (deci nu folosind DDMS) mai pot fi simulate evenimente de tip:
</p>
<ul>
<li class="level1"><div class="li"> cameră foto</div>
</li>
<li class="level1"><div class="li"> accelerometru</div>
</li>
</ul>

</div>

<h4 id="hierarchy_view">Hierarchy View</h4>
<div class="level4">

<p>
Un alt program foarte util pentru depanare este <strong>Hierarchy View</strong>. Acesta permite vizualizarea arborescentă a structurii ferestrelor. De asemenea, afișează parametrii fiecărui <code>View</code>, inclusiv timpul de încărcare. O altă funcționalitate pusă la dispoziția programatorilor este posibilitatea capturării unei imagini a View-ului. 
</p>

<p>
Întrucât prin acest utilitar se poate analiza orice aplicație (componentă) care rulează pe un dispozitiv mobil, el poate fi utilizat și ca sursă de inspirație asupra modului în care este construită interfața grafică. 
</p>

<p>
Hierarchy View poate fi accesat sub forma unei perspective Eclipse, care va fi deschisă prin <em>Window</em> → <em>Open Perspective</em> → <em>Hierarchy View</em>.
</p>

<p>
<img src="../../../../_media/eim/laboratoare/laborator02/hierarchy_view_tree_view.png%3Fw=600&amp;tok=044186" class="mediacenter" alt="" width="600" />
</p>

<p>
Hierarchy View funcționează atât pentru emulatoare cât și cu dispozitive fizice. 
</p>

<p>
La pornire, în panoul <em>Windows</em> (stânga) este afișată lista tuturor dispozitivelor mobile conectate. Se alege un dispozitiv mobil și o componentă ce rulează pe acel dispozitiv (prin expandarea dispozitivului mobil) și se apasă butonul <em>Load the view hierarchy into the tree view</em>. Afișarea ierarhiei de View-uri se face în panoul <em>Tree View</em> (centru) sub forma unui arbore. Panoul <em>Tree Overview</em> (dreapta) va prezenta o imagine de ansamblu a ierarhiei, evidențiindu-se selecția vizibilă la momentul respectiv în fereastra principală.
</p>

<p>
În momentul în care este selectat un element al arborelui, acesta va putea fi previzualizat (se prezintă imaginea sa), indicându-se componența sa, precum și unii parametrii ai acestuia (<code>measure</code>, <code>layout</code>, <code>draw</code>). 
</p>

<p>
<img src="../../../../_media/eim/laboratoare/laborator02/hierarchy_view_preview.png" class="mediacenter" alt="" />
</p>

<p>
Fereastra <em>View Properties</em> va conține toate proprietățile unei componente grafice, grupate pe categorii.
</p>

<p>
<img src="../../../../_media/eim/laboratoare/laborator02/hierarchy_view_view_properties.png" class="mediacenter" alt="" />
</p>

<p>
Fereastra <em>Layout View</em> evidențiază componenta curentă în cadrul interfeței grafice.
</p>

<p>
<img src="../../../../_media/eim/laboratoare/laborator02/hierarchy_view_layout_view.png" class="mediacenter" alt="" />
</p>

</div>
<!-- EDIT12 SECTION "Depanarea unei aplicații Android" [46285-60410] -->
<h2 class="sectionedit14" id="activitate_de_laborator">Activitate de Laborator</h2>
<div class="level2">

<p>
<strong>1.</strong> În contul Github personal, să se creeze un depozit denumit &#039;Laborator02&#039;. Inițial, acesta trebuie să fie gol (nu trebuie să bifați nici adăugarea unui fișier <code>README.md</code>, nici a fișierului <code>.gitignore</code> sau a a fișierului <code>LICENSE</code>).
</p>

<p>
<strong>2.</strong> Să se cloneze în directorul de pe discul local conținutul depozitului la distanță de la <a href="https://www.github.com/eim2016/Laborator02" class="urlextern" title="https://www.github.com/eim2016/Laborator02"  rel="nofollow">https://www.github.com/eim2016/Laborator02</a>. În urma acestei operații, directorul Laborator02 va trebui să se conțină un director <code>labtasks</code> ce va deține atât proiectul Android Studio cât și proiectul Eclipse, ambele denumite <code>ActivityLifecycleMonitor</code>, fișierul <code>README.md</code> și un fișier <code>.gitignore</code> care indică tipurile de fișiere (extensiile) ignorate. 
</p>
<pre class="code">student@eim2016:~$ git clone https://www.github.com/eim2016/Laborator02.git</pre>

<p>
<strong>3.</strong> Să se încarce conținutul descărcat în cadrul depozitului &#039;Laborator02&#039; de pe contul Github personal.  
</p>
<pre class="code">student@eim2016:~$ cd Laborator02
student@eim2016:~/Laborator02$ git remote add Laborator02_perfectstudent https://github.com/perfectstudent/Laborator02
student@eim2016:~/Laborator02$ git push Laborator02_perfectstudent master</pre>

<p>
<strong>4.</strong> Să se încarce în mediul integrat de dezvoltare Eclipse proiectul <code>ActivityLifecycleMonitor</code>, folosind opțiunea <em>File</em> → <em>Import…</em>.
</p>

<p>
<img src="../../../../_media/eim/laboratoare/laborator02/eclipse_import_project01.png%3Fw=500&amp;tok=74caf7" class="mediacenter" alt="" width="500" />
</p>

<p>
<img src="../../../../_media/eim/laboratoare/laborator02/eclipse_import_project02.png%3Fw=500&amp;tok=ed1d93" class="mediacenter" alt="" width="500" />
</p>

<p>
<strong>5.</strong> În clasa <code>LifecycleMonitorActivity</code> din pachetul <code>ro.pub.cs.systems.eim.lab02.activitylifecyclemonitor.graphicuserinterface</code>, să se suprascrie metodele care monitorizează ciclul de viață al unei activități; fiecare dintre acestea va trebui <strong>să apeleze metoda părinte</strong> și <strong>să notifice apelarea sa prin intermediul unui mesaj</strong>, având prioritatea <code>DEBUG</code> și eticheta <code>activitylifecyclemonitor</code>:
</p>
<pre class="code java">Log.<span class="me1">d</span><span class="br0">&#40;</span>Constants.<span class="me1">TAG</span>, <span class="st0">&quot;??? method was invoked&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
<ol>
<li class="level1"><div class="li"> <code>onRestart()</code> </div>
</li>
<li class="level2"><div class="li"> <code>onStart()</code></div>
</li>
<li class="level2"><div class="li"> <code>onResume()</code></div>
</li>
<li class="level2"><div class="li"> <code>onPause()</code></div>
</li>
<li class="level2"><div class="li"> <code>onStop()</code></div>
</li>
<li class="level2"><div class="li"> <code>onDestroy()</code></div>
</li>
</ol>

<p>
<strong>6.</strong> Să se creeze un filtru, denumit <code>ActivityLifecycleMonitor</code>, astfel încât LogCat să afișeze doar mesajele care au eticheta <code>activitylifecyclemonitor</code>, generate de aplicația <code>ro.pub.cs.systems.eim.lab02.activitylifecyclemonitor</code> și au cel puțin prioritatea <code>debug</code>.
</p>

<p>
<strong>7.</strong> Să se modifice mesajul din metoda <code>onCreate()</code>, astfel încât să se indice dacă activitatea a mai fost lansată în execuție anterior sau nu (dacă există o stare a activității care trebuie restaurată).
</p>

<p>
<strong>8.</strong> Să se inspecteze mesajele care sunt generate la producerea următoarelor evenimente:
</p>
<ol>
<li class="level1"><div class="li"> se apasă butonul <em>Home</em></div>
</li>
<li class="level2"><div class="li"> se apasă butonul <em>Back</em></div>
</li>
<li class="level2"><div class="li"> se apasă butonul <em>OK</em> din cadrul aplicației (indiferent dacă datele de autentificare sunt corecte sau nu)</div>
</li>
<li class="level2"><div class="li"> se ține apăsat butonul <em>Home</em> o perioadă de timp mai mare</div>
</li>
<li class="level2"><div class="li"> se primește un apel telefonic<br/>
a) pentru AVD, se poate folosi <em>DDMS</em> → <em>Emulator Control</em><br/>
b) pentru Genymotion se poate simula doar formarea unui număr de telefon <pre class="code">student@eim2016:/opt/android-sdk-linux/platform-tools$ adb devices
List of devices attached 
192.168.56.101:5555	device
student@eim2016:/opt/android-sdk-linux/platform-tools$ adb -s 192.168.56.101:5555 shell
root@android:/ # am start -a android.intent.action.CALL tel:1122334455
Starting: Intent { act=android.intent.action.CALL dat=tel:xxxxxxxxxx }</pre>
</div>
<ol>
<li class="level3"><div class="li"> se acceptă convorbirea</div>
</li>
<li class="level3"><div class="li"> se respinge convorbirea</div>
</li>
</ol>
</li>
<li class="level2"><div class="li"> se rotește ecranul (nu trebuie blocată opțiunea <em>Auto Rotate</em> din configurațiile dispozitivului mobil)</div>
</li>
</ol>

<p>
Să se observe ce metode sunt apelate în momentul în care se revine în aplicație.
</p>

<p>
Pe baza mesajelor, să se completeze tabelul de mai jos, indicând ordinea în care s-au apelat metodele respective:
</p>
<div class="table sectionedit15"><table class="inline">
	<tr class="row0">
		<th class="col0 leftalign">  </th><th class="col1 centeralign">  <code>onCreate()</code>  </th><th class="col2 centeralign">  <code>onRestart()</code>  </th><th class="col3 centeralign">  <code>onStart()</code>  </th><th class="col4 centeralign">  <code>onResume()</code>  </th><th class="col5 centeralign">  <code>onPause()</code>  </th><th class="col6 centeralign">  <code>onStop()</code>  </th><th class="col7 centeralign">  <code>onDestroy()</code>  </th>
	</tr>
	<tr class="row1">
		<td class="col0"> 1) buton <em>Home</em> </td><td class="col1 leftalign">   </td><td class="col2 leftalign">   </td><td class="col3 centeralign">  3  </td><td class="col4 centeralign">  4  </td><td class="col5 centeralign">  1  </td><td class="col6 centeralign">  2  </td><td class="col7 leftalign">   </td>
	</tr>
	<tr class="row2">
		<td class="col0"> 2) buton <em>Back</em> </td><td class="col1 leftalign">   </td><td class="col2 leftalign">   </td><td class="col3 leftalign">   </td><td class="col4 leftalign">   </td><td class="col5 leftalign">   </td><td class="col6 leftalign">   </td><td class="col7 leftalign">   </td>
	</tr>
	<tr class="row3">
		<td class="col0"> 3) buton <em>OK</em> din aplicație </td><td class="col1 leftalign">   </td><td class="col2 leftalign">   </td><td class="col3 leftalign">   </td><td class="col4 leftalign">   </td><td class="col5 leftalign">   </td><td class="col6 leftalign">   </td><td class="col7 leftalign">   </td>
	</tr>
	<tr class="row4">
		<td class="col0"> 4) buton <em>Home</em> perioadă de timp mai mare </td><td class="col1 leftalign">   </td><td class="col2 leftalign">   </td><td class="col3 leftalign">   </td><td class="col4 leftalign">   </td><td class="col5 leftalign">   </td><td class="col6 leftalign">   </td><td class="col7 leftalign">   </td>
	</tr>
	<tr class="row5">
		<td class="col0"> 5) apel telefonic </td><td class="col1 leftalign" colspan="7">   </td>
	</tr>
	<tr class="row6">
		<td class="col0"> a) acceptare </td><td class="col1 leftalign">   </td><td class="col2 leftalign">   </td><td class="col3 leftalign">   </td><td class="col4 leftalign">   </td><td class="col5 leftalign">   </td><td class="col6 leftalign">   </td><td class="col7 leftalign">   </td>
	</tr>
	<tr class="row7">
		<td class="col0"> b) respingere </td><td class="col1 leftalign">   </td><td class="col2 leftalign">   </td><td class="col3 leftalign">   </td><td class="col4 leftalign">   </td><td class="col5 leftalign">   </td><td class="col6 leftalign">   </td><td class="col7 leftalign">   </td>
	</tr>
	<tr class="row8">
		<td class="col0"> 6) rotire ecran </td><td class="col1 leftalign">   </td><td class="col2 leftalign">   </td><td class="col3 leftalign">   </td><td class="col4 leftalign">   </td><td class="col5 leftalign">   </td><td class="col6 leftalign">   </td><td class="col7 leftalign">   </td>
	</tr>
</table></div>
<!-- EDIT15 TABLE [64341-64895] -->
<p>
<strong>9.</strong> Să se dezactiveze opțiunea de salvare a stării. 
</p>

<p>
<p><div class="notetip">În fișierul <code>activity_lifecycle_monitor.xml</code>, pentru fiecare dintre elementele grafice pentru care se dorește să se dezactiveze opțiunea de salvare a stării, se va completa proprietatea <code>android:saveEnabled=“false”</code>.
</div></p>
</p>

<p>
Să se observe care este comportamentul în privința informațiilor reținute în elementele grafice de tip <code>EditText</code>, respectiv <code>CheckBox</code>, în condițiile în care activitatea este distrusă (se apasă butonul <em>Home</em>, astfel încât să se apeleze metodele <code>onPause()</code> și <code>onStop()</code>, apoi, în DDMS, în panoul <em>Devices</em>, se identifică procesul corespunzător aplicației și se oprește folosind butonul <em>Stop Process</em>). Să se repornească aplicația din meniul dispozitivului mobil. 
</p>

<p>
<strong>10.</strong> Să se implementeze metoda <code>onSaveInstanceState()</code>, astfel încât, <strong>în condițiile în care este bifat elementul grafic de tip <code>CheckBox</code></strong>, să se salveze informațiile din interfața cu utilizatorul.
</p>

<p>
<p><div class="notetip">Se vor folosi metodele <code>putString()</code> și <code>putBoolean()</code> ale clasei <code>Bundle</code>.<br/>
<br/>
Cheile sub care vor fi identificate valorile salvate sunt definite în interfața <code>Constants</code> din pachetul <code>ro.pub.cs.systems.eim.lab02.activitylifecyclemonitor.general</code>.<br/>
<br/>
Verificarea faptului că un element grafic de tip <code>CheckBox</code> este bifat se face prin intermediul metodei <code>isChecked()</code>.
</div></p>
</p>

<p>
Să se observe comportamentul aplicației în condițiile producerii evenimentului descris anterior.
</p>

<p>
<strong>11.</strong> Să se implementeze metoda <code>onRestoreInstanceState()</code> astfel încât să se restaureze starea elementelor grafice. Să se observe comportamentul aplicației în condițiile producerii evenimentului descris anterior.
</p>

<p>
Să se transfere comportamentul de restaurare a stării pe metoda <code>onCreate()</code> și să se identifice diferențele de implementare (<a href="http://developer.android.com/training/basics/activity-lifecycle/recreating.html" class="urlextern" title="http://developer.android.com/training/basics/activity-lifecycle/recreating.html"  rel="nofollow">Hint</a>).
</p>

<p>
<strong>12.</strong>  Să se încarce modificările realizate în cadrul depozitului &#039;Laborator02&#039; de pe contul Github personal, folosind un mesaj sugestiv. 
</p>
<pre class="code">student@eim2016:~/Laborator02$ git add labtasks/*
student@eim2016:~/Laborator02$ git commit -m &quot;implemented taks for laboratory 02&quot;
student@eim2016:~/Laborator02$ git push Laborator02_perfectstudent master</pre>

</div>
<!-- EDIT14 SECTION "Activitate de Laborator" [60411-67257] -->
<h2 class="sectionedit16" id="resurse_utile">Resurse Utile</h2>
<div class="level2">

<p>
<a href="http://ptgmedia.pearsoncmg.com/images/9780321940261/samplepages/0321940261.pdf" class="urlextern" title="http://ptgmedia.pearsoncmg.com/images/9780321940261/samplepages/0321940261.pdf"  rel="nofollow">Joseph ANNUZZI, Jr, Lauren DARCEY, Shane CONDER, Introduction to Android Application Development - Developer&#039;s Library, 4th Edition, Addison-Wesley, 2013</a><br/>

<a href="http://www.bignerdranch.com/we-write/android-programming/" class="urlextern" title="http://www.bignerdranch.com/we-write/android-programming/"  rel="nofollow">Bill PHILLIPS, Brian HARDY, Android Programming. The Big Nerd Ranch Guide, Pearson Technology Group, 2013</a><br/>

<a href="http://eu.wiley.com/WileyCDA/WileyTitle/productCd-1118199545.html" class="urlextern" title="http://eu.wiley.com/WileyCDA/WileyTitle/productCd-1118199545.html"  rel="nofollow">Wei Meng LEE, Beginning Android 4 Application Development, Wiley, 2012</a><br/>

<a href="http://www.apress.com/9781430239307" class="urlextern" title="http://www.apress.com/9781430239307"  rel="nofollow">Satya KOMATINENI, Dave MACLEAN, Pro Android 4, Apress, 2012</a><br/>

<a href="http://www.coreservlets.com/android-tutorial" class="urlextern" title="http://www.coreservlets.com/android-tutorial"  rel="nofollow">Android Programming Tutorials - Core Servlets</a><br/>

<a href="http://www.tutorialspoint.com/android/index.htm" class="urlextern" title="http://www.tutorialspoint.com/android/index.htm"  rel="nofollow">Android Programming Tutorial - Tutorial&#039;s Point</a><br/>

<a href="http://android.rosedu.org/wiki/" class="urlextern" title="http://android.rosedu.org/wiki/"  rel="nofollow">Dezvoltarea aplicațiilor pentru Android</a><br/>

<a href="http://www.intertech.com/Blog/saving-and-retrieving-android-instance-state-part-1/" class="urlextern" title="http://www.intertech.com/Blog/saving-and-retrieving-android-instance-state-part-1/"  rel="nofollow">Saving (and Retrieving) Android Instance State</a><br/>

<a href="http://android-developers.blogspot.ro/2009/01/avoiding-memory-leaks.html" class="urlextern" title="http://android-developers.blogspot.ro/2009/01/avoiding-memory-leaks.html"  rel="nofollow">Avoiding Memory Leaks</a><br/>

<a href="http://developer.android.com/guide/components/activities.html" class="urlextern" title="http://developer.android.com/guide/components/activities.html"  rel="nofollow">Activities - Android Developers</a><br/>

<a href="http://android-developers.blogspot.ro/2011/06/things-that-cannot-change.html" class="urlextern" title="http://android-developers.blogspot.ro/2011/06/things-that-cannot-change.html"  rel="nofollow">Things that cannot change</a>
</p>

</div>
<!-- EDIT16 SECTION "Resurse Utile" [67258-] --></div>
</body>
</html>
