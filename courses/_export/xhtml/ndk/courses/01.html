    
    

<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <title>ndk:courses:01</title>
<meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="date" content="2014-11-05T11:54:44+0200"/>
<meta name="keywords" content="ndk,courses,01"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../../../lib/exe/opensearch.php" title="CS Open CourseWare"/>
<link rel="start" href="../../../../../courses.1.html"/>
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="../../../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="../../../../feed.php%3Fmode=list&amp;ns=ndk:courses"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="01.html"/>
<link rel="canonical" href="../../../../ndk/courses/01.html"/>
<link rel="stylesheet" type="text/css" href="../../../../lib/exe/css.php%3Ft=arctic&amp;tseed=1479898000.css"/>
<script type="text/javascript">/*<![CDATA[*/var NS='ndk:courses';var JSINFO = {"id":"ndk:courses:01","namespace":"ndk:courses","isadmin":0,"isauth":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../../../lib/exe/js.php%3Ftseed=1479898000"></script>
<script type="text/x-mathjax-config">/*<![CDATA[*/MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ["$","$"], ["\\(","\\)"] ],
        displayMath: [ ["$$","$$"], ["\\[","\\]"] ],
        processEscapes: true
    }
});
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<script type="text/javascript">/*<![CDATA[*/
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
		  
/*!]]>*/</script>
<script type="text/javascript">/*<![CDATA[*/
var pageTracker = _gat._getTracker("UA-38383934-1");
pageTracker._initData();
pageTracker._trackPageview();
		  
/*!]]>*/</script>
</head>
<body>
<div class="dokuwiki export">
<!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level2"><div class="li"><a href="01.html#android_technology">01. Android Technology</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="01.html#lecture">Lecture</a></div></li>
<li class="level3"><div class="li"><a href="01.html#practical">Practical</a></div>
<ul class="toc">
<li class="level4"><div class="li"><a href="01.html#resources">Resources</a></div></li>
<li class="level4"><div class="li"><a href="01.html#files">Files</a></div></li>
<li class="level4"><div class="li"><a href="01.html#task_0_-_setting_up_the_environment">Task 0 - Setting up the environment</a></div></li>
<li class="level4"><div class="li"><a href="01.html#task_1_-_creating_and_running_a_virtual_device">Task 1 - Creating and running a virtual device</a></div></li>
<li class="level4"><div class="li"><a href="01.html#task_2_-_use_adb_to_transfer_files_and_install_apps">Task 2 - Use ADB to transfer files and install apps</a></div></li>
<li class="level4"><div class="li"><a href="01.html#task_3_-_create_and_run_an_application">Task 3 - Create and run an application</a></div></li>
<li class="level4"><div class="li"><a href="01.html#task_4_-_add_a_button">Task 4 - Add a button</a></div></li>
<li class="level4"><div class="li"><a href="01.html#task_5_-_use_logcat_for_debugging">Task 5 - Use logcat for debugging</a></div></li>
<li class="level4"><div class="li"><a href="01.html#task_6_-_view_weight">Task 6 - View weight</a></div></li>
<li class="level4"><div class="li"><a href="01.html#task_7_-_multiple_resources">Task 7 - Multiple resources</a></div></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h2 class="sectionedit1" id="android_technology">01. Android Technology</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> Description: General overview of the Android <abbr title="Operating System">OS</abbr>, layers and tools</div>
</li>
<li class="level1"><div class="li"> Practical part: Android tools, emulators, ADB, Beacon Mountain</div>
</li>
</ul>

</div>
<!-- EDIT1 SECTION "01. Android Technology" [1-175] -->
<h3 class="sectionedit2" id="lecture">Lecture</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"><a href="../../../../_media/ndk/courses/lecture-1.pdf" class="media mediafile mf_pdf" title="ndk:courses:lecture-1.pdf (1.9 MB)"> Lecture Slides</a></div>
</li>
</ul>

<p>
<iframe title="" src="../../../../_media/ndk/courses/lecture-1.pdf" style="width:98%; height:400px"></iframe>
</p>

</div>
<!-- EDIT2 SECTION "Lecture" [176-318] -->
<h3 class="sectionedit3" id="practical">Practical</h3>
<div class="level3">

</div>

<h4 id="resources">Resources</h4>
<div class="level4">
<ul>
<li class="level1"><div class="li"> Intel Beacon Mountain Beta for Android: <a href="http://software.intel.com/en-us/vcsource/tools/beaconmountain" class="urlextern" title="http://software.intel.com/en-us/vcsource/tools/beaconmountain"  rel="nofollow">http://software.intel.com/en-us/vcsource/tools/beaconmountain</a></div>
</li>
<li class="level1"><div class="li"> Eclipse: <a href="https://www.eclipse.org/" class="urlextern" title="https://www.eclipse.org/"  rel="nofollow">https://www.eclipse.org/</a></div>
</li>
<li class="level1"><div class="li"> Android Developer Tools Eclipse Plugin: <a href="http://developer.android.com/sdk/installing/installing-adt.html" class="urlextern" title="http://developer.android.com/sdk/installing/installing-adt.html"  rel="nofollow">http://developer.android.com/sdk/installing/installing-adt.html</a></div>
</li>
<li class="level1"><div class="li"> Android SDK: <a href="https://developer.android.com/sdk/index.html" class="urlextern" title="https://developer.android.com/sdk/index.html"  rel="nofollow">https://developer.android.com/sdk/index.html</a></div>
</li>
<li class="level1"><div class="li"> Android NDK: <a href="https://developer.android.com/tools/sdk/ndk/index.html" class="urlextern" title="https://developer.android.com/tools/sdk/ndk/index.html"  rel="nofollow">https://developer.android.com/tools/sdk/ndk/index.html</a></div>
</li>
<li class="level1"><div class="li"> Android Developers: <a href="https://developer.android.com/index.html" class="urlextern" title="https://developer.android.com/index.html"  rel="nofollow">https://developer.android.com/index.html</a></div>
</li>
</ul>

</div>

<h4 id="files">Files</h4>
<div class="level4">

<p>
<a href="../../../../_media/ndk/courses/lab-1.zip" class="media mediafile mf_zip" title="ndk:courses:lab-1.zip (860.3 KB)">lab-1.zip</a>
</p>

</div>

<h4 id="task_0_-_setting_up_the_environment">Task 0 - Setting up the environment</h4>
<div class="level4">

<p>
This section is meant you help you set up your environment at home. All links are found in the resources.
</p>

<p>
There are two ways of setting up your environment. The first way is using Intel&#039;s Beacon Mountain for Android solution. This sets up your whole environment including SDK and NDK and contains some additional profiling tools and HAXM, needed for virtualizing Intel Atom based virtual devices. Run the installer and follow the steps.
</p>

<p>
The second way will set up the bare minimum needed for creating an NDK project.
</p>
<ol>
<li class="level1"><div class="li"> Download the Android SDK and NDK and extract them in convenient locations</div>
</li>
<li class="level1"><div class="li"> Install Eclipse</div>
</li>
<li class="level1"><div class="li"> Install the ADT plugin for Eclipse (see tutorial in link provided), provide the location of the SDK when asked</div>
</li>
<li class="level1"><div class="li"> Setup up the Android SDK: Open the SDK Manager by clicking <strong>Window &gt; Android SDK Manager</strong> on Eclipse&#039;s menu bar.</div>
</li>
<li class="level1"><div class="li"> Select the latest versions of Android SDK Tools, Android SDK Platform-tools, Android SDK Build-tools</div>
</li>
<li class="level1"><div class="li"> Select everything in Android 4.4.2 (<abbr title="Application Programming Interface">API</abbr> Level 19) through Android 4.2.2 (<abbr title="Application Programming Interface">API</abbr> Level 17) (you can skip the sources if you want)</div>
</li>
<li class="level1"><div class="li"> For x86 virtualization support on Windows, install Intel HAXM on Debian based systems you need to install the following packages: qemu-kvm, libvirt-bin, bridge-utils and ubuntu-vm-builder or debian-vm-builder</div>
</li>
</ol>

</div>

<h4 id="task_1_-_creating_and_running_a_virtual_device">Task 1 - Creating and running a virtual device</h4>
<div class="level4">

<p>
Create a virtual device in Eclipse:
</p>
<ol>
<li class="level1"><div class="li"> Click <strong>Window &gt; Android Virtual Device Manager</strong> from Eclipse&#039;s menu bar</div>
</li>
<li class="level1"><div class="li"> Select <strong>New</strong></div>
</li>
<li class="level1"><div class="li"> Name your device</div>
</li>
<li class="level1"><div class="li"> Select a device from the list: these are predetermined settings for resolution, available RAM and VM Heap (Maximum Dalvik Heap). You can define your device in <strong>Device Definitions</strong> tab, in the <strong>Android Virtual Device Manager</strong> window, but it&#039;s not required.</div>
</li>
<li class="level1"><div class="li"> Give the device 512-1024 MBs of RAM and 64 <abbr title="Megabyte">MB</abbr> VM Heap</div>
</li>
<li class="level1"><div class="li"> Select Android 4.4.2 as the target</div>
</li>
<li class="level1"><div class="li"> Select Intel Atom x86 under CPU/ABI</div>
</li>
<li class="level1"><div class="li"> Give the device and 100 <abbr title="Megabyte">MB</abbr> SD Card</div>
</li>
<li class="level1"><div class="li"> You can select Use Host GPU</div>
</li>
</ol>

<p>
On Windows, if HAXM service is started, Android Virtual Devices will run virtualized.
</p>

<p>
On Linux you either set it up in Eclipse, or a per project basis:
</p>
<ol>
<li class="level1"><div class="li"> Click <strong>Run &gt; Run configurations</strong> from Eclipse&#039;s menu bar</div>
</li>
<li class="level1"><div class="li"> Under <strong>Android Application</strong> select your project</div>
</li>
<li class="level1"><div class="li"> Select the <strong>Target</strong> tab</div>
</li>
<li class="level1"><div class="li"> In the <strong>Emulator launch parameters</strong> pane, add as additional parameters: -qemu -enable-kvm</div>
</li>
</ol>

<p>
 Or you can start the device using the following command:
</p>
<pre class="code">emulator64-x86 -avd &lt;device_name&gt; -gpu on -qemu -enable-kvm</pre>

<p>
If you receive an error related to OpenGLES emulation library you need to add the location of the library to the LD_LIBRARY_PATH variable. The library is located in SDK_DIRECTORY/tools/lib/. Or you can remove the <strong>-gpu on</strong> parameter if your application does not require complex graphical features.
</p>

</div>

<h4 id="task_2_-_use_adb_to_transfer_files_and_install_apps">Task 2 - Use ADB to transfer files and install apps</h4>
<div class="level4">

<p>
After the device boots, you can connect to it using ADB. ADB can be used from a terminal on all operating systems.
To get a list of connected devices use can use:
</p>
<pre class="code">adb devices</pre>

<p>
To get a shell on the connected device use:
</p>
<pre class="code">adb shell</pre>

<p>
Android devices normally come with a more limited set of commands, so a text editor might not be available.
</p>

<p>
Create a text file on your machine. Copy it to the connected device using:
</p>
<pre class="code">adb push &lt;local&gt; &lt;remote&gt;</pre>

<p>
The file should be copied to the /sdcard/ partition on the phone. Connect to the device using adb shell, and use cat to check the contents of the file.
To copy from the device use:
</p>
<pre class="code">adb pull &lt;remote&gt; [&lt;local&gt;]</pre>

<p>
Both push and pull can be used with both directories and files.
</p>

<p>
To install an application through adb use:
</p>
<pre class="code">adb install &lt;file&gt;</pre>

<p>
Install LogLevel.apk (in the laboratory archive).
</p>

<p>
To check all available options of the ADB use:
</p>
<pre class="code">adb --help</pre>

</div>

<h4 id="task_3_-_create_and_run_an_application">Task 3 - Create and run an application</h4>
<div class="level4">

<p>
Create a new Android Project in Eclipse (<strong>File &gt; New Android Application</strong>). Choose a name and leave other options as they are. On the next screen make sure <strong>Create activity</strong> is checked and <strong>Mark project as library</strong> is not. Create an icon if you checked the option, and then choose <strong>Blank Activity</strong> when prompted to.
</p>

<p>
This creates an application with a single activity.
</p>

<p>
Optional: If using Linux, set qemu parameters to enable virtualization like in Task 1.
</p>

<p>
Run the project. Eclipse will prompt you to choose a device. Select the device created previously. This will launch the emulator, if it is not already started, and after it boots up the new application should start as well.
</p>

</div>

<h4 id="task_4_-_add_a_button">Task 4 - Add a button</h4>
<div class="level4">

<p>
The MainActivity.java file should be displayed. If not, open it using the <strong>Package Explorer</strong> pane. You will find it in the <strong>src</strong> folder.
</p>

<p>
The Activity should be very simple. It has an onCreate method which gets called when the Activity gets started and an onCreateOptionsMenu method which creates the dropdown menu.
</p>

<p>
In the onCreate method the Activity calls
</p>
<pre class="code">setContentView(R.layout.activity_main);</pre>

<p>
This sets the layout for the Activity. R is a class generated by the SDK and it maps every resource to a number. It contains subclasses for every folder found in the <strong>res</strong> folder, in this case <strong>layout</strong>.
Open the res/layout/activity_main.xml file. You will see the layout editor. In the <strong>Palette</strong> pane, find the button, and drag it to the activity. You will see the <strong>Outline</strong> pane to the right of the screen change to reflect this. Select the button and check its id field in the <strong>Properties</strong> panel, under the list of UI elements. Change the text of the button to “Press me!”. Also check the id field of the TextView element.
</p>

<p>
Go back to MainActivity.java.
</p>

<p>
Add the following code to the onCreate method. Make sure the ids match the ones in your layout.
</p>
<pre class="code Java">        <span class="kw1">final</span> <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+button"><span class="kw3">Button</span></a> b1 <span class="sy0">=</span> <span class="br0">&#40;</span><a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+button"><span class="kw3">Button</span></a><span class="br0">&#41;</span> findViewById<span class="br0">&#40;</span>R.<span class="me1">id</span>.<span class="me1">button1</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="kw1">final</span> TextView tv1 <span class="sy0">=</span> <span class="br0">&#40;</span>TextView<span class="br0">&#41;</span> findViewById<span class="br0">&#40;</span>R.<span class="me1">id</span>.<span class="me1">textView1</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
        b1.<span class="me1">setOnClickListener</span><span class="br0">&#40;</span><span class="kw1">new</span> OnClickListener<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        	<span class="kw4">int</span> n <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">;</span>
&nbsp;
		@Override
		<span class="kw1">public</span> <span class="kw4">void</span> onClick<span class="br0">&#40;</span><a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+view"><span class="kw3">View</span></a> v<span class="br0">&#41;</span> <span class="br0">&#123;</span>
			tv1.<span class="me1">setText</span><span class="br0">&#40;</span><span class="st0">&quot;Hello again! &quot;</span> <span class="sy0">+</span> <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocs.oracle.com+javase+docs+api+integer"><span class="kw3">Integer</span></a>.<span class="me1">toString</span><span class="br0">&#40;</span>n<span class="sy0">++</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
		<span class="br0">&#125;</span>
	<span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
This gets the references to both the Button you added and the TextView that was already declared. They are declared final so they can be visible inside the new OnClickListener. The OnClickListener objects contains an onClick method which gets executed when the button is pressed. In this case, it updates the TextView to reflect the number of clicks on the button.
</p>

</div>

<h4 id="task_5_-_use_logcat_for_debugging">Task 5 - Use logcat for debugging</h4>
<div class="level4">

<p>
Start the application installed in Task 2. Make sure the <strong>Logcat</strong> tab is the one selected in the panel at the bottom. Type any text in the box and then click one of the buttons. A new line containing your text should appear in the <strong>Logcat</strong>. Depending on what button you press, the line colour will vary. It is also possible to filter these log entries: above the logs themselves there is a text entry input which allows textual filtering. It allows you to limit scope by prefixing searches with pid:, tag:, app: or text: and it accepts Java-style regular expressions. To the right of this text field there is a dropdown which allows you to select verbosity. Choosing a level will only allow messages of that level or higher to be displayed.
</p>

<p>
Import the LogLevel project into Eclipse (<strong>File &gt; Import</strong> and select <strong>General &gt; Existing project into workspace</strong>). Look over the code. Each button has a method attached which calls a static method from the Log class. These methods generate log entries on different levels of importance: d=debug, i=info, w=warning, e=error.
</p>

<p>
Add another two buttons to the application: one that generates an assert level log entry, and one that repeats the previously generated log entry, but with a higher level of importance, except in the case of assert, which will remain the same.
</p>

</div>

<h4 id="task_6_-_view_weight">Task 6 - View weight</h4>
<div class="level4">

<p>
Use the LogLevel project as a start. Notice that the EditText box only takes up one line of the screen and there should be some screen space left at the bottom of the screen. Make the EditText box take up all available space. To do this, you should set the weight parameter of the EditText view to 1 (or any integer).
</p>

<p>
The weight parameter is used to distribute empty screen space to the elements which need it. First, the layout builder will place all the elements for which the size is easy to determine. Then, the empty space will be distributed to the elements with weight, based on their weight: if the total weight of all elements is 4, an element with a weight of 1 will get 1/4 of the empty screen space, an element with 2 weight will get 2/4, and so on.
</p>

</div>

<h4 id="task_7_-_multiple_resources">Task 7 - Multiple resources</h4>
<div class="level4">

<p>
In Android you can have multiple resources with the same ID. This allows building a single application for all the languages, screen resolutions or formats, and have the system select the correct resource when running the application.
</p>

<p>
In the LogLevel project, notice that there is a single <strong>layout</strong> folder. Modify this layout to fit two screen densities: mdpi and hdpi. To do this, rename the folder <strong>layout</strong> to <strong>layout-hdpi</strong> and make a copy of it named <strong>layout-mdpi</strong>. This will allow the system to select the mdpi layout for systems with medium dpi or lower, and the hdpi layout for the rest. Modify the mdpi layout to display the buttons on two columns instead of a single button on each row. Use multiple horizontal LinearLayouts.
</p>

</div>
<!-- EDIT3 SECTION "Practical" [319-] --></div>
</body>
</html>
