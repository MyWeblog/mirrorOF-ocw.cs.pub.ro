    
    

<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <title>programare:laboratoare:lab12</title>
<meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="date" content="2016-10-05T15:05:00+0300"/>
<meta name="keywords" content="programare,laboratoare,lab12"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../../../lib/exe/opensearch.php" title="CS Open CourseWare"/>
<link rel="start" href="../../../../../courses.1.html"/>
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="../../../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="../../../../feed.php%3Fmode=list&amp;ns=programare:laboratoare"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="lab12.html"/>
<link rel="canonical" href="../../../../programare/laboratoare/lab12.html"/>
<link rel="stylesheet" type="text/css" href="../../../../lib/exe/css.php%3Ft=arctic&amp;tseed=1476798676.css"/>
<script type="text/javascript">/*<![CDATA[*/var NS='programare:laboratoare';var JSINFO = {"id":"programare:laboratoare:lab12","namespace":"programare:laboratoare","isadmin":0,"isauth":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../../../lib/exe/js.php%3Ftseed=1476798676"></script>
<script type="text/x-mathjax-config">/*<![CDATA[*/MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ["$","$"], ["\\(","\\)"] ],
        displayMath: [ ["$$","$$"], ["\\[","\\]"] ],
        processEscapes: true
    }
});
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<script type="text/javascript">/*<![CDATA[*/
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
		  
/*!]]>*/</script>
<script type="text/javascript">/*<![CDATA[*/
var pageTracker = _gat._getTracker("UA-38383934-1");
pageTracker._initData();
pageTracker._trackPageview();
		  
/*!]]>*/</script>
</head>
<body>
<div class="dokuwiki export">
<!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level2"><div class="li"><a href="lab12.html#parametrii_liniei_de_comanda_preprocesorul_functii_cu_numar_variabil_de_parametri">Parametrii liniei de comandă. Preprocesorul. Funcţii cu număr variabil de parametri.</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="lab12.html#obiective">Obiective</a></div></li>
<li class="level3"><div class="li"><a href="lab12.html#parametrii_liniei_de_comanda">Parametrii liniei de comandă</a></div></li>
<li class="level3"><div class="li"><a href="lab12.html#preprocesorul">Preprocesorul</a></div>
<ul class="toc">
<li class="level4"><div class="li"><a href="lab12.html#incluziune">Incluziune</a></div></li>
<li class="level4"><div class="li"><a href="lab12.html#definirea_de_simboluri">Definirea de simboluri</a></div></li>
<li class="level4"><div class="li"><a href="lab12.html#definirea_de_macro-uri">Definirea de macro-uri</a></div></li>
</ul>
</li>
<li class="level3"><div class="li"><a href="lab12.html#instructiuni_de_compilare_conditionata">Instrucţiuni de compilare condiţionată</a></div>
<ul class="toc">
<li class="level4"><div class="li"><a href="lab12.html#alte_instructiuni">Alte instrucţiuni</a></div></li>
</ul>
</li>
<li class="level3"><div class="li"><a href="lab12.html#functii_cu_numar_variabil_de_parametri">Funcţii cu număr variabil de parametri</a></div>
<ul class="toc">
<li class="level4"><div class="li"><a href="lab12.html#introducere">Introducere</a></div></li>
<li class="level4"><div class="li"><a href="lab12.html#definirea_functiilor_cu_numar_variabil_de_parametri">Definirea funcţiilor cu număr variabil de parametri</a></div></li>
<li class="level4"><div class="li"><a href="lab12.html#implementarea_functiilor_cu_numar_variabil_de_parametri">Implementarea funcţiilor cu număr variabil de parametri</a></div></li>
</ul>
</li>
<li class="level3"><div class="li"><a href="lab12.html#exercitii_de_laborator">Exerciţii de Laborator</a></div></li>
<li class="level3"><div class="li"><a href="lab12.html#bonus">Bonus</a></div></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h2 class="sectionedit1" id="parametrii_liniei_de_comanda_preprocesorul_functii_cu_numar_variabil_de_parametri">Parametrii liniei de comandă. Preprocesorul. Funcţii cu număr variabil de parametri.</h2>
<div class="level2">

<p>
<strong>Responsabil:</strong>
</p>
<ul>
<li class="level1"><div class="li"> <a href="mailto:&#x6d;&#x69;&#x68;&#x61;&#x65;&#x6c;&#x61;&#x2e;&#x76;&#x61;&#x73;&#x69;&#x6c;&#x65;&#x40;&#x67;&#x6d;&#x61;&#x69;&#x6c;&#x2e;&#x63;&#x6f;&#x6d;" class="mail" title="&#x6d;&#x69;&#x68;&#x61;&#x65;&#x6c;&#x61;&#x2e;&#x76;&#x61;&#x73;&#x69;&#x6c;&#x65;&#x40;&#x67;&#x6d;&#x61;&#x69;&#x6c;&#x2e;&#x63;&#x6f;&#x6d;">Mihaela Vasile (2015)</a></div>
</li>
</ul>

</div>
<!-- EDIT1 SECTION "Parametrii liniei de comandă. Preprocesorul. Funcţii cu număr variabil de parametri." [1-174] -->
<h3 class="sectionedit2" id="obiective">Obiective</h3>
<div class="level3">

<p>
În urma parcurgerii acestui laborator, studentul va fi capabil:
</p>
<ul>
<li class="level1"><div class="li"> să interpreteze şi să manipuleze parametrii liniei de comandă</div>
</li>
<li class="level1"><div class="li"> să scrie programe care comunică cu exteriorul (utilizatorul, sistemul de operare, alte programe) prin intermediul parametrilor liniei de comandă</div>
</li>
<li class="level1"><div class="li"> să scrie şi să folosească macrodefiniţii</div>
</li>
<li class="level1"><div class="li"> să utilizeze macrodefiniţiile în lucrul cu mai multe fişiere</div>
</li>
<li class="level1"><div class="li"> să evite erorile care apar frecvent în lucrul cu macrodefiniţii</div>
</li>
<li class="level1"><div class="li"> să realizeze funcţii care primesc un număr variabil de parametri</div>
</li>
<li class="level1"><div class="li"> să folosească macroinstrucţiunile necesare manipulării stivei de parametri a unei funcţii cu număr variabil de parametri</div>
</li>
</ul>

</div>
<!-- EDIT2 SECTION "Obiective" [175-877] -->
<h3 class="sectionedit3" id="parametrii_liniei_de_comanda">Parametrii liniei de comandă</h3>
<div class="level3">

<p>
Pentru a controla execuţia unui program, de multe ori este de dorit furnizarea datelor de lucru înaintea lansării în execuţie a programului, acesta urmând să se execute apoi fără intervenţia utilizatorului (aşa-numitul „batch mode”). Acest lucru se realizează prin intermediul parametrilor liniei de comandă. (Un exemplu cunoscut este lansarea compilatorului gcc în linia de comandă cu diverse argumente, care îi spun ce şi cum sa compileze.)
</p>

<p>
Din punct de vedere al utilizatorului, parametrii liniei de comandă sunt simple argumente care se adaugă după numele unui program, în linia de comandă, la rularea sa. Elementele acestei liste de argumente sunt şiruri de caractere separate de spaţii. Argumentele care conţin spaţii pot fi conbinate într-un singur argument prin inchiderea acestuia între ghilimele. Shell-ul este cel care se ocupă de parsarea liniei de comandă şi de crearea listei de argumente.
</p>

<p>
Exemplu de apelare a unui program cu argumente în linia de comandă:
</p>
<pre class="code bash"><span class="kw2">gcc</span> <span class="re5">-Wall</span> -I<span class="sy0">/</span>usr<span class="sy0">/</span>include<span class="sy0">/</span>sys <span class="re5">-DDEBUG</span> <span class="re5">-o</span> <span class="st0">&quot;My Shell&quot;</span> myshell.c</pre>

<p>
În acest caz, argumentele liniei de comandă sunt în acest caz:
</p>
<ul>
<li class="level1"><div class="li"> gcc</div>
</li>
<li class="level1"><div class="li"> -Wall</div>
</li>
<li class="level1"><div class="li"> -I/usr/include/sys</div>
</li>
<li class="level1"><div class="li"> -DDEBUG</div>
</li>
<li class="level1"><div class="li"> -o</div>
</li>
<li class="level1"><div class="li"> My Shell</div>
</li>
<li class="level1"><div class="li"> myshell.c</div>
</li>
</ul>

<p>
Din punct de vedere al programatorului, parametrii liniei de comandă sunt accesibili prin utilizarea parametrilor funcţiei main(). Astfel, când se doreşte folosirea argumentelor liniei de comandă, funcţia main() se va defini astfel:
</p>
<pre class="code c"><span class="kw4">int</span> main<span class="br0">&#40;</span><span class="kw4">int</span> argc<span class="sy0">,</span> <span class="kw4">char</span> <span class="sy0">*</span>argv<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span></pre>

<p>
Astfel, funcţia <strong>main()</strong> primeşte, în mod formal, doi parametri, un întreg şi un vector de şiruri de caractere. Numele celor două variabile nu e obligatoriu să fie <strong>argc</strong> şi <strong>argv</strong>, dar tipul lor, da. Semnificaţia lor este următoarea:
</p>
<ul>
<li class="level1"><div class="li"> <strong>int argc</strong> (argument count) - reprezintă numărul de parametrii ai liniei de comandă. După cum se vede din exemplul anterior, există cel puţin un parametru, acesta fiind chiar numele programului (numele care a fost folosit pentru a lansa în execuţie programul - şi care poate fi diferit de numele executabilului - de exemplu prin crearea unui symlink, în Linux).</div>
</li>
<li class="level1"><div class="li"> <strong>char *argv[]</strong> (arguments value) - reprezintă un vector de şiruri de caractere, având <strong>argc</strong> elemente (indexate de la <strong>0</strong> la <strong>argc - 1</strong>). Întotdeauna <strong>argv[0]</strong> conţine numele programului.</div>
</li>
</ul>

<p>
Parametrii liniei de comandă se pot accesa prin intermediul vectorului <strong>argv</strong> şi pot fi prelucraţi cu funcţiile standard de prelucrare a şirurilor de caractere.
</p>

</div>
<!-- EDIT3 SECTION "Parametrii liniei de comandă" [878-3461] -->
<h3 class="sectionedit4" id="preprocesorul">Preprocesorul</h3>
<div class="level3">

<p>
Preprocesorul este componenta din cadrul compilatorului C care realizează preprocesarea. În urma acestui pas, toate instrucţiunile de preprocesare sunt înlocuite (substituite), pentru a genera cod C „pur”. Preprocesarea este o prelucrare exclusiv textuală a fişierului sursă. În acest pas nu se fac nici un fel de verificări sintactice sau semantice asupra codului sursă, ci doar sunt efectuate substituţiile din text. Astfel, preprocesorul va prelucra şi fişiere fără nici un sens în C.
</p>

<p>
Se consideră următorul exemplu:
</p>
<pre class="code language="c"">#define EA Ana
#define si C
#ifdef CIFRE
#define CINCI 5
#define DOUA 2
EA are mere. Mara are DOUA pere shi CINCI cirese.
#endif
Vasilica vrea sa cante o melodie in si bemol.</pre>

<p>
La rularea comenzii
</p>
<pre class="code">gcc -E -DCIFRE rubbish.c</pre>

<p>
se va obţine următoare ieşire (se cere compilatorului să execute doar pasul de preprocesare (-E), definind în acelaşi timp şi simbolul CIFRE (-DCIFRE) :
</p>
<pre class="code language="c""># 1 &quot;rubbish.c&quot;
# 1 &quot;&lt;built-in&gt;&quot;
# 1 &quot;&lt;command line&gt;&quot;
# 1 &quot;rubbish.c&quot;
Ana are mere. Mara are 2 pere shi 5 cirese.
Vasilica vrea sa cante o melodie in C bemol.</pre>

<p>
Cele mai importante instrucţiuni de preprocesare sunt prezentate în continuare.
</p>

</div>

<h4 id="incluziune">Incluziune</h4>
<div class="level4">

<p>
Probabil cea mai des folosită instrucţiune de preprocesare este cea de incluziune, de forma
</p>
<pre class="code language="c"">#include &lt;nume_fişier&gt;</pre>

<p>
sau
</p>
<pre class="code language="c"">#include &quot;nume_fisier&quot;</pre>

<p>
care are ca rezultat înlocuirea sa cu conţinutul fişierului specificat de <strong>nume_fişier</strong>. Diferenţa dintre cele două versiuni este că cea cu paranteze unghiulare caută <strong>nume_fişier</strong> doar în directorul standard de fişiere antet (numit deobicei <strong>include</strong>), iar cea cu ghilimele caută atât în directorul <strong>include</strong> cât şi în directorul curent.
</p>

</div>

<h4 id="definirea_de_simboluri">Definirea de simboluri</h4>
<div class="level4">

<p>
Definirea de simboluri este cel mai des folosită în conjuncţie cu instrucţiunile de procesare condiţionată, fiind folosită pentru activarea şi dezactivarea unor segmente de cod în funcţie de prezenţa unor simboluri. Definirea unui simbol se face în cod cu instrucţiunea
</p>
<pre class="code language="c"">#define SIMBOL</pre>

<p>
sau se poate realiza şi la compilare, prin folosirea flagului -D al compilatorului (după cum am văzut în exemplul precedent).
</p>

<p>
Un simbol poate fi de asemenea „şters” folosind instrucţiunea
</p>
<pre class="code language="c"">#undef SIMBOL</pre>

<p>
în cazul în care nu se mai doreşte prezenţa simbolului de preprocesor ulterior definirii sale.
</p>

</div>

<h4 id="definirea_de_macro-uri">Definirea de macro-uri</h4>
<div class="level4">

<p>
Instrucţiunile de preprocesare mai pot fi folosite şi pentru definirea de constante simbolice şi macroinstrucţiuni. De exemplu
</p>
<pre class="code language="c"">#define CONSTANTA valoare</pre>

<p>
va duce la înlocuirea peste tot în cadrul codului sursă a şirului <strong>CONSTANTA</strong> cu şirul <strong>valoare</strong>. Înlocuirea nu se face totuşi în interiorul şirurilor de caractere.
</p>

<p>
O macroinstrucţiune este similară unei constante simbolice, ca definire, dar acceptă parametrii. Este folosită în program în mod asemănător unei funcţii, dar la compilare, ea este înlocuită în mod textual cu corpul ei. În plus, nu se face nici un fel de verificare a tipurilor. Spre exemplu:
</p>
<pre class="code language="c"">#define MAX(a, b) a &gt; b ? a : b</pre>

<p>
va returna maximul dintre a şi b, iar
</p>
<pre class="code language="c"">#define DUBLU(a) 2*a</pre>

<p>
va returna dublul lui a.
</p>

<p>
<p><div class="noteimportant">
Deoarece preprocesarea este o prelucrare textuală a codului sursă, în cazul exemplului de mai sus, macroinstrucţiunea în forma prezentată nu va calcula întotdeauna dublul unui număr.

</div></p>
</p>

<p>
Astfel, la un apel de forma:
</p>
<pre class="code language="c"">DUBLU(a + 3)</pre>

<p>
în pasul de preprocesare se va genera expresia
</p>
<pre class="code language="c"">2*a+3</pre>

<p>
care bineînţeles că nu realizează funcţia dorită.
</p>

<p>
Pentru a evita astfel de probleme, este bine ca întotdeauna în corpul unui macro, numele „parametrilor” să fie închise între paranteze (ca de exemplu:)
</p>
<pre class="code language="c"">#define SQUARE(a) (a)*(a)</pre>

</div>
<!-- EDIT4 SECTION "Preprocesorul" [3462-7528] -->
<h3 class="sectionedit5" id="instructiuni_de_compilare_conditionata">Instrucţiuni de compilare condiţionată</h3>
<div class="level3">

<p>
Instrucţiunile de compilare condiţionată sunt folosite pentru a „ascunde” fragmente de cod în funcţie de anumite condiţii. Formatul este următorul:
</p>
<pre class="code language="c"">#if conditie
....
#else
....
#endif</pre>

<p>
unde conditie este este o expresie constantă întreagă. Pentru realizarea de expresii cu mai multe
opţiuni se poate folosi şi forma <strong>#elif</strong>:
</p>
<pre class="code language="c"">#if conditie
...
#elif conditie2
...
#elif conditie3
...
#else
...
#endif</pre>

<p>
De obicei condiţia testează existenţa unui simbol. Scenariile tipice de folosire sunt:
</p>
<ul>
<li class="level1"><div class="li"> dezactivarea codului de debug o dată ce problemele au fost remediate</div>
</li>
<li class="level1"><div class="li"> compilare condiţionată în funcţie de platforma de rulare</div>
</li>
<li class="level1"><div class="li"> prevenirea includerii multiple a fişierelor antet</div>
</li>
</ul>

<p>
În aceste cazuri se foloseşte forma
</p>
<pre class="code language="c"">#ifdef SIMBOL</pre>

<p>
sau
</p>
<pre class="code language="c"">#ifndef SIMBOL</pre>

<p>
care testează dacă simbolul SIMBOL este definit, respectiv nu este definit.
</p>

<p>
Prevenirea includerii multiple a fişierelor antet se realizează astfel:
</p>
<pre class="code language="c"">#ifndef _NUME_FISIER_ANTET_
#define _NUME_FISIER_ANTET_
  /* corpul fisierului antet */
  /* prototipuri de functii, declaratii de tipuri si de constante */
#endif</pre>

<p>
Astfel, la prima includere a fişierului antet, simbolul <strong>_NUME_FISIER_ANTET_</strong> nu este definit. Preprocesorul execută ramura <strong>#ifndef</strong> în care este definit simbolul <strong>_NUME_FISIER_ANTET_</strong> şi care conţine şi corpul - conţinutul util - al fişierului antet. La următoarele includeri ale fişierului antet simbolul <strong>_NUME_FISIER_ANTET_</strong> va fi definit iar preprocesorul va sări direct la sfârşitul fişierului antet, după <strong>#endif</strong>.
</p>

</div>

<h4 id="alte_instructiuni">Alte instrucţiuni</h4>
<div class="level4">
<pre class="code language="c"">#pragma expresie</pre>

<p>
Sunt folosite pentru a controla din codul sursă comportamentul compilatorului (modul în care generează cod, alinierea structurilor, etc.) iar formatul lor diferă de la compilator la compilator. Pentru a determina ce opţiuni <strong>#pragma</strong> aveţi la dispoziţie consultaţi manualul compilatorului.
</p>
<pre class="code language="c"">#error MESSAGE</pre>

<p>
La întâlnirea acestei instrucţiuni de preprocesare compilatorul va raporta o eroare, având ca text explicativ mesajul <strong>MESSAGE</strong>.
</p>
<pre class="code language="c"">#line NUMBER FILENAME</pre>

<p>
Această instrucţiune de preprocesare modifică numărul liniei curente în valoarea specificată de <strong>NUMBER</strong>. În cazul în care este prezent şi parametru opţional <strong>FILENAME</strong> este modificat şi numele fişierului sursă curent. Astfel, mesajele de eroare şi avertismentele produse de compilator vor folosi numere de linie (şi eventual nume de fişiere) inexistente, „imaginare”, conform acestei instrucţiuni.
</p>

</div>
<!-- EDIT5 SECTION "Instrucţiuni de compilare condiţionată" [7529-10289] -->
<h3 class="sectionedit6" id="functii_cu_numar_variabil_de_parametri">Funcţii cu număr variabil de parametri</h3>
<div class="level3">

</div>

<h4 id="introducere">Introducere</h4>
<div class="level4">

<p>
Marea majoritate a funcţiilor discutate până acum şi totalitatea funcţiilor realizate în cadrul laboratorului
până în acest moment primeau ca parametrii un număr prestabilit de parametrii, de tipuri bine
precizate. Acest lucru se datorează faptului că limbajul C este un limbaj <a href="http://en.wikipedia.org/wiki/Strongly-typed_programming_language" class="urlextern" title="http://en.wikipedia.org/wiki/Strongly-typed_programming_language"  rel="nofollow">strong-typed</a>. În cele mai multe cazuri acesta este un aspect pozitiv întrucât compilatorul va sesiza de la compilare situaţiile în care se încearcă pasarea unui număr eronat de parametrii sau a unor parametrii de tipuri necorespunzătoare.
</p>

<p>
Limbajul C permite totuşi şi declararea şi folosirea funcţiilor cu un număr (şi eventual tip) variabil de
parametri. Astfel, numărul şi tipul tuturor parametrilor va fi cunoscut doar la rulare, biblioteca standard
C punând la dispoziţie o serie de definiţii de tipuri şi macro definiţii care permit parcurgerea listei de
parametri a unei funcţii cu număr variabil de parametri. Exemplul cel mai comun de astfel de funcţii
sunt funcţiile din familia <strong>printf()</strong>, <strong>scanf()</strong>.
</p>

</div>

<h4 id="definirea_functiilor_cu_numar_variabil_de_parametri">Definirea funcţiilor cu număr variabil de parametri</h4>
<div class="level4">

<p>
Prototipul funcţiilor cu număr variabil de parametrii arată în felul următor:
</p>
<pre class="code c">tip_rezultat nume_funcţie<span class="br0">&#40;</span>listă_parametrii_fixaţi<span class="sy0">,</span> ...<span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
Notaţia <strong>„ ,… ”</strong> comunică compilatorului faptul că funcţia poate primi un număr arbitrar de parametrii
începând cu poziţia în care apare. De exemplu, prototipul funcţiei <strong>fprintf()</strong> arată în felul următor:
</p>
<pre class="code c"><span class="kw4">void</span> <a href="http://www.opengroup.org/onlinepubs/009695399/functions/fprintf.html"><span class="kw3">fprintf</span></a><span class="br0">&#40;</span>FILE<span class="sy0">*,</span> <span class="kw4">const</span> <span class="kw4">char</span><span class="sy0">*,</span> ...<span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
Astfel, funcţia <strong>fprintf()</strong> trebuie să primească un pointer la o structură <strong>FILE</strong> şi un string de format şi eventual mai poate primi 0 sau mai multe argumente. Modul în care ele vor fi interpretate fiind
determinat în cazul de faţă de conţinutul variabilei de tip <strong>const char</strong>* (acesta este motivul pentru care pot apărea erori la rulare în condiţiile în care încercăm să tipărim un număr întreg cu <strong>%s</strong> ).
</p>

<p>
<p><div class="noteimportant">
O funcţie cu număr variabil de parametrii trebuie să aibă cel puţin un parametru fixat, cu nume (motivul acestei limitări rezidă în modalitatea de implementare a funcţiilor cu număr variabil de parametri, după cum se va vedea în paragraful următor).

</div></p>
</p>

</div>

<h4 id="implementarea_functiilor_cu_numar_variabil_de_parametri">Implementarea funcţiilor cu număr variabil de parametri</h4>
<div class="level4">

<p>
Pentru prelucrarea listei de parametrii variabili este necesară includerea fişierului antet <strong>stdarg.h</strong>.
Acesta conţine declaraţii pentru tipul de date variable argument list (<strong>va_list</strong>) şi o serie de macrodefiniţii
pentru manipularea unei astfel de liste. În continuare este detaliat modul de lucru cu liste variabile de
parametri.
</p>
<ul>
<li class="level1"><div class="li">  Declararea unei variabile de tip <strong>va_list</strong> (denumită de obicei <strong>args</strong>, <strong>arguments</strong>, <strong>params</strong>)</div>
</li>
<li class="level1"><div class="li">  Iniţializarea variabilei de tip <strong>va_list</strong> cu lista de parametri cu care a fost apelată funcţia se realizează cu macrodefiniţia <strong>va_start(arg_list, last_argument)</strong> unde:</div>
<ul>
<li class="level2"><div class="li"> <strong>arg_list</strong> reprezintă variabila de tip <strong>va_list</strong> prin intermediul căreia vom accesa lista de parametri a funcţiei.</div>
</li>
<li class="level2"><div class="li"> <strong>last_argument</strong> reprezintă numele ultimei variabile fixate din lista de parametri a funcţiei (în exemplul următor, aceasta este şi prima variabilă, numită <strong>first</strong>).</div>
</li>
</ul>
</li>
<li class="level1"><div class="li">  Accesarea variabilelor din lista de parametri se realizează cu macro-definiţia <strong>va_arg(arg_list, type)</strong>, unde</div>
<ul>
<li class="level2"><div class="li"> <strong>arg_list</strong> are aceeaşi semnificaţie ca mai sus.</div>
</li>
<li class="level2"><div class="li"> <strong>type</strong> este un nume de tip şi reprezintă tipul variabilei care va fi citită. La fiecare apel se avansează în listă. În cazul în care se doreşte întoarcerea în listă, aceasta trebuie reiniţializată iar elementul dorit este accesat prin apeluri succesive de <strong>va_arg()</strong></div>
</li>
</ul>
</li>
<li class="level1"><div class="li">  Eliberarea memoriei folosite de lista de parametri se realizează prin intermediul macro-definiţiei <strong>va_end(arg_list)</strong>, unde <strong>arg_list</strong> are aceeaşi semnificaţie ca mai sus.</div>
</li>
</ul>

<p>
<strong>Exemplu:</strong> Afişarea unui număr variabil de numere naturale. Lista este terminată cu un număr negativ.
</p>
<pre class="code c">  <span class="co2"># include &lt;stdio.h&gt;</span>
  <span class="co2"># include &lt;stdarg.h&gt;</span>
&nbsp;
<span class="kw4">void</span> list_ints<span class="br0">&#40;</span><span class="kw4">int</span> first<span class="sy0">,</span> ...<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="kw4">int</span> main<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
  list_ints<span class="br0">&#40;</span><span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">;</span>
  list_ints<span class="br0">&#40;</span><span class="nu0">128</span><span class="sy0">,</span> <span class="nu0">512</span><span class="sy0">,</span> <span class="nu0">768</span><span class="sy0">,</span> <span class="nu0">4096</span><span class="sy0">,</span> <span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">;</span>
  list_ints<span class="br0">&#40;</span><span class="st0">'b'</span><span class="sy0">,</span> <span class="nu12">0xC0FFEE</span><span class="sy0">,</span> <span class="nu0">10000</span><span class="sy0">,</span> <span class="nu0">200</span><span class="sy0">,</span> <span class="sy0">-</span><span class="nu0">2</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="coMULTI">/* apel corect deoarece castul la int este valid ;) */</span>
  list_ints<span class="br0">&#40;</span><span class="nu0">1</span><span class="sy0">,</span> <span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="kw1">return</span> <span class="nu0">0</span><span class="sy0">;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw4">void</span> list_ints<span class="br0">&#40;</span><span class="kw4">int</span> first<span class="sy0">,</span> ...<span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="coMULTI">/* tratam cazul special cand nu avem nici un numar (in afara de delimitator) */</span>
  <span class="kw1">if</span> <span class="br0">&#40;</span>first <span class="sy0">&lt;</span> <span class="nu0">0</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    <a href="http://www.opengroup.org/onlinepubs/009695399/functions/printf.html"><span class="kw3">printf</span></a><span class="br0">&#40;</span><span class="st0">&quot;No numbers present (besides terminator)<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">return</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
  <span class="coMULTI">/*lista de parametri*/</span>
  va_list args<span class="sy0">;</span>
  <span class="kw4">int</span> current <span class="sy0">=</span> first<span class="sy0">;</span>
  <span class="coMULTI">/* initializam lista de parametri */</span>
  <a href="http://www.opengroup.org/onlinepubs/009695399/functions/va_start.html"><span class="kw3">va_start</span></a><span class="br0">&#40;</span>args<span class="sy0">,</span> first<span class="br0">&#41;</span><span class="sy0">;</span>
  <a href="http://www.opengroup.org/onlinepubs/009695399/functions/printf.html"><span class="kw3">printf</span></a><span class="br0">&#40;</span><span class="st0">&quot;These are the numbers (excluding terminator):<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="kw1">do</span> <span class="br0">&#123;</span>
    <a href="http://www.opengroup.org/onlinepubs/009695399/functions/printf.html"><span class="kw3">printf</span></a><span class="br0">&#40;</span><span class="st0">&quot;%d &quot;</span><span class="sy0">,</span> current<span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
  <span class="coMULTI">/* parcurgem lista de parametri pana ce intalnim un numar negativ */</span>
  <span class="kw1">while</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>current <span class="sy0">=</span> <a href="http://www.opengroup.org/onlinepubs/009695399/functions/va_arg.html"><span class="kw3">va_arg</span></a><span class="br0">&#40;</span>args<span class="sy0">,</span> <span class="kw4">int</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="sy0">&gt;=</span> <span class="nu0">0</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <a href="http://www.opengroup.org/onlinepubs/009695399/functions/printf.html"><span class="kw3">printf</span></a><span class="br0">&#40;</span><span class="st0">&quot;<span class="es1">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="coMULTI">/* curatam lista de parametrii */</span>
  <a href="http://www.opengroup.org/onlinepubs/009695399/functions/va_end.html"><span class="kw3">va_end</span></a><span class="br0">&#40;</span>args<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

</div>
<!-- EDIT6 SECTION "Funcţii cu număr variabil de parametri" [10290-15398] -->
<h3 class="sectionedit7" id="exercitii_de_laborator">Exerciţii de Laborator</h3>
<div class="level3">
<ol>
<li class="level1"><div class="li"> [1p + 1p] Să se realizeze un program care să afișeze, în ordine inversă, toți parametrii primiți în linia de comandă. Fiecare parametru se va afișa pe o linie separată. Să se rezolve problema DOAR cu instructiuni repetive, apoi doar cu RECURSIVITATE.</div>
</li>
<li class="level1"><div class="li"> [2.5p] Să se realizeze un program care, în funcție de starea simbolului ASCENDING să realizeze sortarea unui șir de numere. Astfel, dacă simbolul este definit, sortarea va fi crescătoare, dacă este nedefinit, sortarea va fi descrescătoare. Șirul de numere (întregi) este dat ca parametru în linia de comandă, iar definirea simbolului se va face din linia de comandă a compilatorului.</div>
</li>
<li class="level1"><div class="li"> [1.5p] Realizați un macro SWAP(x, y, type) care ia ca parametrii un tip de date, și două variabile și le interschimba conținutul.</div>
</li>
<li class="level1"><div class="li"> [2p] Realizați implementarea funcției cu număr variabil de parametri numită <code>awesome_gcd</code>, care să permită aflarea celui mai mare divizor comun al parametrilor de tip int dați (cel puțin două elemente). </div>
</li>
<li class="level1"><div class="li"> [2p] Realizați o funcție cu număr variabil de parametri, numită de exemplu myscanf() care să permită citirea cu format a unui număr de variabile dintr-un fișier binar. Prototipul va arăta în modul următor: int myprintf(FILE*, char *format, …);</div>
<ul>
<li class="level2"><div class="li"> Funcția va fi scrisă într-un fișier separat. Asigurați-vă că fișierul nu poate fi inclus de mai multe ori în același program! </div>
</li>
<li class="level2"><div class="li"> Funcțiile myscanf() va folosi în implementare funcția fread() și va funcționa în felul următor:</div>
<ul>
<li class="level4"><div class="li"> pentru fiecare caracter care nu e specificator de format, se va avansa o poziţie (un octet) în fişier.</div>
</li>
<li class="level4"><div class="li"> pentru fiecare specificator de format, se va citi din fișier în variabila curentă un număr de octeți corespunzător tipului dat de specificator (vezi mai jos). </div>
</li>
</ul>
</li>
<li class="level2"><div class="li"> Specificatorii de format suportați sunt următorii:</div>
<ul>
<li class="level4"><div class="li"> %c - dată de tip char</div>
</li>
<li class="level4"><div class="li"> %d - dată de tip integer</div>
</li>
<li class="level4"><div class="li"> %f - dată de tip float</div>
</li>
</ul>
</li>
<li class="level2"><div class="li"> Pentru simplitate se va considera că după &#039;%&#039; urmează mereu unul din cei 3 specificatori.</div>
</li>
<li class="level2"><div class="li"> Pentru testare folosiți fișierul de <code>lab14.bin</code>; afișați la stdout datele citite.</div>
</li>
</ul>
</li>
</ol>

</div>
<!-- EDIT7 SECTION "Exerciţii de Laborator" [15399-17620] -->
<h3 class="sectionedit8" id="bonus">Bonus</h3>
<div class="level3">
<ol>
<li class="level1"><div class="li"> [2p] Implementați myprintf, care afișează după formatul de mai sus în fișier binar.   </div>
<ul>
<li class="level2"><div class="li"> pentru fiecare caracter care nu e specificator de format, se va scrie în fișier chiar caracterul corespunzător</div>
</li>
<li class="level2"><div class="li"> pentru fiecare specificator de format, se va scrie în fișier din variabila curentă un număr de octeți corespunzător tipului dat de specificator (vezi mai jos). </div>
</li>
</ul>
</li>
</ol>

</div>
<!-- EDIT8 SECTION "Bonus" [17621-] --></div>
</body>
</html>
