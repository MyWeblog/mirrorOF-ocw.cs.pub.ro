    
    

<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <title>so-etti:laboratoare:lab6</title>
<meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="date" content="2013-04-18T23:35:40+0300"/>
<meta name="keywords" content="so-etti,laboratoare,lab6"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../../../lib/exe/opensearch.php" title="CS Open CourseWare"/>
<link rel="start" href="../../../../../courses.1.html"/>
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="../../../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="../../../../feed.php%3Fmode=list&amp;ns=so-etti:laboratoare"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="lab6.html"/>
<link rel="canonical" href="../../../../so-etti/laboratoare/lab6.html"/>
<link rel="stylesheet" type="text/css" href="../../../../lib/exe/css.php%3Ft=arctic&amp;tseed=1476798676.css"/>
<script type="text/javascript">/*<![CDATA[*/var NS='so-etti:laboratoare';var JSINFO = {"id":"so-etti:laboratoare:lab6","namespace":"so-etti:laboratoare","isadmin":0,"isauth":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../../../lib/exe/js.php%3Ftseed=1476798676"></script>
<script type="text/x-mathjax-config">/*<![CDATA[*/MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ["$","$"], ["\\(","\\)"] ],
        displayMath: [ ["$$","$$"], ["\\[","\\]"] ],
        processEscapes: true
    }
});
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<script type="text/javascript">/*<![CDATA[*/
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
		  
/*!]]>*/</script>
<script type="text/javascript">/*<![CDATA[*/
var pageTracker = _gat._getTracker("UA-38383934-1");
pageTracker._initData();
pageTracker._trackPageview();
		  
/*!]]>*/</script>
</head>
<body>
<div class="dokuwiki export">
<!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="lab6.html#laborator_06_-_shell_script-uri_1">Laborator 06 - Shell script-uri 1</a></div></li>
<li class="level1"><div class="li"><a href="lab6.html#suport_laborator">Suport laborator</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="lab6.html#arhiva_laborator">Arhivă laborator</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="lab6.html#introducere">Introducere</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="lab6.html#secventierea_operatiilor">Secvențierea operațiilor</a></div></li>
<li class="level2"><div class="li"><a href="lab6.html#multi-line_commands">Multi-line commands</a></div></li>
<li class="level2"><div class="li"><a href="lab6.html#scripturi_simple">Scripturi simple</a></div></li>
<li class="level2"><div class="li"><a href="lab6.html#source">Source</a></div></li>
<li class="level2"><div class="li"><a href="lab6.html#executabil">Executabil</a></div></li>
<li class="level2"><div class="li"><a href="lab6.html#shebang">Shebang</a></div></li>
<li class="level2"><div class="li"><a href="lab6.html#finalizarea_executiei_unui_proces">Finalizarea execuției unui proces</a></div></li>
<li class="level2"><div class="li"><a href="lab6.html#variabile_bash">Variabile Bash</a></div></li>
<li class="level2"><div class="li"><a href="lab6.html#undefined_vars">Undefined vars</a></div></li>
<li class="level2"><div class="li"><a href="lab6.html#quoting">Quoting</a></div></li>
<li class="level2"><div class="li"><a href="lab6.html#special_vars">Special vars</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="lab6.html#exercitii">Exerciții</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="lab6.html#descarcarea_arhivei_laboratorului">0. Descărcarea arhivei laboratorului</a></div></li>
<li class="level2"><div class="li"><a href="lab6.html#special_vars1">1. Special vars</a></div></li>
<li class="level2"><div class="li"><a href="lab6.html#source_vs_bash">2. source vs bash</a></div></li>
<li class="level2"><div class="li"><a href="lab6.html#secventiere_comenzi">3. Secvențiere comenzi</a></div></li>
<li class="level2"><div class="li"><a href="lab6.html#filtre_de_text_simple">4. Filtre de text simple</a></div></li>
<li class="level2"><div class="li"><a href="lab6.html#grep">5. grep</a></div></li>
<li class="level2"><div class="li"><a href="lab6.html#cut">6. cut</a></div></li>
<li class="level2"><div class="li"><a href="lab6.html#wc">7. wc</a></div></li>
<li class="level2"><div class="li"><a href="lab6.html#sort_uniq">8. sort. uniq</a></div></li>
<li class="level2"><div class="li"><a href="lab6.html#escaping_more_quoting">9. Escaping. More quoting</a></div></li>
<li class="level2"><div class="li"><a href="lab6.html#expandarea_unei_comenzi">10. Expandarea unei comenzi</a></div></li>
<li class="level2"><div class="li"><a href="lab6.html#dd">11. dd</a></div></li>
<li class="level2"><div class="li"><a href="lab6.html#readline">12. Readline</a></div></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="laborator_06_-_shell_script-uri_1">Laborator 06 - Shell script-uri 1</h1>
<div class="level1">

</div>
<!-- EDIT1 SECTION "Laborator 06 - Shell script-uri 1" [18-67] -->
<h1 class="sectionedit2" id="suport_laborator">Suport laborator</h1>
<div class="level1">
<ul>
<li class="level1"><div class="li"> <a href="http://books.google.com/books?id=_JFGzyRxQGcC&amp;pg=PA365" class="urlextern" title="http://books.google.com/books?id=_JFGzyRxQGcC&amp;pg=PA365"  rel="nofollow">12. Shell scripting</a> (capitolele 12.1 - 12.3, 12.4.1 - 12.4.3, 12.5 - 12.5.6, 12.5.7 (grep fără expresii regulate), 12.7.1, 12.8)</div>
</li>
<li class="level1"><div class="li"> Puteți urmări tutorialul video corespunzător laboratorului făcut de <a href="http://itassistant.org/diverse/utilizarea-sistemelor-de-operare/utilizarea-sistemelor-de-operare-9.html" class="urlextern" title="http://itassistant.org/diverse/utilizarea-sistemelor-de-operare/utilizarea-sistemelor-de-operare-9.html"  rel="nofollow">IT Assistant</a>.</div>
</li>
</ul>

</div>
<!-- EDIT2 SECTION "Suport laborator" [68-495] -->
<h2 class="sectionedit3" id="arhiva_laborator">Arhivă laborator</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li">  <a href="../../../../_media/uso/laboratoare/lab07.tar.gz" class="media mediafile mf_gz" title="uso:laboratoare:lab07.tar.gz (51.6 MB)">lab07.tar.gz</a></div>
</li>
</ul>

</div>
<!-- EDIT3 SECTION "Arhivă laborator" [496-579] -->
<h1 class="sectionedit4" id="introducere">Introducere</h1>
<div class="level1">

</div>
<!-- EDIT4 SECTION "Introducere" [580-607] -->
<h2 class="sectionedit5" id="secventierea_operatiilor">Secvențierea operațiilor</h2>
<div class="level2">

<p>
<strong>a)</strong> Pentru a scrie, pe două linii, titlul jocului StarCraft 2 se pot folosi două comenzi <code>echo</code> :
</p>
<pre class="code">student@uso:~$ echo &quot;StarCraft II&quot;
student@uso:~$ echo &quot;Wings of Liberty&quot;</pre>

<p>
<strong>b)</strong> Comenzile anterioare se pot rescrie pe un singur rând. Operatorul <code>;</code> este folosit pentru a secvenția două comenzi.
</p>
<pre class="code">student@uso:~$ echo &quot;StarCraft II&quot;; echo &quot;Wings of Liberty&quot;</pre>

<p>
Puteți observa cum shell-ul afișează un nou prompt <em class="u">doar</em> după ce a executat <em>ambele</em> instrucțiuni.
<p><div class="notetip">
Se pot rula oricâte comenzi într-o secvență, separate prin <code>;</code>. Orice comenzi pot fi secvențiate în acest fel, nu doar <code>echo</code>. Comenzile dintr-o secvență pot fi diferite, nu trebuie să fie toate de același fel.

</div></p>
</p>

</div>
<!-- EDIT5 SECTION "Secvențierea operațiilor" [608-1401] -->
<h2 class="sectionedit6" id="multi-line_commands">Multi-line commands</h2>
<div class="level2">

<p>
<strong>a)</strong> Rulați comanda de mai jos pentru a descărca și dezarhiva fișierele de suport ale laboratorului de astăzi.
</p>

<p>
Obsevați că fiecare linie se termină cu un caracter <code>\</code>. Acesta va face ca linia următoarea să fie considerată ca făcând parte din comanda curentă.
</p>
<pre class="code">student@uso:~$ wget http://ocw.cs.pub.ro/courses/_media/uso/laboratoare/lab07.tar.gz;\
echo &quot;Am luat arhiva.&quot;; \
mkdir lab07; \
tar zxvf lab07.tar.gz; \
echo &quot;Am dezarhivat arhiva&quot;; \
echo &quot;Continutul arhivei:&quot;; \
ls -l lab07</pre>

<p>
<p><div class="notetip">
Un backslash (<code>\</code>) la finalul liniei semnifică faptul că linia se continuă pe rândul următor.

</div></p>
</p>

<p>
Promptul oferit după trecerea liniei pe rândul următor este <code>&gt;</code>.
</p>

<p>
Dacă apăsați săgeată sus pentru a relua comanda anterioară, veți vedea că toate comenzile au fost alăturate pentru a fi pe o singură linie.
</p>

</div>
<!-- EDIT6 SECTION "Multi-line commands" [1402-2297] -->
<h2 class="sectionedit7" id="scripturi_simple">Scripturi simple</h2>
<div class="level2">

<p>
<strong>a)</strong> De cele mai multe ori se întâmplă ca, după ce se creează o comandă compusă pentru un task, să trebuiască să fie rezolvat acel task încă o dată. Pentru a nu rescrie toată comanda, se poate folosi un fișier în care se salvează toate comenzile componente.
</p>

<p>
Se pot copia, într-un fișier numit <code>sc.sh</code>, următoarele două linii:
</p>
<pre class="code">echo &quot;StarCraft II&quot;
echo &quot;Wings of Liberty&quot;</pre>

<p>
Câteva observații:
</p>
<ul>
<li class="level1"><div class="li"> Extensia <code>sh</code> desemenează, tradițional, un shell script. Folosirea extensiei nu este obligatorie (comparativ cu <code>exe</code>, care este obligatoriu pe Windows).</div>
</li>
<li class="level1"><div class="li"> Un shell script conține <strong>comenzi</strong>. Orice comandă puteți da la prompt-ul interactiv poate apărea și într-un asemenea fișier.</div>
</li>
</ul>

<p>
<strong>b)</strong> Pentru a lansa script-ul, se poate folosi comanda de mai jos având ca director curent directorul unde este salvat fișierul <code>sc.sh</code>:
</p>
<pre class="code">student@uso:~$ bash sc.sh</pre>

<p>
Linia de mai sus pornește un nou proces bash care nu va citi comenzile de la tastatură, ci din fișierul <code>sc.sh</code>. La finalul fișierului, shell-ul își va încheia execuția – putem spune că există un <code>exit</code> implicit.
</p>

<p>
<p><div class="notetip">
Formularea de mai sus <strong>pornește un proces nou</strong> bash trebuie completată de faptul că, după ce procesul nou este pornit, se așteaptă ca el să se termine. Comenzile listate în fișier nu sunt executate de shell-ul inițial.

</div></p>
</p>

</div>
<!-- EDIT7 SECTION "Scripturi simple" [2298-3728] -->
<h2 class="sectionedit8" id="source">Source</h2>
<div class="level2">

<p>
O altă modalitate de a rula un script este folosind <code>source</code>.
</p>
<pre class="code">student@uso:~$ source sc.sh</pre>

<p>
Alternativ, se poate folosi <code>.</code> ca sinonim pentru <code>source</code> – pentru a scrie mai puțin.
</p>
<pre class="code">student@uso:~$ . sc.sh</pre>

<p>
Diferențele între cele două moduri de execuție (<code>source</code> și <code>bash</code>) pot fi văzute într-un exercițiu ulterior.
</p>

</div>
<!-- EDIT8 SECTION "Source" [3729-4113] -->
<h2 class="sectionedit9" id="executabil">Executabil</h2>
<div class="level2">

<p>
<strong>a)</strong> O altă modalitate de a rula un script este aceea de a îl face executabil și de a îl rula ca un executabil oarecare.
</p>

<p>
Se pot adăuga drepturi de execuție scriptului <code>sc.sh</code> și apoi scriptul se poate rula cu:
</p>
<pre class="code">student@uso:~$ ./sc.sh</pre>

<p>
<p><div class="notetip">
Amintiți-vă ce făcea <code>chmod</code>.

</div></p>
</p>

</div>
<!-- EDIT9 SECTION "Executabil" [4114-4454] -->
<h2 class="sectionedit10" id="shebang">Shebang</h2>
<div class="level2">

<p>
<strong>a)</strong> Se pot scrie fișiere script și în alte limbaje, nu doar în bash. Python, Perl, Ruby sunt câteva limbaje frecvent folosite.
</p>

<p>
Pentru a putea diferenția între limbajele din cadrul scripturilor va trebui invocat interpretorul corespunzător. De exemplu, pentru un script Python va trebui să rulăm <code>python script</code>.
</p>

<p>
Dacă vrem să rulăm orice script sub forma <code>./script</code>, prima linie a fișierului va avea un format special: va conține șirul <code>#!</code> urmat de executabilul ce trebuie invocat pentru a rula scriptul. În acest caz, prima linie se numește <em>linia shebang</em> (sau <a href="http://tldp.org/LDP/abs/html/sha-bang.html" class="urlextern" title="http://tldp.org/LDP/abs/html/sha-bang.html"  rel="nofollow">sha-bang</a>).
</p>

<p>
Pentru <code>bash</code>, linia ar arăta:
</p>
<pre class="code">#! /bin/bash</pre>

<p>
Adăugați linia shebang scriptului <code>sc.sh</code> și rulați-l cu <code>./sc.sh</code>.
</p>

<p>
<p><div class="notetip">
Pentru fișierele script bash nu este obligatorie linia shebang. Se recomandă totuși s-o puneți pentru că scriptul ar putea fi folosit și în alte interpretoare de comenzi (dash, zsh, csh).

</div></p>
</p>

<p>
<p><div class="notetip">
Așa cum nu este nici o diferența între <code>.</code> și <code>source</code>, la fel nu este nici o diferență între <code>bash script.sh</code> și <code>./script.sh</code> dacă <code>script.sh</code> începe cu <code>#! /bin/bash</code>.

</div></p>
</p>

</div>
<!-- EDIT10 SECTION "Shebang" [4455-5696] -->
<h2 class="sectionedit11" id="finalizarea_executiei_unui_proces">Finalizarea execuției unui proces</h2>
<div class="level2">

<p>
Un proces își poate termina execuția cu succes (status 0) sau cu eroare (status diferit de 0). Într-un terminal statusul cu care s-a încheiat ultimul proces lansat se poate vedea cu ajutorul comenzii 
</p>
<pre class="code bash"><span class="kw3">echo</span> <span class="re4">$?</span></pre>

<p>
<strong>true</strong> și <strong>false</strong> sunt două programe care întotdeauna se termină cu succes, respectiv cu eroare:
</p>
<pre class="code bash"><span class="co4">student@uso:~$ </span><span class="kw2">true</span>
<span class="co4">student@uso:~$ </span><span class="kw3">echo</span> <span class="re4">$?</span>
<span class="nu0">0</span>
<span class="co4">student@uso:~$ </span><span class="kw2">false</span>
<span class="co4">student@uso:~$ </span><span class="kw3">echo</span> <span class="re4">$?</span>
<span class="nu0">1</span></pre>
<ul>
<li class="level1"><div class="li"> Folosind operatorii <strong>&amp;&amp;</strong> și <strong>||</strong>, putem rula un al doilea proces doar dacă primul proces s-a încheiat cu succes, respectiv eroare. Operatorii se aseamănă cu funțiile logice AND și OR.</div>
</li>
</ul>
<pre class="code bash"><span class="co4">student@uso:~$ </span><span class="kw2">true</span> <span class="sy0">&amp;&amp;</span> <span class="kw3">echo</span> <span class="st0">&quot;Success&quot;</span>
Success
<span class="co4">student@uso:~$ </span><span class="kw2">false</span> <span class="sy0">&amp;&amp;</span> <span class="kw3">echo</span> <span class="st0">&quot;Success&quot;</span>
&nbsp;
<span class="co4">student@uso:~$ </span><span class="kw2">true</span> <span class="sy0">||</span> <span class="kw3">echo</span> <span class="st0">&quot;Fail&quot;</span>
&nbsp;
<span class="co4">student@uso:~$ </span><span class="kw2">false</span> <span class="sy0">||</span> <span class="kw3">echo</span> <span class="st0">&quot;Fail&quot;</span>
Fail</pre>

</div>
<!-- EDIT11 SECTION "Finalizarea execuției unui proces" [5697-6577] -->
<h2 class="sectionedit12" id="variabile_bash">Variabile Bash</h2>
<div class="level2">

<p>
<code>bash</code> este, de fapt, un limbaj de programare; doar că până acum l-am folosit interactiv. Ca orice limbaj de programare, <code>bash</code> are suport de variabile.
</p>

<p>
Pentru a defini o variabilă folosim sintaxa <strong><code>NUME_VARIABILA=VALOARE</code></strong>.
</p>

<p>
<p><div class="notetip">
<strong>Nu</strong> lăsați niciun spațiu în jurul semnului <code>=</code>. Este o restricție sintactică <code>bash</code>.

</div></p>
</p>

<p>
Exemplu de utilizare a variabielor:
</p>
<pre class="code bash"><span class="co4">student@uso:~$ </span><span class="re2">sc_version</span>=<span class="nu0">2</span>
<span class="co4">student@uso:~$ </span><span class="re2">sc_title</span>=<span class="st0">&quot;Wings of Liberty&quot;</span>
<span class="co4">student@uso:~$ </span><span class="kw3">echo</span> StarCraft <span class="re1">$sc_version</span>
StarCraft <span class="nu0">2</span>
<span class="co4">student@uso:~$ </span><span class="kw3">echo</span> <span class="re1">$sc_title</span>
Wings of Liberty</pre>

<p>
<p><div class="notetip">
</p>
<ul>
<li class="level1"><div class="li"> Observați faptul că <em>inițializarea</em> variabilei se face folosind numele ei, dar <em>folosirea</em> necesită prefixarea cu simbolul <code>$</code>.</div>
</li>
<li class="level1"><div class="li"> Dacă valoarea pe care vreți să o atribuiți varabilei conține spații, folosiți ghilimele în jurul întregii valori pentru a proteja acele spații.</div>
</li>
</ul>

<p>

</div></p>
</p>

</div>
<!-- EDIT12 SECTION "Variabile Bash" [6578-7513] -->
<h2 class="sectionedit13" id="undefined_vars">Undefined vars</h2>
<div class="level2">

<p>
Ce se întâmplă dacă vrem să folosim o variabilă nedefinită?
</p>
<pre class="code bash">$ <span class="kw3">echo</span> <span class="re1">$undefined_var</span>
&nbsp;</pre>

<p>
Bash nu consideră o eroare faptul că o variabilă nu este definită. O va înlocui cu șirul vid.
</p>

</div>
<!-- EDIT13 SECTION "Undefined vars" [7514-7754] -->
<h2 class="sectionedit14" id="quoting">Quoting</h2>
<div class="level2">

<p>
Vreți să afișați un tabel cu eroii StarCraft 2. Pentru a fi mai simplu de modificat, scrieți un shell script numit <code>heroes.sh</code>. Definiți, în script, câte o variabilă pentru fiecare facțiune.
</p>

<p>
<p><div class="notetip">
Caracterul <code>#</code> marchează începutul unui comentariu. Comentariul se întinde până la finalul liniei.

</div></p>
</p>
<pre class="code bash">$ <span class="kw2">cat</span> heroes.sh
<span class="re2">terran</span>=<span class="st0">&quot;Terran    Jim Raynor&quot;</span>
<span class="re2">zerg</span>=<span class="st0">&quot;Zerg      Kerrigan&quot;</span>
<span class="re2">protoss</span>=<span class="st0">&quot;Protoss   Artanis&quot;</span>
<span class="co0"># Acum afisam cele trei variabile</span>
<span class="kw3">echo</span> <span class="re1">$terran</span>
<span class="kw3">echo</span> <span class="re1">$zerg</span>
<span class="kw3">echo</span> <span class="re1">$protoss</span>
$ <span class="kw2">bash</span> heroes.sh
Terran Jim Raynor
Zerg Kerrigan
Protoss Artanis</pre>

<p>
Observați că spațiile în plus nu au niciun efect, drept urmare cuvintele nu sunt aliniate. Pentru a repara acest lucru trebuie să încadrați numele variabilelor între ghilimele:
</p>
<pre class="code bash">$ <span class="kw2">cat</span> heroes.sh
<span class="re2">terran</span>=<span class="st0">&quot;Terran    Jim Raynor&quot;</span>
<span class="re2">zerg</span>=<span class="st0">&quot;Zerg      Kerrigan&quot;</span>
<span class="re2">protoss</span>=<span class="st0">&quot;Protoss   Artanis&quot;</span>
<span class="co0"># Acum afisam cele trei variabile</span>
<span class="kw3">echo</span> <span class="st0">&quot;<span class="es2">$terran</span>&quot;</span>
<span class="kw3">echo</span> <span class="st0">&quot;<span class="es2">$zerg</span>&quot;</span>
<span class="kw3">echo</span> <span class="st0">&quot;<span class="es2">$protoss</span>&quot;</span>
$ <span class="kw2">bash</span> heroes.sh
Terran    Jim Raynor
Zerg      Kerrigan
Protoss   Artanis</pre>

<p>
<p><div class="notetip">
Inconveniența este cauzată de faptul că <code>echo</code> afișează fiecare parametru al său, separat printr-un singur spațiu. Puteți vedea în imaginea de mai jos etapele evaluării comenzii <code>echo</code> în cele două cazuri.

</div></p>
</p>

<p>
<a href="http://ocw.cs.pub.ro/courses/lib/exe/fetch.php?hash=f68f64&amp;media=http%3A%2F%2Felf.cs.pub.ro%2Fuso%2Fstore%2F10_quoting.png" class="media" title="http://elf.cs.pub.ro/uso/store/10_quoting.png"><img src="http://ocw.cs.pub.ro/courses/lib/exe/fetch.php?hash=f68f64&amp;media=http%3A%2F%2Felf.cs.pub.ro%2Fuso%2Fstore%2F10_quoting.png" class="media" alt="" /></a>
</p>

</div>
<!-- EDIT14 SECTION "Quoting" [7755-9115] -->
<h2 class="sectionedit15" id="special_vars">Special vars</h2>
<div class="level2">

<p>
Până acum ați învățat să rulați un script, folosind construcția <strong><code>bash</code></strong> sau <strong><code>source</code></strong>, în urma căreia scriptul se execută, efectuând anumite acțiuni. Dacă îl rulați încă o dată, aceleași acțiuni s-ar executa identic.
</p>

<p>
De multe ori am folosit comenzi căror le-am trimis anumiți parametrii specifici comenzii. De exemplu <em>ps -e</em>, sau
<em>cat FIŞIER</em>. 
Asemănător putem rula scriptul nostru adăugând parametrii după numele script-ului:
</p>
<pre class="code bash"><span class="co4">student@uso:~$ </span>.<span class="sy0">/</span>script_bash parametru_1 parametru_2</pre>

<p>
Pentru a putea avea acces la parametrii transmiși unui script, bash ne pune la dispoziție următoarele variabile speciale:
</p>
<div class="table sectionedit16"><table class="inline">
	<tr class="row0">
		<th class="col0 leftalign"> Variabila     </th><th class="col1 leftalign"> Semnificație                                 </th><th class="col2 leftalign"> Echivalent C                          </th>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign"> <strong><code>$#</code></strong>    </td><td class="col1 leftalign"> Numărul de parametri transmiși scriptului    </td><td class="col2 leftalign"> <strong><code>argc</code></strong>                          </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> <strong><code>$@</code></strong>    </td><td class="col1 leftalign"> Parametrii efectivi transmiși scriptului     </td><td class="col2 leftalign"> <strong><code>argv</code></strong>                          </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> <strong><code>$0</code></strong>    </td><td class="col1 leftalign"> Numele scriptului                            </td><td class="col2 leftalign"> <strong><code>argv[0]</code></strong>                       </td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign"> <strong><code>$1</code></strong>    </td><td class="col1 leftalign"> Primul argument                              </td><td class="col2 leftalign"> <strong><code>argv[1]</code></strong>                       </td>
	</tr>
	<tr class="row5">
		<td class="col0 leftalign"> <strong><code>$2</code></strong>    </td><td class="col1 leftalign"> Al doilea argument                           </td><td class="col2 leftalign"> <strong><code>argv[2]</code></strong>                       </td>
	</tr>
	<tr class="row6">
		<td class="col0 leftalign"> …           </td><td class="col1 centeralign">  …                                         </td><td class="col2 leftalign"> …                                   </td>
	</tr>
</table></div>
<!-- EDIT16 TABLE [9817-10555] -->
<p>
Alte variabile speciale întâlnite de-a lungul laboratoarelor:
</p>
<div class="table sectionedit17"><table class="inline">
	<tr class="row0">
		<th class="col0 leftalign"> Variabila     </th><th class="col1 leftalign"> Semnificație                                 </th><th class="col2 leftalign"> Echivalent C                          </th>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign"> <strong><code>$$</code></strong>    </td><td class="col1 leftalign"> PID-ul procesului curent                     </td><td class="col2 leftalign"> -                                     </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> <strong><code>$!</code></strong>    </td><td class="col1"> PID-ul ultimului proces lansat in background </td><td class="col2 leftalign"> -                                     </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> <strong><code>$?</code></strong>    </td><td class="col1 leftalign"> Valoarea de exit a ultimei comenzi           </td><td class="col2"> valoarea cu care se întoarce <code>main</code> </td>
	</tr>
</table></div>
<!-- EDIT17 TABLE [10622-11043] -->
</div>
<!-- EDIT15 SECTION "Special vars" [9116-11048] -->
<h1 class="sectionedit18" id="exercitii">Exerciții</h1>
<div class="level1">

</div>
<!-- EDIT18 SECTION "Exerciții" [11049-11073] -->
<h2 class="sectionedit19" id="descarcarea_arhivei_laboratorului">0. Descărcarea arhivei laboratorului</h2>
<div class="level2">

<p>
Descărcați arhiva de laborator. Dezarhivați-o folosind <strong>tar</strong>.
</p>
<div class="solution"><div class="solution_title"><span class="title_text">Rezolvare</span></div><div class="solution_contents"><pre class="code bash"><span class="kw2">tar</span> xf lab07.tar.gz</pre>
</div></div>

</div>
<!-- EDIT19 SECTION "0. Descărcarea arhivei laboratorului" [11074-11255] -->
<h2 class="sectionedit20" id="special_vars1">1. Special vars</h2>
<div class="level2">

<p>
Vizualizați conținutul scriptului <code>special_vars.sh</code> din arhiva de laborator și apoi rulați-l astfel:
</p>
<pre class="code bash"><span class="co4">student@uso:~$ </span>.<span class="sy0">/</span>special_vars.sh <span class="nu0">1</span> <span class="nu0">2</span> <span class="nu0">3</span> <span class="nu0">4</span> a</pre>

<p>
Identificați valorile parametrilor trimiși script-ului și a celorlalte variabile speciale (cele din Introducere).
</p>

</div>
<!-- EDIT20 SECTION "1. Special vars" [11256-11575] -->
<h2 class="sectionedit21" id="source_vs_bash">2. source vs bash</h2>
<div class="level2">

<p>
Rulați următoarele comenzi.
</p>
<pre class="code bash"><span class="co4">student@uso:~$ </span><span class="re2">race</span>=Zerg
<span class="co4">student@uso:~$ </span><span class="kw2">bash</span> rush.sh
Rush<span class="sy0">!!</span>
<span class="co4">student@uso:~$ </span><span class="kw3">source</span> rush.sh
Zerg Rush<span class="sy0">!!</span></pre>

<p>
Observați că în momentul folosirii <strong><code>source</code></strong> variabilele sunt definite și în interiorul scriptului.
</p>

<p>
Rulați comenzile următoare și identificați câte procese se crează în momentul folosirii <code>bash</code> și câte în cazul <code>source</code>
</p>
<pre class="code bash"><span class="co4">student@uso:~$ </span><span class="kw3">echo</span> <span class="re4">$$</span>; <span class="kw2">bash</span> special_vars.sh; <span class="kw3">echo</span> <span class="re4">$$</span>
<span class="co4">student@uso:~$ </span><span class="kw3">echo</span> <span class="re4">$$</span>; <span class="kw3">source</span> special_vars.sh; <span class="kw3">echo</span> <span class="re4">$$</span></pre>

<p>
Variabilele definite într-un shell bash sunt locale acelui shell. Rulând scriptul <code>rush.sh</code> cu comanda <strong><code>bash</code></strong>, se crează un alt shell bash ce execută comenzile din script.
</p>

<p>
<p><div class="noteimportant">
<code>source</code> nu pornește proces nou, execută comenzile din script ca și cum ar fi fost introduse de la tastatură.

</div></p>
</p>

<p>
<p><div class="notetip">
Fișierul <code>.bashrc</code> este <em class="u">sourced</em> la fiecare lansare a unui proces <code>bash</code>. De aceea, e bine să salvați în el configurările proprii pentru <code>bash</code>: alias-uri, definiții de variabile, valoare <code>umask</code>, etc.
</p>

<p>
Un fișier similar este <code>.vimrc</code> sourced de fiecare dată când se lansează o nouă instanță de <code>vim</code>.

</div></p>
</p>

</div>
<!-- EDIT21 SECTION "2. source vs bash" [11576-12815] -->
<h2 class="sectionedit22" id="secventiere_comenzi">3. Secvențiere comenzi</h2>
<div class="level2">

<p>
Studiați ce se întâmplă dacă încercați să listați conținutul unui director care nu există. Ce valoare de ieșire are <code>ls</code> în acest caz?
</p>
<div class="solution"><div class="solution_title"><span class="title_text">Rezolvare</span></div><div class="solution_contents"><pre class="code bash"><span class="co4">student@uso:~$ </span><span class="kw2">ls</span> warcraft
ls: cannot access warcraft: No such <span class="kw2">file</span> or directory
<span class="co4">student@uso:~$ </span><span class="kw3">echo</span> <span class="re4">$?</span>
<span class="nu0">2</span></pre>
</div></div>

<p>
Scrieți un one-liner care creează directorul <code>warcraft</code> dacă acesta nu există deja. Folosiți-vă de faptul că <code>ls</code> va întoarce non-zero dacă directorul nu există. Ce operator veți folosi: <code>&amp;&amp;</code> sau <code>||</code>?
</p>
<div class="solution"><div class="solution_title"><span class="title_text">Rezolvare</span></div><div class="solution_contents"><pre class="code bash"><span class="co4">student@uso:~$ </span><span class="kw2">ls</span> warcraft <span class="sy0">||</span> <span class="kw2">mkdir</span> warcraft</pre>
</div></div>

</div>
<!-- EDIT22 SECTION "3. Secvențiere comenzi" [12816-13464] -->
<h2 class="sectionedit23" id="filtre_de_text_simple">4. Filtre de text simple</h2>
<div class="level2">

<p>
Până acum știți să afișați conținutul unui fișier utilizând <strong><code>cat</code></strong>. Uneori, dorim să vizualizăm doar începutul sau finalul fișierului sau poate dorim să vizualizăm fișierul de la început spre final. Următorul tabel listează comenzile folosite în aceste cazuri.
</p>
<div class="table sectionedit24"><table class="inline">
	<tr class="row0">
		<th class="col0 leftalign"> Comanda 	</th><th class="col1 leftalign"> Efect                                        </th>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign"> <strong><code>cat</code></strong> 	</td><td class="col1"> Afișează tot conținutul fișierului în ordine </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> <strong><code>tac</code></strong> 	</td><td class="col1 leftalign"> Afișează tot conținutul fișierului inversat  </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> <strong><code>head</code></strong>	</td><td class="col1 leftalign"> Afișează doar primele linii din fișier       </td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign"> <strong><code>tail</code></strong>	</td><td class="col1 leftalign"> Afișează doar ultimele linii din fișier      </td>
	</tr>
</table></div>
<!-- EDIT24 TABLE [13792-14122] -->
<p>
Dacă nu primesc nici un argument, aceste comenzi citesc de la standard input ceea ce face posibilă folosirea lor prin înlănțuire cu pipe-uri.
</p>

<p>
Comenzile <strong><code>head</code></strong> și <strong><code>tail</code></strong> implicit afișează primele, respectiv ultimele 10 linii. Pentru a afișa un număr arbitrar de linii, folosim:
</p>
<pre class="code bash"><span class="kw2">head</span> <span class="re5">-n</span> k <span class="co0"># primele k linii</span>
<span class="kw2">tail</span> <span class="re5">-n</span> k <span class="co0"># ultimele k linii</span>
<span class="co0"># de asemenea</span>
<span class="kw2">head</span> <span class="re5">-n</span> <span class="re5">-k</span> <span class="co0"># toate liniile, mai putin ultimele k</span>
<span class="kw2">tail</span> <span class="re5">-n</span> +k <span class="co0"># toate liniile, mai putin primele (k-1)</span></pre>

<p>
Încercați să explicați ce face următoarea comandă. Dați o formulare mai simplă pentru ea. 
</p>
<pre class="code bash"><span class="kw2">tac</span> special_vars.sh <span class="sy0">|</span> <span class="kw2">head</span> <span class="sy0">|</span> <span class="kw2">tail</span> <span class="re5">-n</span> +<span class="nu0">3</span> <span class="sy0">|</span> <span class="kw2">head</span> <span class="re5">-n</span> <span class="re5">-1</span> <span class="sy0">|</span> <span class="kw2">tac</span> <span class="sy0">|</span> <span class="kw2">tail</span> <span class="re5">-n</span> <span class="nu0">1</span></pre>

<p>
<p><div class="notetip">
Puteți consulta paginile de manual pentru <code>head</code> și <code>tail</code> pentru a vedea cum selectați range-ul de afișat.

</div></p>
</p>

</div>
<!-- EDIT23 SECTION "4. Filtre de text simple" [13465-14946] -->
<h2 class="sectionedit25" id="grep">5. grep</h2>
<div class="level2">

<p>
<p><div class="notetip">
Multe dintre utilitarele disponibile în linia de comandă oferă ca output o cantitate mare de text. Pentru a putea filtra output-ul se pot folosi două utilitare: <code>grep</code> (pentru a selecta numai anumite linii) și <code>cut</code> (pentru a selecta numai anumite secțiuni de pe fiecare linie).

</div></p>
</p>

<p>
<strong>a)</strong> Afișați în terminal conținutul fișierului <code>/var/log/syslog</code>. După cum observați, fișierul conține un număr mare de linii.
</p>
<div class="solution"><div class="solution_title"><span class="title_text">Rezolvare</span></div><div class="solution_contents"><pre class="code">student@uso:~$ cat /var/log/syslog</pre>
</div></div>

<p>
<strong>b)</strong> <code>grep</code> poate primi ca argumente
</p>
<ul>
<li class="level1"><div class="li"> un șablon pe baza căruia selectează liniile afișate</div>
</li>
<li class="level1"><div class="li"> fișierul ce conține liniile pe care le va filtra</div>
</li>
</ul>
<pre class="code bash"><span class="kw2">grep</span> ȘABLON FIȘIER</pre>

<p>
Șablonul este reprezentat de o expresie regulată (mai multe detalii în laboratoarele viitoare).
</p>

<p>
Folosind <code>grep</code>, afișați doar liniile care conțin string-ul “avahi” din fișierul <code>/var/log/syslog</code>
</p>
<div class="solution"><div class="solution_title"><span class="title_text">Rezolvare</span></div><div class="solution_contents"><pre class="code">student@uso:~$ grep avahi /var/log/syslog</pre>
</div></div>

<p>
<strong>c)</strong> <code>grep</code> poate primi liniile pe care le filtrează și pe STDIN. Este o metodă de utilizare uzuală, care se folosește de pipe-uri (<code>|</code>).
Folosind <code>cat</code> și <code>grep</code>, afișați doar liniile care conțin string-ul “avahi” din fișierul <code>/var/log/syslog</code>
</p>
<div class="solution"><div class="solution_title"><span class="title_text">Rezolvare</span></div><div class="solution_contents"><pre class="code">student@uso:~$ cat /var/log/syslog | grep avahi</pre>
</div></div>

</div>
<!-- EDIT25 SECTION "5. grep" [14947-16340] -->
<h2 class="sectionedit26" id="cut">6. cut</h2>
<div class="level2">

<p>
<strong>a)</strong>  Utilitarul <strong><code>cut</code></strong> primește două argumente:
</p>
<ul>
<li class="level1"><div class="li"> un șablon pe baza căruia selectează secțiunea care va fi afișată din fiecare linie</div>
</li>
<li class="level1"><div class="li"> fișierul ce conține liniile pe care le va filtra</div>
</li>
</ul>

<p>
Șablonul este compus din două elemente: un caracter de delimitare a câmpurilor (specificat prin <strong><code>-d</code></strong>) și id-ul câmpurilor care se afișează (specificat prin <strong><code>-f</code></strong>).
</p>
<pre class="code bash"><span class="kw2">cut</span> <span class="re5">-d</span> DELIMITATOR <span class="re5">-f</span> LISTĂ_CÂMPURI FIȘIER</pre>

<p>
Dacă vrem ca pentru fiecare linie din fișierul <code>/var/log/syslog</code> să afișăm numai ora la care a fost înregistrată acea linie, executăm următoarea comandă:
</p>
<pre class="code">student@uso:~$ cut -d &quot; &quot; -f 3 /var/log/syslog</pre>

<p>
Identificați parametrii trimiși lui <strong><code>cut</code></strong>.
</p>

<p>
<strong>b)</strong> La fel ca <strong><code>grep</code></strong>, <strong><code>cut</code></strong> poate primi liniile pe care le filtrează și pe STDIN.
</p>

<p>
Afișați toate liniile din fișierul <code>/var/log/syslog</code> care conțin șirul de caractere <code>kernel</code>. Nu uitați să folosiți <strong><code>cat</code></strong>.
</p>
<div class="solution"><div class="solution_title"><span class="title_text">Rezolvare</span></div><div class="solution_contents"><pre class="code">student@uso:~$ cat /var/log/syslog | grep kernel</pre>
</div></div>

<p>
Pentru fiecare din liniile anterioare afișați numai ora la care a fost înregistrată:
</p>
<div class="solution"><div class="solution_title"><span class="title_text">Rezolvare</span></div><div class="solution_contents"><pre class="code">studente@uso:~$ cat /var/log/syslog | grep kernel | cut -d &quot; &quot; -f 3</pre>
</div></div>

</div>
<!-- EDIT26 SECTION "6. cut" [16341-17626] -->
<h2 class="sectionedit27" id="wc">7. wc</h2>
<div class="level2">

<p>
Dorim să aflăm statistici despre un fișier cu privire la numărul de linii, cuvinte și caractere. Folosim <strong><code>wc</code></strong>.
</p>

<p>
Aflați câte linii are fișierul <strong><code>special_vars.sh</code></strong>.
</p>
<div class="solution"><div class="solution_title"><span class="title_text">Rezolvare</span></div><div class="solution_contents"><pre class="code bash"><span class="co4">$ </span><span class="kw2">wc</span> <span class="re5">-l</span> special_vars.sh</pre>
</div></div>

</div>
<!-- EDIT27 SECTION "7. wc" [17627-17897] -->
<h2 class="sectionedit28" id="sort_uniq">8. sort. uniq</h2>
<div class="level2">

<p>
Fișierul <strong><code>many_numbers</code></strong> conține numere naturale, câte unul pe fiecare linie. Vrem să aflăm câte numere există în total, numărând fiecare număr o singură dată (altfel spus, ignorând repetițiile).
</p>

<p>
Pentru asta vom sorta <strong><code>numeric</code></strong> fișierul cu <strong><code>sort</code></strong> și vom elimina duplicatele de pe liniile consecutive folosind <strong><code>uniq</code></strong>. La final, va trebui să numărăm liniile obținute.
</p>

<p>
Câte numere conține fișierul <strong><code>many_numbers</code></strong>?
</p>
<div class="solution"><div class="solution_title"><span class="title_text">Rezolvare</span></div><div class="solution_contents"><pre class="code bash"><span class="co4">student@uso:~$ </span><span class="kw2">sort</span> <span class="re5">-n</span> many_numbers <span class="sy0">|</span> <span class="kw2">uniq</span> <span class="sy0">|</span> <span class="kw2">wc</span> <span class="re5">-l</span></pre>
</div></div>

</div>
<!-- EDIT28 SECTION "8. sort. uniq" [17898-18486] -->
<h2 class="sectionedit29" id="escaping_more_quoting">9. Escaping. More quoting</h2>
<div class="level2">

<p>
Reveniți la script-ul <code>special_vars.sh</code>. Găsiți o modalitate de a transmite script-ului parametrul <code>“Wings of Liberty”</code> (<em>incluzând ghilimelele</em>). Pentru a include ghilimele într-o expresie care este deja între ghilimele, folosiți escaping: <code>“\”Wings of Liberty\””</code>.
</p>

<p>
O alternativă este folosirea apostroafelor pentru a delimita șirul:
</p>
<pre class="code bash"><span class="co4">student@uso:~$ </span><span class="kw3">echo</span> <span class="st_h">'&quot;Wings of Liberty&quot;'</span>
<span class="st0">&quot;Wings of Liberty&quot;</span>
<span class="co4">student@uso:~$ </span><span class="kw3">echo</span> <span class="st0">&quot;<span class="es1">\&quot;</span>Wings of Liberty<span class="es1">\&quot;</span>&quot;</span>
<span class="st0">&quot;Wings of Liberty&quot;</span></pre>

<p>
Apostroafele au, însă, și un efect neașteptat. Identificați-l urmărind pașii următori:
</p>
<ul>
<li class="level1"><div class="li"> Definiți variabila <code>faction</code> având valoarea <code>Terran</code>.</div>
</li>
<li class="level1"><div class="li"> Folosiți <code>echo</code> pentru a afișa valoarea variabilei.</div>
</li>
<li class="level1"><div class="li"> Folosiți <code>echo</code> pentru a afișa valoarea variabilei, dar de data aceasta încadrați formularea <code>$faction</code> cu apostroafe.</div>
</li>
</ul>
<div class="solution"><div class="solution_title"><span class="title_text">Rezolvare</span></div><div class="solution_contents"><pre class="code bash">$ <span class="re2">faction</span>=Terran
$ <span class="kw3">echo</span> <span class="re1">$faction</span>
Terran
$ <span class="kw3">echo</span> <span class="st_h">'$faction'</span>
<span class="re1">$faction</span></pre>
</div></div>

<p>
<p><div class="notetip">
Caracterul <code>$</code> are semnnificație literală între apostroafe.

</div></p>
</p>

</div>
<!-- EDIT29 SECTION "9. Escaping. More quoting" [18487-19570] -->
<h2 class="sectionedit30" id="expandarea_unei_comenzi">10. Expandarea unei comenzi</h2>
<div class="level2">

<p>
Simbolul <code>$</code> este folosit pentru expandarea unei variabile, comenzi sau expresii.
</p>

<p>
În laboratorul 5 ați întâlnit următoarea comandă:
</p>
<pre class="code bash"><span class="co4">student@uso:~$ </span><span class="kw2">kill</span> <span class="re5">-9</span> $<span class="br0">&#40;</span><span class="kw2">pidof</span> signal_test<span class="br0">&#41;</span></pre>

<p>
Se executa comanda <strong><code>pidof signal_test</code></strong>, iar outputul acesteia era trimis ca parametru comenzii <strong><code>kill</code></strong>.
</p>

<p>
Asemănător putem să atribuim outpul comenzii <strong><code>pidof</code></strong> unei variabile, iar apoi să transmitem variabila ca parametru comenzii <strong><code>kill</code></strong>:
</p>
<pre class="code bash"><span class="co4">student@uso:~$ </span><span class="re2">pid_signal</span>=$<span class="br0">&#40;</span><span class="kw2">pidof</span> signal_test<span class="br0">&#41;</span>
<span class="co4">student@uso:~$ </span><span class="kw2">kill</span> <span class="re5">-9</span> <span class="re1">$pid_signal</span></pre>

<p>
Scrieți un script care, folosind fișierul <strong><code>/etc/passwd</code></strong>:
</p>
<ul>
<li class="level1"><div class="li"> afișează numărul de shell-uri distincte configurate implicit, pe prima linie</div>
</li>
<li class="level1"><div class="li"> numărul utilizatorilor ce au configurat implicit un shell primit ca parametru, pe a doua linie</div>
</li>
</ul>

<p>
Ca să nu executăm de două ori comanda <strong><code>cut</code></strong> pentru a obține ultima coloană din fișierul <strong><code>/etc/passwd</code></strong>, putem folosi o variabilă intermediară în care reținem output-ul comenzi.
</p>

<p>
Hint:
</p>
<ul>
<li class="level1"><div class="li"> Observați delimitatorul folosit în fișierul <strong><code>/etc/passwd</code></strong>.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> Folosiți <strong><code>echo</code></strong>, pentru a afișa variabila, urmat de pipe și filtrele de text. Aveți grijă la outputul comenzii <strong><code>echo</code></strong>; nu uitați de quoting (din <em>Introducere</em>).</div>
</li>
</ul>
<div class="solution"><div class="solution_title"><span class="title_text">Rezolvare</span></div><div class="solution_contents"><pre class="code bash"><span class="co4">student@uso:~$ </span><span class="kw2">cat</span> script.sh
<span class="co0">#! /bin/bash</span>
&nbsp;
<span class="re2">temp</span>=$<span class="br0">&#40;</span><span class="kw2">cut</span> <span class="re5">-f7</span> -d: <span class="sy0">/</span>etc<span class="sy0">/</span><span class="kw2">passwd</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw3">echo</span> <span class="st0">&quot;<span class="es2">$temp</span>&quot;</span> <span class="sy0">|</span> <span class="kw2">sort</span> <span class="sy0">|</span> <span class="kw2">uniq</span> <span class="sy0">|</span> <span class="kw2">wc</span> <span class="re5">-l</span>
<span class="kw3">echo</span> <span class="st0">&quot;<span class="es2">$temp</span>&quot;</span> <span class="sy0">|</span> <span class="kw2">grep</span> <span class="re4">$1</span> <span class="sy0">|</span> <span class="kw2">wc</span> <span class="re5">-l</span></pre>
</div></div>

</div>
<!-- EDIT30 SECTION "10. Expandarea unei comenzi" [19571-21086] -->
<h2 class="sectionedit31" id="dd">11. dd</h2>
<div class="level2">

<p>
Comanda <strong><code>dd</code></strong> are ca scop principal copierea și conversia fișierelor la nivel de octeți. Deoarece în Linux dispozitivele pot fi accesate prin fișierele din directorul /dev, putem copia partiții întregi sau doar o parte din ele cu acest utilitar.
</p>
<pre class="code bash"><span class="kw2">dd</span> <span class="re2">if</span>=FIȘIER_INTRARE <span class="re2">of</span>=FIȘIER_IEȘIRE <span class="re2">bs</span>=DIMENSIUNE_BLOC <span class="re2">count</span>=NUMĂR_BLOCURI</pre>

<p>
De obicei parametrul bs (byte size) este o putere a lui 2 (ex: 512, 1024, 2048 etc.).
</p>

<p>
Scrieți un script care construiește un fișier conținând un număr n de octeți de 0, unde n este un multiplu de 1024. Numele fișierului și numărul n scriptul le primește ca parametrii.
</p>
<pre class="code bash">.<span class="sy0">/</span>script.sh NUME_FIȘIER NUMĂR_BLOCURI</pre>
<ul>
<li class="level1"><div class="li"> Atenție la diferența între octetul 0 și caracterul &#039;0&#039;.</div>
</li>
<li class="level1"><div class="li"> Folosiți dispozitivul <strong><code>/dev/zero</code></strong> pentru a obține un șir cu octeți de 0.</div>
</li>
</ul>
<div class="solution"><div class="solution_title"><span class="title_text">Rezolvare</span></div><div class="solution_contents"><pre class="code bash"><span class="co4">student@uso:~$ </span><span class="kw2">cat</span> script.sh
<span class="co0">#! /bin/bash</span>
&nbsp;
<span class="kw2">dd</span> <span class="re2">if</span>=<span class="sy0">/</span>dev<span class="sy0">/</span>zero <span class="re2">of</span>=<span class="re4">$1</span> <span class="re2">bs</span>=<span class="nu0">1024</span> <span class="re2">count</span>=<span class="re4">$2</span></pre>
</div></div>

<p>
Modificați scriptul să afișeze doar numărul total de octeți. Folosiți filtrele de text învățate din laborator.
</p>
<ul>
<li class="level1"><div class="li"> Comanda <strong><code>dd</code></strong> afișează la ieșirea de eroare (altfel zis stderr). Redirectați ieșirea de eroare într-un fișier din directorul curent folosind operatorul <strong><code>2&gt;</code></strong></div>
</li>
</ul>
<pre class="code bash"><span class="kw2">dd</span> LISTĂ_PARAMETRII <span class="nu0">2</span><span class="sy0">&gt;</span> FIȘIER</pre>
<ul>
<li class="level1"><div class="li"> Vrem să ne asigurăm că operația <strong><code>dd</code></strong> se execută cu succes pentru a aplica după filtrele de text peste ce afișează comanda. Ce operator folosim?</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> Faceți curat la ieșirea din script, ștergând fișierul temporar folosit.</div>
</li>
</ul>
<div class="solution"><div class="solution_title"><span class="title_text">Rezolvare</span></div><div class="solution_contents"><pre class="code bash"><span class="co4">student@uso:~$ </span><span class="kw2">cat</span> script.sh
<span class="co0">#! /bin/bash</span>
&nbsp;
<span class="kw2">dd</span> <span class="re2">if</span>=<span class="sy0">/</span>dev<span class="sy0">/</span>zero <span class="re2">of</span>=<span class="re4">$1</span> <span class="re2">bs</span>=<span class="nu0">1024</span> <span class="re2">count</span>=<span class="re4">$2</span> <span class="nu0">2</span><span class="sy0">&gt;</span> .<span class="sy0">/</span>tmp_file <span class="sy0">&amp;&amp;</span> <span class="kw2">tail</span> <span class="re5">-n</span> <span class="nu0">1</span> .<span class="sy0">/</span>tmp_file <span class="sy0">|</span> <span class="kw2">cut</span> <span class="re5">-d</span> <span class="st_h">' '</span> <span class="re5">-f</span> <span class="nu0">1</span>
<span class="kw2">rm</span> .<span class="sy0">/</span>tmp_file</pre>
</div></div>

<p>
<p><div class="noteclassic">O metoda mai bună de a folosi fișiere temporare este să folosim directorul <strong><code>/tmp</code></strong>. De ce? 
</div></p>
</p>

</div>
<!-- EDIT31 SECTION "11. dd" [21087-22997] -->
<h2 class="sectionedit32" id="readline">12. Readline</h2>
<div class="level2">

<p>
<a href="http://tiswww.case.edu/php/chet/readline/rltop.html" class="urlextern" title="http://tiswww.case.edu/php/chet/readline/rltop.html"  rel="nofollow">Readline</a> este o facilitate care ajută la editarea eficientă a comenzilor pe care le scriem în shell. Vom explora câteva concepte utile.
</p>
<ul>
<li class="level1"><div class="li"> Creați un director care se numește <strong><code>supercalifragilisticexpialidocious</code></strong>.</div>
</li>
</ul>

<p>
<p><div class="notetip">
Combinația Shift-Insert este o scurtătură pentru Paste în terminal. Puteți face copy-paste pe numele de mai sus.

</div></p>
</p>
<ul>
<li class="level1"><div class="li"> Ce rol are combinația de taste <strong><code>Alt-.</code></strong> (Alt și punct)?</div>
<ul>
<li class="level2"><div class="li"> Folosiți tasta <strong><code>Alt</code></strong> din stânga tastaturii.</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> Folosiți această combinație pentru a șterge directorul creat.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> Repetați ultima comandă de tip <strong><code>mkdir</code></strong> folosind <em>reverse search</em>.  Puteți citi mai multe despre acest concept <a href="http://www.linuxjournal.com/article/7385?page=0,2" class="urlextern" title="http://www.linuxjournal.com/article/7385?page=0,2"  rel="nofollow">aici</a>, secțiunea <em>Searching the command history</em>.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> Scrieți în terminal comanda <strong><code>rm -rf /tmp</code></strong>. Nu apăsați enter. </div>
<ul>
<li class="level2"><div class="li"> Folosiți combinația de taste <strong><code>Alt-#</code></strong> (Alt și diez). </div>
</li>
<li class="level2"><div class="li"> Ce s-ar fi întâmplat dacă executam comanda?</div>
</li>
</ul>
</li>
</ul>
<div class="solution"><div class="solution_title"><span class="title_text">Rezolvare</span></div><div class="solution_contents"><pre class="code bash"><span class="kw2">mkdir</span> supercalifragilisticexpialidocious
<span class="kw2">rm</span> <span class="sy0">&lt;</span>Alt-.<span class="sy0">&gt;</span>
<span class="sy0">&lt;</span>Ctrl-r<span class="sy0">&gt;</span> + <span class="kw2">mkdir</span>
<span class="kw2">rm</span> <span class="re5">-rf</span> <span class="sy0">&lt;</span>Alt-<span class="co0">#&gt;</span></pre>
</div></div>

</div>
<!-- EDIT32 SECTION "12. Readline" [22998-] --></div>
</body>
</html>
