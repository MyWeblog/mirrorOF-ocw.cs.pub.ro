    
    

<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <title>ic:laboratoare:02</title>
<meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="date" content="2016-10-11T11:09:00+0300"/>
<meta name="keywords" content="ic,laboratoare,02"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../../../lib/exe/opensearch.php" title="CS Open CourseWare"/>
<link rel="start" href="../../../../../courses.1.html"/>
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="../../../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="../../../../feed.php%3Fmode=list&amp;ns=ic:laboratoare"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="02.html"/>
<link rel="canonical" href="../../../../ic/laboratoare/02.html"/>
<link rel="stylesheet" type="text/css" href="../../../../lib/exe/css.php%3Ft=arctic&amp;tseed=1476798676.css"/>
<script type="text/javascript">/*<![CDATA[*/var NS='ic:laboratoare';var JSINFO = {"id":"ic:laboratoare:02","namespace":"ic:laboratoare","isadmin":0,"isauth":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../../../lib/exe/js.php%3Ftseed=1476798676"></script>
<script type="text/x-mathjax-config">/*<![CDATA[*/MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ["$","$"], ["\\(","\\)"] ],
        displayMath: [ ["$$","$$"], ["\\[","\\]"] ],
        processEscapes: true
    }
});
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<script type="text/javascript">/*<![CDATA[*/
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
		  
/*!]]>*/</script>
<script type="text/javascript">/*<![CDATA[*/
var pageTracker = _gat._getTracker("UA-38383934-1");
pageTracker._initData();
pageTracker._trackPageview();
		  
/*!]]>*/</script>
</head>
<body>
<div class="dokuwiki export">
<!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level2"><div class="li"><a href="02.html#laboratorul_02_-_shift_and_vigenere_ciphers">Laboratorul 02 - Shift and Vigenère ciphers</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="02.html#exercise_1_2p">Exercise 1 (2p)</a></div></li>
<li class="level3"><div class="li"><a href="02.html#exercise_2_4p">Exercise 2 (4p)</a></div></li>
<li class="level3"><div class="li"><a href="02.html#exercise_3_4p">Exercise 3 (4p)</a></div></li>
<li class="level3"><div class="li"><a href="02.html#bonusexercise_4_3p">Bonus: Exercise 4 (3p)</a></div></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h2 class="sectionedit1" id="laboratorul_02_-_shift_and_vigenere_ciphers">Laboratorul 02 - Shift and Vigenère ciphers</h2>
<div class="level2">

<p>
Please download the lab skeleton from here: <a href="../../../../_media/ic/laboratoare/lab2.zip" class="media mediafile mf_zip" title="ic:laboratoare:lab2.zip (88.3 KB)">lab2.zip</a>
The archive contains the following:
</p>
<ul>
<li class="level1"><div class="li"> <strong>format_funcs.py</strong>: the format functions from the previous lab;</div>
</li>
<li class="level1"><div class="li"> <strong>caesar.py</strong>: the implementation of the Caesar encryption and decryption from the previous lab;</div>
</li>
<li class="level1"><div class="li"> <strong>msg_ex2.txt</strong>: the text which needs to be decrypted for exercise 2;</div>
</li>
<li class="level1"><div class="li"> <strong>msg_ex3.txt</strong>: the text which needs to be decrypted for exercise 3;</div>
</li>
<li class="level1"><div class="li"> <strong>ex1.py</strong>: implementation of exercise 1;</div>
</li>
<li class="level1"><div class="li"> <strong>ex2.py</strong>: implementation of exercise 2;</div>
</li>
<li class="level1"><div class="li"> <strong>ex3.py</strong>: implementation of exercise 3.</div>
</li>
</ul>

<p>
You need to fill in the TODOs from <strong>ex1.py</strong>, <strong>ex2.py</strong> and <strong>ex3.py</strong>.
</p>

</div>
<!-- EDIT1 SECTION "Laboratorul 02 - Shift and Vigenère ciphers" [1-698] -->
<h3 class="sectionedit2" id="exercise_1_2p">Exercise 1 (2p)</h3>
<div class="level3">

<p>
Alice sends Bob the following ciphertexts:
</p>
<pre class="code">LDPWKHORUGBRXUJRG
XNTRGZKKGZUDMNNSGDQFNCRADENQDLD
DTZXMFQQSTYRFPJDTZWXJQKFSDLWFAJSNRFLJ
SIOMBUFFHINNUEYNBYHUGYIZNBYFILXSIOLAIXCHPUCH
ERZRZOREGURFNOONGUQNLGBXRRCVGUBYL
CJIJPMTJPMAVOCZMVIYTJPMHJOCZM
DTZXMFQQSTYRZWIJW
ZPVTIBMMOPUDPNNJUBEVMUFSZ
FVBZOHSSUVAZALHS
KAGETMXXZAFSUHQRMXEQFQEFUYAZKMSMUZEFKAGDZQUSTNAGD
MCIGVOZZBCHRSGWFSOBMHVWBUHVOHPSZCBUGHCMCIFBSWUVPCIF</pre>

<p>
Charlie manages to capture the ciphertexts and he finds that the cipher used for
encryption is the shift cipher (each message possibly encrypted with a different
key). Can you decrypt the messages ?
</p>

<p>
Charlie also knows that the plaintext consists only of the English letters A to
Z (all capitals, no punctuation).
</p>

<p>
<p><div class="notetip"><strong>Hint:</strong> What do all the plain texts have in common? The answer is YOU.
</div></p>
</p>

</div>
<!-- EDIT2 SECTION "Exercise 1 (2p)" [699-1551] -->
<h3 class="sectionedit3" id="exercise_2_4p">Exercise 2 (4p)</h3>
<div class="level3">

<p>
Alice sends Bob another ciphertext, but much longer this time:
</p>

<p>
<a href="../../../../_media/sasc/laboratoare/sasc_msg_lab1.txt" class="media mediafile mf_txt" title="sasc:laboratoare:sasc_msg_lab1.txt (8.9 KB)">Download message file</a>
</p>

<p>
Charlie needs to decrypt this as well. Some colleagues tell him this is encrypted
using the substitution cipher, and that again the plaintext consists only of the English letters <strong>A</strong> to <strong>Z</strong> (all capitals, no punctuation). Try to help Charlie to decrypt this.
</p>

<p>
Hint: use the frequency analysis mechanisms we discussed in class. Note that the frequency of each letter does not map precisely. In particular, the most frequent two letters do match well with the given table, but the others are sometimes mixed. However, Charlie knows that the most frequent bi-grams are the following (from most frequent to less frequent):
<strong>TH</strong>, <strong>HE</strong>, <strong>IN</strong>, <strong>OR</strong>, <strong>HA</strong>, <strong>ET</strong>, <strong>AN</strong>, <strong>EA</strong>, <strong>IS</strong>, <strong>OU</strong>, <strong>HI</strong>, <strong>ER</strong>, <strong>ST</strong>, <strong>RE</strong>, <strong>ND</strong>
</p>

<p>
With this information, can you tell what the ciphertext is about?
</p>

</div>
<!-- EDIT3 SECTION "Exercise 2 (4p)" [1552-2515] -->
<h3 class="sectionedit4" id="exercise_3_4p">Exercise 3 (4p)</h3>
<div class="level3">

<p>
Charlie manages to capture <a href="../../../../_media/sasc/laboratoare/sasc_msg_lab2.txt" class="media mediafile mf_txt" title="sasc:laboratoare:sasc_msg_lab2.txt (169.9 KB)">a last communication</a> which turns out to be the most important, so it is crucial he decrypts it. However, this time Alice used the Vigenere cipher, with a key that Charlie knows has <strong>7</strong> characters.
</p>

<p>
The ciphertext is in the file attached. Try the method of multiplying probabilities as explained in class and see if you can decrypt the ciphertext. You can find details about this method <a href="http://www.cs.mtu.edu/~shene/NSF-4/Tutorial/VIG/Vig-Recover.html" class="urlextern" title="http://www.cs.mtu.edu/~shene/NSF-4/Tutorial/VIG/Vig-Recover.html"  rel="nofollow">here</a>.
</p>

<p>
These are the known frequencies of the plaintext:
</p>
<pre class="code">{&#039;A&#039;: 0.07048643054277828,
&#039;C&#039;: 0.01577161913523459,
&#039;B&#039;: 0.012074517019319227,
&#039;E&#039;: 0.13185372585096597,
&#039;D&#039;: 0.043393514259429625,
&#039;G&#039;: 0.01952621895124195,
&#039;F&#039;: 0.023867295308187673,
&#039;I&#039;: 0.06153403863845446,
&#039;H&#039;: 0.08655128794848206,
&#039;K&#039;: 0.007566697332106716,
&#039;J&#039;: 0.0017594296228150873,
&#039;M&#039;: 0.029657313707451703,
&#039;L&#039;: 0.04609015639374425,
&#039;O&#039;: 0.07679967801287949,
&#039;N&#039;: 0.060217341306347746,
&#039;Q&#039;: 0.0006382244710211592,
&#039;P&#039;: 0.014357175712971482,
&#039;S&#039;: 0.05892939282428703,
&#039;R&#039;: 0.05765294388224471,
&#039;U&#039;: 0.02749540018399264,
&#039;T&#039;: 0.09984475620975161,
&#039;W&#039;: 0.01892824287028519,
&#039;V&#039;: 0.011148804047838086,
&#039;Y&#039;: 0.023045078196872126,
&#039;X&#039;: 0.0005289788408463661,
&#039;Z&#039;: 0.00028173873045078196}</pre>

</div>
<!-- EDIT4 SECTION "Exercise 3 (4p)" [2516-3835] -->
<h3 class="sectionedit5" id="bonusexercise_4_3p">Bonus: Exercise 4 (3p)</h3>
<div class="level3">

<p>
In class we explained that the one time pad is malleable (i.e. we can easily change the encrypted plaintext by simply modifying the ciphertext). We have also discussed how the CRC was a very bad idea in the design of WEP due to its linearity.
</p>

<p>
You are given the following ciphertext in hexadecimal:
</p>
<pre class="code">021e0e061d1694c9</pre>

<p>
which you know it corresponds to the concatenation of the message “floare” with its CRC-16 (in hexa “8E31”) obtained from this website:
<a href="http://www.lammertbies.nl/comm/info/crc-calculation.html" class="urlextern" title="http://www.lammertbies.nl/comm/info/crc-calculation.html"  rel="nofollow">http://www.lammertbies.nl/comm/info/crc-calculation.html</a>
</p>

<p>
If we need to modify the ciphertext so that a correct decryption outputs “albina” instead of “floare” and such that the CRC-16 calculation remains correct, what is the modification we need to perform?
</p>

<p>
Output the new ciphertext after the necessary modifications and show that it correctly leads to the plaintext “albina” and a correct computation of its CRC-16.
</p>

<p>
You might find this starting script useful:
</p>
<dl class="code">
<dt><a href="../../../code/ic/laboratoare/02%3Fcodeblock=3" title="Download Snippet" class="mediafile mf_py">ex4_draft.py</a></dt>
<dd><pre class="code python"><span class="kw1">import</span> <span class="kw3">sys</span>
<span class="kw1">import</span> <span class="kw3">random</span>
<span class="kw1">import</span> <span class="kw3">string</span>
<span class="kw1">import</span> <span class="kw3">operator</span>
&nbsp;
<span class="kw1">def</span> strxor<span class="br0">&#40;</span>a<span class="sy0">,</span> b<span class="br0">&#41;</span>: <span class="co1"># xor two strings (trims the longer input)</span>
  <span class="kw1">return</span> <span class="st0">&quot;&quot;</span>.<span class="me1">join</span><span class="br0">&#40;</span><span class="br0">&#91;</span><span class="kw2">chr</span><span class="br0">&#40;</span><span class="kw2">ord</span><span class="br0">&#40;</span>x<span class="br0">&#41;</span> ^ <span class="kw2">ord</span><span class="br0">&#40;</span>y<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">for</span> <span class="br0">&#40;</span>x<span class="sy0">,</span> y<span class="br0">&#41;</span> <span class="kw1">in</span> <span class="kw2">zip</span><span class="br0">&#40;</span>a<span class="sy0">,</span> b<span class="br0">&#41;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">def</span> hexxor<span class="br0">&#40;</span>a<span class="sy0">,</span> b<span class="br0">&#41;</span>: <span class="co1"># xor two hex strings (trims the longer input)</span>
  ha <span class="sy0">=</span> a.<span class="me1">decode</span><span class="br0">&#40;</span><span class="st0">'hex'</span><span class="br0">&#41;</span>
  hb <span class="sy0">=</span> b.<span class="me1">decode</span><span class="br0">&#40;</span><span class="st0">'hex'</span><span class="br0">&#41;</span>
  <span class="kw1">return</span> <span class="st0">&quot;&quot;</span>.<span class="me1">join</span><span class="br0">&#40;</span><span class="br0">&#91;</span><span class="kw2">chr</span><span class="br0">&#40;</span><span class="kw2">ord</span><span class="br0">&#40;</span>x<span class="br0">&#41;</span> ^ <span class="kw2">ord</span><span class="br0">&#40;</span>y<span class="br0">&#41;</span><span class="br0">&#41;</span>.<span class="me1">encode</span><span class="br0">&#40;</span><span class="st0">'hex'</span><span class="br0">&#41;</span> <span class="kw1">for</span> <span class="br0">&#40;</span>x<span class="sy0">,</span> y<span class="br0">&#41;</span> <span class="kw1">in</span> <span class="kw2">zip</span><span class="br0">&#40;</span>ha<span class="sy0">,</span> hb<span class="br0">&#41;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">def</span> main<span class="br0">&#40;</span><span class="br0">&#41;</span>:
&nbsp;
  <span class="co1">#Plaintexts</span>
  s1 <span class="sy0">=</span> <span class="st0">'floare'</span>
  s2 <span class="sy0">=</span> <span class="st0">'albina'</span>
  G <span class="sy0">=</span> <span class="st0">''</span> <span class="co1">#To find</span>
&nbsp;
  <span class="co1">#Obtain crc of s1</span>
  <span class="co1">#See this site:</span>
  <span class="co1">#http://www.lammertbies.nl/comm/info/crc-calculation.html</span>
  x1 <span class="sy0">=</span> s1.<span class="me1">encode</span><span class="br0">&#40;</span><span class="st0">'hex'</span><span class="br0">&#41;</span>
  x2 <span class="sy0">=</span> s2.<span class="me1">encode</span><span class="br0">&#40;</span><span class="st0">'hex'</span><span class="br0">&#41;</span>
  <span class="kw1">print</span> <span class="st0">&quot;x1: &quot;</span> + x1
  crc1 <span class="sy0">=</span> <span class="st0">'8E31'</span> <span class="co1">#CRC-16 of x1</span>
&nbsp;
  <span class="co1">#Compute delta (xor) of x1 and x2:</span>
  xd <span class="sy0">=</span> hexxor<span class="br0">&#40;</span>x1<span class="sy0">,</span> x2<span class="br0">&#41;</span>
  <span class="kw1">print</span> <span class="st0">&quot;xd: &quot;</span> + xd
&nbsp;
&nbsp;
<span class="kw1">if</span> __name__ <span class="sy0">==</span> <span class="st0">&quot;__main__&quot;</span>:
  main<span class="br0">&#40;</span><span class="br0">&#41;</span></pre>
</dd></dl>

<p>
<p><div class="notetip">
Use the property for CRC-16 that CRC(m XOR d) = CRC(m) XOR CRC(d).
</p>

<p>
If d = &#039;floare&#039; XOR &#039;albina&#039; and C = [C1 | C2] = [m XOR G1 | CRC(m) XOR G2], then C1&#039; = C1 XOR d.

</div></p>
</p>

</div>
<!-- EDIT5 SECTION "Bonus: Exercise 4 (3p)" [3836-] --></div>
</body>
</html>
