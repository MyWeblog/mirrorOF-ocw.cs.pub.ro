    
    

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
 lang="en" dir="ltr">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
    Lab 03 - PRGs    [CS Open CourseWare]
  </title>

  <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="date" content="2016-04-25T13:10:42+0300"/>
<meta name="keywords" content="sasc,laboratoare,03"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../lib/exe/opensearch.php" title="CS Open CourseWare"/>
<link rel="start" href="../../../courses.1.html"/>
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="../../feed.php%3Fmode=list&amp;ns=sasc:laboratoare"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="../../_export/xhtml/sasc/laboratoare/03.html"/>
<link rel="canonical" href="03.html"/>
<link rel="stylesheet" type="text/css" href="../../lib/exe/css.php%3Ft=arctic&amp;tseed=1476798676.css"/>
<script type="text/javascript">/*<![CDATA[*/var NS='sasc:laboratoare';var JSINFO = {"id":"sasc:laboratoare:03","namespace":"sasc:laboratoare","isadmin":0,"isauth":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../lib/exe/js.php%3Ftseed=1476798676"></script>
<script type="text/x-mathjax-config">/*<![CDATA[*/MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ["$","$"], ["\\(","\\)"] ],
        displayMath: [ ["$$","$$"], ["\\[","\\]"] ],
        processEscapes: true
    }
});
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<script type="text/javascript">/*<![CDATA[*/
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
		  
/*!]]>*/</script>
<script type="text/javascript">/*<![CDATA[*/
var pageTracker = _gat._getTracker("UA-38383934-1");
pageTracker._initData();
pageTracker._trackPageview();
		  
/*!]]>*/</script>

  <link rel="shortcut icon" href="../../lib/tpl/arctic/images/favicon.ico" />

  
</head>
<body>
<div id="wrapper" class='show'>
  <div class="dokuwiki">

    
    <div class="stylehead">
      <div class="header">
        <div class="pagename">
          <a href="../index.html"><img height="70" src="../../res/sigla_cs.png"/> </a>        </div>
        <div class="logo">
          <a style="color: #AAA !important;" href="../../../courses.1.html"/>Open CourseWare</a>        </div>
      </div>
    
       
      <div class="breadcrumbs">
              </div>
      
            </div>

                  <div class="bar" id="bar__top">
        <div class="bar-left">
                  </div>
        <div class="bar-right">
          <a href="03%3Fdo=recent.html"  class="action recent" accesskey="r" rel="nofollow" title="Recent changes [R]">Recent changes</a><a href="03%3Fdo=login&amp;sectok=f62420cf5b01253da4b50505d148181b.html"  class="action login" rel="nofollow" title="Login">Login</a>        </div>
    </div>
        
    
    
    
              <div class="left_page">
          
<h2 class="sectionedit1" id="lab_03_-_prgs">Lab 03 - PRGs</h2>
<div class="level2">

</div>

<h3 class="sectionedit2" id="exercise_1_4p">Exercise 1 (4p)</h3>
<div class="level3">

<p>
Advantage. The purpose of this problem is to clarify the concept of advantage. Consider the following two experiments $\mathsf{EXP}(0)$ and $\mathsf{EXP}(1)$:
</p>
<ul>
<li class="level1"><div class="li"> In $\mathsf{EXP}(0)$ the challenger flips a fair coin (probability $1/2$ for HEADS and $1/2$ for TAILS) and sends the result to the adversary $\mathsf{A}$.</div>
</li>
<li class="level1"><div class="li"> In $\mathsf{EXP}(1)$ the challenger always sends TAILS to the adversary.</div>
</li>
</ul>

<p>
Let r = 0 for HEADS and r = 1 for TAILS. Then we have the experiment as shown below:
<a href="../../_detail/sasc/laboratoare/adversar_prg.png%3Fid=sasc%253Alaboratoare%253A03.html" class="media" title="sasc:laboratoare:adversar_prg.png"><img src="../../_media/sasc/laboratoare/adversar_prg.png%3Fw=400&amp;tok=d01585" class="media" alt="" width="400" /></a>
</p>

<p>
The adversary’s goal is to distinguish these two experiments: at the end of each experiment the adversary outputs a bit $0$ or $1$ for its guess for which experiment it is in. For $b = 0,1$ let $W_{b}$ be the event that in experiment $b$ the adversary output $1$. The adversary tries to maximize its distinguishing advantage, namely the quantity
$\mathsf{Adv} = \left| \mathsf{Pr}\left[W_{0}\right] − \mathsf{Pr}\left[W_{1}\right] \right| \in \left[0, 1\right]$ .
</p>

<p>
The advantage $\mathsf{Adv}$ captures the adversary’s ability to distinguish the two experiments. If the advantage is $0$ then the adversary behaves exactly the same in both experiments and therefore does not distinguish between them. If the advantage is $1$ then the adversary can tell perfectly what experiment it is in. If the advantage is negligible for all efficient adversaries (as defined in class) then we say that the two experiments are indistinguishable.
</p>

<p>
a. Calculate the advantage of each of the following adversaries:
</p>
<ul>
<li class="level1"><div class="li"> A1: Always output $1$.</div>
</li>
<li class="level1"><div class="li"> A2: Ignore the result reported by the challenger, and randomly output $0$ or $1$ with even probability.</div>
</li>
<li class="level1"><div class="li"> A3: Output $1$ if HEADS was received from the challenger, else output $0$.</div>
</li>
<li class="level1"><div class="li"> A4: Output $0$ if HEADS was received from the challenger, else output $1$.</div>
</li>
<li class="level1"><div class="li"> A5: If HEADS was received, output $1$. If TAILS was received, randomly output $0$ or $1$ with even probability.</div>
</li>
</ul>

<p>
b. What is the maximum advantage possible in distinguishing these two experiments? Explain why.
</p>

</div>

<h3 class="sectionedit3" id="exercise_2_4p">Exercise 2 (4p)</h3>
<div class="level3">

<p>
Let&#039;s use the experiment defined earlier as a pseudorandom generator ($\mathsf{PRG}$) as follows:
</p>
<ol>
<li class="level1"><div class="li"> Set a desired output length $n$</div>
</li>
<li class="level1"><div class="li"> Obtain a random sequence $R$ of bits of length $n$ (say flipping a coin, using a Linear-congruential generator, or any other method)</div>
</li>
<li class="level1"><div class="li"> For each bit $r$ in the random sequence $R$ generated in the previous step, output a bit $b$ as follows:</div>
</li>
</ol>
<ul>
<li class="level1"><div class="li"> if the bit $r$ is $0$, then output a random bit $b$ (e.g. flip a coin and output either $0$ or $1$ depending on its result)</div>
</li>
<li class="level1"><div class="li"> if the bit $r$ is $1$, then output $1$</div>
</li>
</ul>

<p>
a. Implement the frequency (monobit) test from <a href="http://csrc.nist.gov/publications/nistpubs/800-22-rev1a/SP800-22rev1a.pdf" class="urlextern" title="http://csrc.nist.gov/publications/nistpubs/800-22-rev1a/SP800-22rev1a.pdf"  rel="nofollow"> NIST (see section 2.1)</a> and check if a sequence generated by the above $\mathsf{PRG}$ (say $n=100$) seems random or not.
</p>

<p>
b. Run the test on a random bitstring (e.g. a string such as R used by the above $\mathsf{PRG}$), and compare the result of the test.
</p>

<p>
If the two results are different across many iterations, this test already gives you an attacker that breaks the $\mathsf{PRG}$.
</p>

<p>
<p><div class="notetip">You may use a function like this to generate a random bitstring
</div></p>
</p>
<pre class="code python"><span class="kw1">import</span> <span class="kw3">random</span>
&nbsp;
<span class="kw1">def</span> get_random_string<span class="br0">&#40;</span>n<span class="br0">&#41;</span>: <span class="co1">#generate random bit string</span>
  bstr <span class="sy0">=</span> bin<span class="br0">&#40;</span><span class="kw3">random</span>.<span class="me1">getrandbits</span><span class="br0">&#40;</span>n<span class="br0">&#41;</span><span class="br0">&#41;</span>.<span class="me1">lstrip</span><span class="br0">&#40;</span><span class="st0">'0b'</span><span class="br0">&#41;</span>.<span class="me1">zfill</span><span class="br0">&#40;</span>n<span class="br0">&#41;</span>
  <span class="kw1">return</span> bstr</pre>

<p>
<p><div class="notetip">Also, in Python you may find the functions sqrt, fabs and erfc from the module math useful
</div></p>
</p>

</div>

<h3 class="sectionedit4" id="exercise_3_-_lfsr_2p">Exercise 3 - LFSR (2p)</h3>
<div class="level3">

<p>
In this exercise we&#039;ll build a simple Linear Feedback Shift Register (LFSR). LFSRs produce random bit strings with good statistical properties, but are very easy to predict.
</p>

<p>
The register is a sequence of $n$ bits; a LFSR is defined by:
</p>
<ul>
<li class="level1"><div class="li"> an initial state (the initial bit contents of the register)</div>
</li>
<li class="level1"><div class="li"> a polynomial that describes how bit shifts should be performed</div>
</li>
</ul>

<p>
For example, given an $18$ bit LFSRm the polynomial $X^{18} + X^{11} + 1$ and the initial state:
</p>
<pre class="code">  state = &#039;001001001001001001&#039;
                     *      *</pre>

<p>
we generate a new bit $b$ by $\mathsf{xor}$-ing bits $11$ ($0$) and $18$ ($1$), thus obtaining $b = 1$. We then shift the whole register to the right (thus dropping the right-most bit, which is the bit we add to the generated random sequence) and insert $b$ to the left. Thus, the new state is:
</p>
<pre class="code">  state = &#039;100100100100100100&#039;</pre>

<p>
The process is repeated until the desired number of bits have been generated.
</p>

<p>
Using the above starting state and polynomial, generate $100$ random bits and run the monobit statistical test from the previous exercise to see if their frequency seems random.
</p>

</div>

        </div>
        <div class="right_sidebar">
          <form action="../../start.html" accept-charset="utf-8" class="search" id="dw__search" method="get"><div class="no"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch__in" accesskey="f" name="id" class="edit" title="[F]" /><input type="submit" value="Search" class="button" title="Search" /><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>          <div class="namespace_sidebar sidebar_box">

<h1 class="sectionedit1" id="laboratoare">Laboratoare</h1>
<div class="level1">

<div><div id="nojs_indexmenu_62476859058355bb020257" data-jsajax="" class="indexmenu_nojs">

<ul class="idx">
<li class="level1"><div class="li"><a href="01.html" class="wikilink1" title="sasc:laboratoare:01">Lab 01 - Introduction</a></div></li>
<li class="level1"><div class="li"><a href="02.html" class="wikilink1" title="sasc:laboratoare:02">Lab 02 - OTP and Stream Ciphers</a></div></li>
<li class="level1"><div class="li"><span class="curid"><a href="03.html" class="wikilink1" title="sasc:laboratoare:03">Lab 03 - PRGs</a></span></div></li>
<li class="level1"><div class="li"><a href="04.html" class="wikilink1" title="sasc:laboratoare:04">Lab 04 - PRFs and PRPs</a></div></li>
<li class="level1"><div class="li"><a href="05.html" class="wikilink1" title="sasc:laboratoare:05">Lab 05 - DES</a></div></li>
<li class="level1"><div class="li"><a href="06.html" class="wikilink1" title="sasc:laboratoare:06">Lab 06 - CBC Padding Attack</a></div></li>
<li class="level1"><div class="li"><a href="07.html" class="wikilink1" title="sasc:laboratoare:07">Lab 07 - Correlation Power Analysis</a></div></li>
<li class="level1"><div class="li"><a href="08.html" class="wikilink1" title="sasc:laboratoare:08">Lab 08 - MACs</a></div></li>
<li class="level1"><div class="li"><a href="09.html" class="wikilink1" title="sasc:laboratoare:09">Lab 09 - OpenSSL MACs and Hashes</a></div></li>
<li class="level1"><div class="li"><a href="10.html" class="wikilink1" title="sasc:laboratoare:10">Lab 10 - OpenSSL AEAD</a></div></li>
</ul>
</div></div>

</div>
<!-- EDIT1 SECTION "Laboratoare" [1-61] -->
<h1 class="sectionedit2" id="resurse">Resurse</h1>
<div class="level1">

<div><div id="nojs_indexmenu_65803179758355bb022196" data-jsajax="" class="indexmenu_nojs">

<ul class="idx">
<li class="level1"><div class="li"><a href="../res/stuff.html" class="wikilink1" title="sasc:res:stuff">Diverse exercitii</a></div></li>
<li class="level1"><div class="li"><a href="../res/tema1.html" class="wikilink1" title="sasc:res:tema1">Homework 1</a></div></li>
<li class="level1"><div class="li"><a href="../res/tema2.html" class="wikilink1" title="sasc:res:tema2">Homework 2</a></div></li>
</ul>
</div></div>

</div>
<!-- EDIT2 SECTION "Resurse" [62-] -->
</div>
<div class="toc_sidebar sidebar_box">
<!-- TOC START -->
<div id="sb__right__dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level2"><div class="li"><a href="03.html#lab_03_-_prgs">Lab 03 - PRGs</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="03.html#exercise_1_4p">Exercise 1 (4p)</a></div></li>
<li class="level3"><div class="li"><a href="03.html#exercise_2_4p">Exercise 2 (4p)</a></div></li>
<li class="level3"><div class="li"><a href="03.html#exercise_3_-_lfsr_2p">Exercise 3 - LFSR (2p)</a></div></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->
</div>
        </div>
      
    
      <div class="stylefoot">
        <div class="meta">
          <div class="user">
                    </div>
          <div class="doc">
          sasc/laboratoare/03.txt · Last modified: 2016/04/25 13:10 by sergiu.costea          </div>
        </div>
      </div>

    <div class="clearer"></div>

    
                <div class="bar" id="bar__bottom">
      <div class="bar-left">
              </div>
      <div class="bar-right">
        <a href="03%3Fdo=media&amp;ns=sasc%253Alaboratoare.html"  class="action media" rel="nofollow" title="Media Manager">Media Manager</a><a href="03.html#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]">Back to top</a>      </div>
    </div>
    <div class="clearer"></div>
            
    <div align="center" class="footerinc">
  <div class="license"><a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license"><img src="../../lib/images/license/button/cc-by-sa.png" alt="CC Attribution-Share Alike 3.0 Unported" /></a></div>
  <a target="_blank" href="http://www.chimeric.de" title="www.chimeric.de"><img src="../../lib/tpl/arctic/images/button-chimeric-de.png" width="80" height="15" alt="www.chimeric.de" border="0" /></a>

  <a target="_blank" href="http://jigsaw.w3.org/css-validator/check/referer" title="Valid CSS"><img src="../../lib/tpl/arctic/images/button-css.png" width="80" height="15" alt="Valid CSS" border="0" /></a>

  <a target="_blank" href="http://wiki.splitbrain.org/wiki:dokuwiki" title="Driven by DokuWiki"><img src="../../lib/tpl/arctic/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" border="0" /></a>

  <a target="_blank" href="http://www.firefox-browser.de" title="do yourself a favour and use a real browser - get firefox"><img src="../../lib/tpl/arctic/images/button-firefox.png" width="80" height="15" alt="do yourself a favour and use a real browser - get firefox!!" border="0" /></a>
  
  <a target="_blank" href="../../feed.php" title="Recent changes RSS feed"><img src="../../lib/tpl/arctic/images/button-rss.png" width="80" height="15" alt="Recent changes RSS feed" border="0" /></a>

  <a target="_blank" href="http://validator.w3.org/check/referer" title="Valid XHTML 1.0"><img src="../../lib/tpl/arctic/images/button-xhtml.png" width="80" height="15" alt="Valid XHTML 1.0" border="0" /></a>
</div>

  </div>
</div>

<div class="no"><img src="../../lib/exe/indexer.php%3Fid=sasc%253Alaboratoare%253A03&amp;1479891888" width="2" height="1" alt="" /></div>
</body>
</html>
