    
    

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
 lang="en" dir="ltr">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
    Laboratorul 05    [CS Open CourseWare]
  </title>

  <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="date" content="2016-11-10T10:43:24+0200"/>
<meta name="keywords" content="egc,laboratoare,05"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../lib/exe/opensearch.php" title="CS Open CourseWare"/>
<link rel="start" href="../../../courses.1.html"/>
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="../../feed.php%3Fmode=list&amp;ns=egc:laboratoare"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="../../_export/xhtml/egc/laboratoare/05.html"/>
<link rel="canonical" href="05.html"/>
<link rel="stylesheet" type="text/css" href="../../lib/exe/css.php%3Ft=arctic&amp;tseed=1476798676.css"/>
<script type="text/javascript">/*<![CDATA[*/var NS='egc:laboratoare';var JSINFO = {"id":"egc:laboratoare:05","namespace":"egc:laboratoare","isadmin":0,"isauth":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../lib/exe/js.php%3Ftseed=1476798676"></script>
<script type="text/x-mathjax-config">/*<![CDATA[*/MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ["$","$"], ["\\(","\\)"] ],
        displayMath: [ ["$$","$$"], ["\\[","\\]"] ],
        processEscapes: true
    }
});
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<script type="text/javascript">/*<![CDATA[*/
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
		  
/*!]]>*/</script>
<script type="text/javascript">/*<![CDATA[*/
var pageTracker = _gat._getTracker("UA-38383934-1");
pageTracker._initData();
pageTracker._trackPageview();
		  
/*!]]>*/</script>

  <link rel="shortcut icon" href="../../lib/tpl/arctic/images/favicon.ico" />

  
</head>
<body>
<div id="wrapper" class='show'>
  <div class="dokuwiki">

    
    <div class="stylehead">
      <div class="header">
        <div class="pagename">
          <a href="../index.html"><img height="70" src="../../res/sigla_cs.png"/> </a>        </div>
        <div class="logo">
          <a style="color: #AAA !important;" href="../../../courses.1.html"/>Open CourseWare</a>        </div>
      </div>
    
       
      <div class="breadcrumbs">
              </div>
      
            </div>

                  <div class="bar" id="bar__top">
        <div class="bar-left">
                  </div>
        <div class="bar-right">
          <a href="05%3Fdo=recent.html"  class="action recent" accesskey="r" rel="nofollow" title="Recent changes [R]">Recent changes</a><a href="05%3Fdo=login&amp;sectok=f62420cf5b01253da4b50505d148181b.html"  class="action login" rel="nofollow" title="Login">Login</a>        </div>
    </div>
        
    
    
    
              <div class="left_page">
          
<h1 class="sectionedit1" id="laboratorul_05">Laboratorul 05</h1>
<div class="level1">

</div>

<h2 class="sectionedit2" id="spatiul_obiect">Spatiul Obiect</h2>
<div class="level2">

<p>
Spatiul obiect mai este denumit si <strong>SPATIUL COORDONATELOR LOCALE</strong>
</p>

<p>
Pentru a putea lucra mai eficient si a reutiliza obiectele 3D definite, in general fiecare obiect este definit intr-un sistem de coordonate propriu. Obiectele simple sau procedurale pot fi definite direct din cod insa majoritatea obiectelor utilizate in aplicatiile 3D sunt specificate in cadrul unui program de modelare gen <strong>3D Studio Max</strong>, <strong>Maya</strong>, <strong>Blender</strong>, etc. Definind independent fiecare obiect 3D, putem sa ii aplicam o serie de transformari de rotatie, scalare si translatie pentru a reda obiectul in scena 3D. Un obiect incarcat poate fi afisat de mai multe ori prin utilizarea unor matrici de <strong>MODELARE</strong> ce mentin transformarile 3D aplicate fiecarei instante a obiectului initial.
</p>

<p>
In general, fiecare obiect 3D este definit cu centrul (sau centrul bazei ca in poza de mai jos) in originea propriului sau sistem de coordonate, deoarece in acest fel pot fi aplicate mai usor transformarile de modelare. Astfel, rotatia si scalarea fata de centrul propriu sunt efectuate intotdeauna fata de origine.
</p>

</div>

<h2 class="sectionedit3" id="spatiul_lume">Spatiul Lume</h2>
<div class="level2">

<p>
Spatiul lume sau <strong>SPATIUL COORDONATELOR GLOBALE</strong> este reprezentat prin intermediul <strong>matricii de modelare</strong>. Aceasta se obtine printr-o serie de <strong>rotatie</strong>, <strong>scalare</strong> si <strong>translatie</strong>. Prin multiplicarea fiecare varf al unui obiect (mesh 3D) cu aceasta matrice, obiectul va fi mutat din spatiul local in spatiul lume, adica se face trecerea de la coordonate locale la coordonate globale.
</p>

<p>
Folosind matrici de modelare diferite putem amplasa un obiect in scena de mai multe ori, in locatii diferite, cu rotatie si scalare diferta daca este necesar. Un exemplu este prezentat in scena din dreapta.
</p>

<p>
<a href="../../_detail/egc/laboratoare/lab05/use_model_matrix.png%3Fid=egc%253Alaboratoare%253A05.html" class="media" title="egc:laboratoare:lab05:use_model_matrix.png"><img src="../../_media/egc/laboratoare/lab05/use_model_matrix.png%3Fw=500&amp;tok=e0ab7a" class="mediacenter" title=" World Space " alt=" World Space " width="500" /></a>
</p>

</div>

<h2 class="sectionedit4" id="spatiul_de_vizualizare">Spatiul de Vizualizare</h2>
<div class="level2">

<p>
Spatiul de vizualizare sau <strong>SPATIUL CAMEREI</strong> este reprezentat de <strong>matricea de vizualizare</strong>.
</p>

<p>
Matricea de modelare pozitioneaza obiectele in scena, in spatiul lume. Dar o scena poate fi vizualizata din mai multe puncte de vedere. Pentru aceasta exista transformarea de vizualizare.
Daca intr-o scena avem mai multe obiecte, fiecare obiect are o matrice de modelare diferita (care l-a mutat din spatiul obiect in spatiul lume), insa toate obiectele au aceeasi matrice de vizualizare. Transformarea de vizualizare este definita pentru intreaga scena.
</p>

<p>
<a href="../../_detail/egc/laboratoare/lab05/word_view_space.png%3Fid=egc%253Alaboratoare%253A05.html" class="media" title="egc:laboratoare:lab05:word_view_space.png"><img src="../../_media/egc/laboratoare/lab05/word_view_space.png" class="mediacenter" title=" World Space and View Space" alt=" World Space and View Space" /></a>
</p>

<p>
In spatiul lume camera poate sa fie considerata ca un obiect avand cele 3 axe locale OX, OY, OZ (vezi poza). Matricea de vizualizare se poate calcula folosind functia <code>glm::lookAt</code>.
</p>
<pre class="code cpp">glm<span class="sy4">::</span><span class="me2">mat4</span> View <span class="sy1">=</span> glm<span class="sy4">::</span><span class="me2">lookAt</span><span class="br0">&#40;</span>glm<span class="sy4">::</span><span class="me2">vec3</span> posCameraLume, glm<span class="sy4">::</span><span class="me2">vec3</span> directieVizualizare, glm<span class="sy4">::</span><span class="me2">vec3</span> cameraUP<span class="br0">&#41;</span><span class="sy4">;</span></pre>

<p>
<a href="../../_detail/egc/laboratoare/lab05/word_view_space2.png%3Fid=egc%253Alaboratoare%253A05.html" class="media" title="egc:laboratoare:lab05:word_view_space2.png"><img src="../../_media/egc/laboratoare/lab05/word_view_space2.png%3Fw=700&amp;tok=eefb27" class="mediacenter" title=" World Space and View Space" alt=" World Space and View Space" width="700" /></a>
</p>

<p>
Vectorul cameraUP se proiecteaza in planul de vizualizare, cu directia de proiectie paralela cu normala la planul de vizualizare. Proiectia acestuia da directia axei verticale a planului de vizualizare.
</p>

<p>
In spatiul lume camera poate fi considerata un simplu obiect 3D asupra caruia aplicam transformarile de rotatie si translatie. Daca in spatiul lume, camera poate fi pozitionata oriunde si poate avea orice orientare, in spatiul de vizualizare (spatiul observator) camera este intotdeauna pozitionata in (0,0,0), si priveste in directia OZ negativa.
</p>

<p>
Matricea de vizualizare contine transformari de rotatie si translatie, la fel ca si matricea de modelare. De aceea, daca tinem scena pe loc si mutam camera, sau daca tinem camera pe loc si rotim/translatam scena, obtinem acelasi efect:
</p>

<p>
<p><div class="noteclassic">
„The engines don’t move the ship at all. The ship stays where it is and the engines move the universe around it.” <br/>

 - Futurama

</div></p>
</p>

<p>
Totusi, cele doua matrici au scopuri diferite. Una este folosita pentru pozitionarea obiectelor in scena, iar cealalta pentru vizualizarea intregii scene din punctul de vedere al camerei.
</p>

<p>
<p><div class="noteclassic">
<strong>Exemplu:</strong> Daca vrem sa ne uitam pe axa <strong>OX</strong>(lume) din pozitia (3, 5, 7) codul corespunzator pentru functia glm::lookAt este:
</p>
<pre class="code cpp">glm<span class="sy4">::</span><span class="me2">lookAt</span><span class="br0">&#40;</span>glm<span class="sy4">::</span><span class="me2">vec3</span><span class="br0">&#40;</span><span class="nu0">3</span>, <span class="nu0">5</span>, <span class="nu0">7</span><span class="br0">&#41;</span>, glm<span class="sy4">::</span><span class="me2">vec3</span><span class="br0">&#40;</span><span class="nu0">1</span>, <span class="nu0">0</span>, <span class="nu0">0</span><span class="br0">&#41;</span>, glm<span class="sy4">::</span><span class="me2">vec3</span><span class="br0">&#40;</span><span class="nu0">0</span>, <span class="nu0">1</span>, <span class="nu0">0</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre>

<p>

</div></p>
</p>

</div>

<h2 class="sectionedit5" id="spatiul_de_proiectie">Spatiul de Proiectie</h2>
<div class="level2">

<p>
Dupa aplicarea transformarii de vizualizare, in spatiul de vizualizare camera se afla in origine si priveste inspre <strong>–OZ</strong>. Pentru a putea vizualiza pe ecran aceasta informatie este necesar sa se faca proiectia spatiului vizualizat de camera intr-un spatiu 2D. Cum spatiul vizibil al camerei poate fi de diferite feluri, cel mai adesea trunchi de piramida (<strong>proiectie perspectiva</strong>) sau paralelipiped (<strong>proiectie ortografica</strong>) in OpenGL este necesara trecerea intru-un spatiu final numit spatiu de Proiectie ce reprezinta un CUB centrat in origine cu dimensiunea 2, deci coordoantele X, Y, Z intre +1 si -1.
</p>

<p>
Din spatiul de proiectie este foarte usor matematic sa obtinem proiectia finala 2D pe viewport fiind nevoie doar sa mapam informatia din cubul [-1,1] scalata corespunzator pe viewport-ul definit de aplicatie.
</p>

</div>

<h3 class="sectionedit6" id="matricea_de_proiectie">Matricea de Proiectie</h3>
<div class="level3">

<p>
Trecerea din spatiul de vizualizare in spatiul de proiectie se face tot utilizand o <strong>matrice de proiectie</strong> calcualta in functie de tipul de proiecte definit. Biblioteca <strong>GLM</strong> ofera functii de calcul pentru cele mai utilizate 2 metode de proiecte in aplicatiile 3D, anume: proiectia <strong>Perspectiva</strong> si <strong>Ortografica</strong>
</p>

<p>
Datele (varfurile din spatiul de vizualizare) sunt inmultite cu <strong>matricea de proiectie</strong> pentru a se obtine pozitiile corespunzatoare din spatiul de proiectie.
</p>

</div>

<h3 class="sectionedit7" id="proiectia_ortografica">Proiectia Ortografica</h3>
<div class="level3">

<p>
In proiectia ortografica observatorul este plasat la infinit. Distanta pana la geometrie nu influenteaza proiectia si deci nu se poate determina vizibil din proiectie. Proiectia ortografica pastreaza paralelismul liniilor din scena.
</p>

<p>
<a href="../../_detail/egc/laboratoare/lab05/ortographic_view.png%3Fid=egc%253Alaboratoare%253A05.html" class="media" title="egc:laboratoare:lab05:ortographic_view.png"><img src="../../_media/egc/laboratoare/lab05/ortographic_view.png" class="mediacenter" title=" Ortographic Projection " alt=" Ortographic Projection " /></a>
</p>

<p>
Proiectia ortografica este definita de latimea si inaltimea ferestrei de vizualizare cat si a distantei de vizualizare dintre planul <strong>din apropiere</strong> si planul <strong>din departare</strong>. In afara acestui volum obiectele nu vor mai fi vazute pe ecran.
</p>

<p>
<a href="../../_detail/egc/laboratoare/lab05/ortographic_matrix.png%3Fid=egc%253Alaboratoare%253A05.html" class="media" title="egc:laboratoare:lab05:ortographic_matrix.png"><img src="../../_media/egc/laboratoare/lab05/ortographic_matrix.png" class="mediacenter" title=" Ortographic Matrix " alt=" Ortographic Matrix " /></a>
</p>

<p>
Matricea de proiectie poate fi calculata utilizand functia <code>glm::ortho</code> unde puctele <strong>left, right, bottom, top</strong> sunt relative fata de centrul ferestrei (0, 0) si definesc <strong>inaltimea</strong> si <strong>latimea ferestrei de proiectie</strong>
</p>
<pre class="code cpp">glm<span class="sy4">::</span><span class="me2">mat4</span> Projection <span class="sy1">=</span> glm<span class="sy4">::</span><span class="me2">ortho</span><span class="br0">&#40;</span><span class="kw4">float</span> left, <span class="kw4">float</span> right, <span class="kw4">float</span> bottom, <span class="kw4">float</span> top, <span class="kw4">float</span> zNear, <span class="kw4">float</span> zFar<span class="br0">&#41;</span><span class="sy4">;</span></pre>

</div>

<h3 class="sectionedit8" id="proiectia_perspectiva">Proiectia Perspectiva</h3>
<div class="level3">

<p>
Proiectia perspectiva este reprezentata de un trunchi de piramida (frustum) definit prin cele 2 planuri, <strong>cel din apropiere</strong> si <strong>cel din departare</strong>, cat si de deschiderea unghiurilor de vizualizare pe cele 2 axe, OX si OY. In proiectia perspectiva distanta pana la un punct din volumul de vizualizare influenteaza proiectia.
</p>

<p>
<a href="../../_detail/egc/laboratoare/lab05/perspective_view.png%3Fid=egc%253Alaboratoare%253A05.html" class="media" title="egc:laboratoare:lab05:perspective_view.png"><img src="../../_media/egc/laboratoare/lab05/perspective_view.png" class="mediacenter" title=" Perspective View " alt=" Perspective View " /></a>
</p>

<p>
Matricea de proiectie in acest caz poate fi calculata cu ajutorul funectiei <code>glm::perspective</code> ce primeste ca si parametri deschiderea unghiului de vizualizare pe orizontala (<strong>Field of View - FoV</strong>), raportul dintre latimea ai inaltimea ferestrei de vizualizare (<strong>aspect ratio</strong>), cat si distanta pana la cele 2 planuri zFar si zNear.
</p>

<p>
<a href="../../_detail/egc/laboratoare/lab05/perspective_matrix.png%3Fid=egc%253Alaboratoare%253A05.html" class="media" title="egc:laboratoare:lab05:perspective_matrix.png"><img src="../../_media/egc/laboratoare/lab05/perspective_matrix.png" class="mediacenter" title=" Perspective Matrix " alt=" Perspective Matrix " /></a>
</p>

<p>
In cazul proiectiei perspectiva, dupa inmutirea coordonatelor din spatiul view, componenta w a fiecarui vertex este diferita, ceea ce inseamna ca spatiul de proiecte nu e acelasi pentru fiecare varf. Pentru a aduce toti vectorii in acelasi spatiu se imparte fiecare componenta a vectorului rezultat cu <strong>componenta w</strong>. Aceasta operatie este realizata automat de placa video, in cadrul unei aplicatii fiind nevoie doar de inmultirea cu matricea de proiectie.
</p>

<p>
<a href="../../_detail/egc/laboratoare/lab05/perspective_correction.png%3Fid=egc%253Alaboratoare%253A05.html" class="media" title="egc:laboratoare:lab05:perspective_correction.png"><img src="../../_media/egc/laboratoare/lab05/perspective_correction.png" class="mediacenter" title=" Normalized Device Coordinate Space " alt=" Normalized Device Coordinate Space " /></a>
</p>

<p>
Volum de vizualizare perspectiva (<strong>stanga</strong>) si rezultatul obtinut (<strong>dreapta</strong>) in urma aplicarii transformarii de proiectie asupra geometriei din scena
</p>

</div>

<h2 class="sectionedit9" id="spatiul_coordonatelor_de_dispozitiv_normalizate_ndc">Spatiul Coordonatelor de Dispozitiv Normalizate (NDC)</h2>
<div class="level2">

<p>
Dupa aplicarea transformarilor de <strong>Modelare</strong>, <strong>Vizualizare</strong> si <strong>Proiectie</strong> iar apoi <strong>divizarea cu W</strong> a vectorilor, se obtine spatiul de coordonate normalizate (<strong>NDC</strong>) reprezentat de un CUB centrat in origine (0, 0, 0) cu latura 2. Informatia din acest cub se poate proiecta foarte usor pe orice suprafata 2D de desenare definita de utiliazator.
</p>

<p>
<a href="../../_detail/egc/laboratoare/lab05/ndc.png%3Fid=egc%253Alaboratoare%253A05.html" class="media" title="egc:laboratoare:lab05:ndc.png"><img src="../../_media/egc/laboratoare/lab05/ndc.png" class="mediacenter" title=" Normalized Device Coordinate Space " alt=" Normalized Device Coordinate Space " /></a>
</p>

<p>
Exemplu rezultat al proiectiei in coordonate dispozitiv normalizate (<strong>NDC</strong>). Proiectie <strong>ortografica</strong> (stanga), <strong>perspectiva</strong> (dreapta)
</p>

<p>
<a href="../../_detail/egc/laboratoare/lab05/ndc2.png%3Fid=egc%253Alaboratoare%253A05.html" class="media" title="egc:laboratoare:lab05:ndc2.png"><img src="../../_media/egc/laboratoare/lab05/ndc2.png%3Fw=700&amp;tok=6322e2" class="mediacenter" title=" Normalized Device Coordinate Space " alt=" Normalized Device Coordinate Space " width="700" /></a>
</p>

<p>
Exemplu vizualizare <strong>spatiu NDC</strong> din directia camerei (<strong>stanga</strong>) si <strong>proiectia</strong> corespunzatoare pentru un anumit viewport (<strong>dreapta</strong>)
</p>

</div>

<h2 class="sectionedit10" id="aplicarea_transformarilor_de_modelare_vizualizare_si_proiectie">Aplicarea Transformarilor de Modelare, Vizualizare si Proiectie</h2>
<div class="level2">

<p>
Aplicarea trasformarilor de <strong>Modelare, Vizualizare si Proiectie</strong> se face prin inmultirea fiecarui varf al geometriei din scena cu cele 3 matrici calculate.
</p>
<pre class="code cpp">pos_vertex <span class="sy1">=</span> Projection <span class="sy2">*</span> View <span class="sy2">*</span> Model <span class="sy2">*</span> pos_vertex</pre>

<p>
<p><div class="noteclassic">
In cadrul laboratorului trebuie doar sa calculam aceste matrici si sa le trimitem ca parametru functiei de randare <code>RenderMesh</code>. Inmultirile respective sunt executate pe placa video in cadrul programului vertex shader ce va fi introdus incepand cu laboratorul urmator.

</div></p>
</p>

</div>

<h2 class="sectionedit11" id="transformari_de_camera">Transformari de Camera</h2>
<div class="level2">

<p>
Implementarea unei camere in cadrul unei aplicatii 3D depinde de cerintele aplicatiei. In practica cele mai utilizate tipuri de implementari de camera sunt: <strong>First person</strong> si <strong>Third person</strong>.
</p>

</div>

<h3 class="sectionedit12" id="first-person_camera">First-person Camera</h3>
<div class="level3">

<p>
Camera de tipul <strong>First-person</strong> presupune faptul ca scena 3D este vizualizata din perspectiva ochilor unui observator, adesea uman. Constrangerile de implementare sunt urmatoarele:
</p>

</div>

<h4 id="translatia_camerei_first-person">Translatia camerei First-person</h4>
<div class="level4">
<ul>
<li class="level1"><div class="li"> translatiile <strong>fata/spate</strong> se calculeaza utilizand vectorul <strong>forward</strong> (directia de vizualizare sau proiectia acestuia in planul orizontal XOZ)</div>
</li>
<li class="level1"><div class="li"> translatiile sus/jos se calculeaza utilizand vectorul local Up sau cel mai adesea <strong>directia OY globala</strong> (<code>glm::vec3(0, 1, 0)</code>)</div>
</li>
<li class="level1"><div class="li"> translatiile dreapta/stanga se calculeaza folosind vectorul local <strong>right</strong> (ce se poate obtine si prin operatia de <strong>cross product</strong> intre vectorii <strong>forward</strong> si <strong>up</strong>), sau folosind proiectia acestuia pe planul orizontal <strong>XOZ</strong></div>
</li>
</ul>
<pre class="code cpp">posCamera <span class="sy1">=</span> posCamera <span class="sy2">+</span> glm<span class="sy4">::</span><span class="me2">normalize</span><span class="br0">&#40;</span>direction<span class="br0">&#41;</span> <span class="sy2">*</span> distance<span class="sy4">;</span></pre>

</div>

<h4 id="rotatia_camerei_first-person">Rotatia camerei First-person</h4>
<div class="level4">
<ul>
<li class="level1"><div class="li"> rotatiile se fac pastrand observatorul pe loc si modificand directia in care priveste acesta</div>
</li>
<li class="level1"><div class="li"> pentru rotatia <strong>stanga/dreapta</strong>, vectorii <strong>forward</strong> respectiv <strong>right</strong> se pot calcula prin aplicarea transformarii de rotatie in jului axei OY globale. Se poate roti si in jurul axei <strong>OY locale</strong> (<strong>vectorul up</strong>), insa in in general nu prea are aplicabilitate practica</div>
</li>
<li class="level1"><div class="li"> <strong>vectorul up</strong> se poate recalcula folosind <strong>cross product</strong> intre <strong>right</strong> si <strong>forward</strong></div>
</li>
</ul>
<pre class="code cpp">forward <span class="sy1">=</span> RotateWorldOY<span class="br0">&#40;</span>angle<span class="br0">&#41;</span> <span class="sy2">*</span> forward<span class="sy4">;</span>
right <span class="sy1">=</span> RotateWorldOY<span class="br0">&#40;</span>angle<span class="br0">&#41;</span> <span class="sy2">*</span> right<span class="sy4">;</span>
up <span class="sy1">=</span> glm<span class="sy4">::</span><span class="me2">cross</span><span class="br0">&#40;</span>right, forward<span class="br0">&#41;</span><span class="sy4">;</span></pre>
<ul>
<li class="level1"><div class="li"> rotatia <strong>sus/jos</strong> se poate face rotind vectorii <strong>forward</strong> respectiv <strong>up</strong>  in jurul vectorului <strong>axei OX</strong> adica <strong> vectorul right</strong> (right ramane constant)</div>
</li>
</ul>
<pre class="code cpp">forward <span class="sy1">=</span> RotateLocalOX<span class="br0">&#40;</span>angle<span class="br0">&#41;</span> <span class="sy2">*</span> forward<span class="sy4">;</span>
up <span class="sy1">=</span> glm<span class="sy4">::</span><span class="me2">cross</span><span class="br0">&#40;</span>right, forward<span class="br0">&#41;</span><span class="sy4">;</span></pre>

<p>
<p><div class="notetip">
Matricile de rotatie necesare se pot calcula folosind functia <code>glm::rotate</code>
</p>
<pre class="code cpp">glm<span class="sy4">::</span><span class="me2">mat4</span> <span class="sy1">=</span> glm<span class="sy4">::</span><span class="me2">rotate</span><span class="br0">&#40;</span>glm<span class="sy4">::</span><span class="me2">mat4</span> model, <span class="kw4">float</span> angle, glm<span class="sy4">::</span><span class="me2">vec3</span> rotationAxis<span class="br0">&#41;</span><span class="sy4">;</span></pre>
<ul>
<li class="level1"><div class="li"> primul parametru reprezinta o <strong>matrice de modelare</strong> asupra careia aplicam transformarea specificata. Atunci cand nu avem o transformare precedenta se porneste de la matricea identitate <code>glm::mat4(1.0f)</code> <br/>
</div>
</li>
<li class="level1"><div class="li"> <strong>rotationAxis</strong> este axa fata de care rotim. In cazul nostru pentru rotatia fata de <strong>OX</strong> este vectorul <strong>right</strong>, pentru rotatia fata de <strong>OZ</strong> este vectorul <strong>forward</strong>, sau <code>glm::vec3(0, 1, 0)</code> pentru rotatia fata de <strong>OY global</strong> <br/>
</div>
</li>
<li class="level1"><div class="li"> intrucat vectorii utilizati sunt <code>glm::vec3</code> cand facem inmultirea va trebui sa construim un vector de 4 componente ca sa putem inmulti cu matricea de 4&times;4. Puteti construi vectorul astfel: <br/>
</div>
</li>
</ul>
<pre class="code cpp">glm<span class="sy4">::</span><span class="me2">vec3</span> forward <span class="sy1">=</span> ...
<span class="me1">glm</span><span class="sy4">::</span><span class="me2">vec4</span> newVec <span class="sy1">=</span> glm<span class="sy4">::</span><span class="me2">vec4</span><span class="br0">&#40;</span>forward, <span class="nu16">1.0</span><span class="br0">&#41;</span><span class="sy4">;</span></pre>
<ul>
<li class="level1"><div class="li"> Daca vrem sa rotim vectorul “forward” in jurul <strong>axei OY globale</strong> atunci facem astfel:</div>
</li>
</ul>
<pre class="code">
// get the rotate vec4 vector
glm::vec4 newVector = glm::rotate(glm::mat4(1.0f), angle, glm::vec3(0, 1, 0)) * glm::vec4(forward, 1);

// extract the vec3 vector and then normalize it
forward = glm::normalize(glm::vec3(newVector);
</pre>

<p>

</div></p>
</p>

<p>
<p><div class="noteimportant">
Dupa ce ati facut calculele de rotatie aveti grija sa pastrati vectorii normalizati
</p>
<pre class="code cpp">glm<span class="sy4">::</span><span class="me2">vec3</span> vector <span class="sy1">=</span> ...
<span class="me1">glm</span><span class="sy4">::</span><span class="me2">vec3</span> rezultat <span class="sy1">=</span> glm<span class="sy4">::</span><span class="me2">normalize</span><span class="br0">&#40;</span>vector<span class="br0">&#41;</span><span class="sy4">;</span></pre>

<p>

</div></p>
</p>

</div>

<h3 class="sectionedit13" id="third-person_camera">Third-person Camera</h3>
<div class="level3">

<p>
In cazul camerei de tip Third-person <strong>observatorul</strong> se muta in jurul unui obiect de interes, ce reprezinta intotdeauna centrul atentiei. Deci rotatiile se fac intr-un mod diferit
</p>

</div>

<h4 id="rotatia_camerei_third-person">Rotatia Camerei Third-person</h4>
<div class="level4">
<ul>
<li class="level1"><div class="li"> se translateaza observatorul pe directia de vizualizare in punctul de interes (target)</div>
</li>
<li class="level1"><div class="li"> se aplica rotatia de tip <strong>First-person</strong> specifica</div>
</li>
<li class="level1"><div class="li"> se traslateaza observatorul inapoi pe noua directie de vizualizare cu aceasi distanta</div>
</li>
</ul>

<p>
<p><div class="noteimportant">
In laborator aveti variabila distanceToTarget care retine distanta pana la punctul fata de care rotim

</div></p>
</p>

</div>

<h4 id="translatia_camerei_third-person">Translatia Camerei Third-person</h4>
<div class="level4">

<p>
Pozitia camerei depinde de pozitia punctului de interes. Astfel, miscarea punctului de interesva  determina si translatia camerei in mod corespunzator.
</p>

</div>

<h2 class="sectionedit14" id="cerinte_laborator">Cerinte laborator</h2>
<div class="level2">
<ol>
<li class="level1"><div class="li"> Descarcati <a href="https://github.com/UPB-Graphics/Framework-EGC/archive/master.zip" class="urlextern" title="https://github.com/UPB-Graphics/Framework-EGC/archive/master.zip"  rel="nofollow">framework-ul de laborator</a></div>
</li>
<li class="level1"><div class="li"> Sa se implementeze camera de tip First Person (fisierul <em class="u">LabCamera.h</em>)</div>
</li>
<li class="level1"><div class="li"> Sa se implementeze camera de tip Third Person (fisierul <em class="u">LabCamera.h</em>) </div>
</li>
<li class="level1"><div class="li"> Sa se completeze functiile de translatie a camerei din <code>Laborator5::OnInputUpdate()</code></div>
</li>
<li class="level1"><div class="li"> Sa se completeze functiile de rotatie a camerei din <code>Laborator5::OnMouseMove()</code></div>
</li>
<li class="level1"><div class="li"> Sa se deseneze inca 2 obiecte in scena 3D avand rotatia/scalarea/translatia diferite</div>
<ul>
<li class="level2"><div class="li"> Aveti grija sa setati matricea de modelare de fiecare data inainte de desenare</div>
</li>
<li class="level2"><div class="li"> Utilizati <code>glm::translate()</code>, <code>glm::rotate()</code> si <code>glm::scale()</code> pentru a construi o matrice de modelare pentru fiecare obiect.</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> Schimbare proiectie perspectiva/ortografica</div>
<ul>
<li class="level2"><div class="li"> <strong>tasta O</strong> face trecerea in proiectie ortografica</div>
</li>
<li class="level2"><div class="li"> <strong>tasta P</strong> face trecerea in proiectie perspectiva</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> Sa se modifice FoV-ul camerei in cazul proiectiei persepective</div>
<ul>
<li class="level2"><div class="li"> folositi 2 taste pentru a modifica pozitiv si negativ FoV-ul</div>
</li>
<li class="level2"><div class="li"> se va folosi <code>OnInputUpdate()</code></div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> Sa se modifice latimea si/sau inaltimea ferestrei de proiectie in cazul proiectiei ortografice</div>
<ul>
<li class="level2"><div class="li"> se va folosi <code>OnInputUpdate()</code></div>
</li>
</ul>
</li>
</ol>

</div>

        </div>
        <div class="right_sidebar">
          <form action="../../start.html" accept-charset="utf-8" class="search" id="dw__search" method="get"><div class="no"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch__in" accesskey="f" name="id" class="edit" title="[F]" /><input type="submit" value="Search" class="button" title="Search" /><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>          <div class="namespace_sidebar sidebar_box">

<h1 class="sectionedit1" id="info_curs">Info curs</h1>
<div class="level1">
<ul>
<li class="level1"><div class="li"> <a href="../index.html" class="wikilink1" title="egc">Elemente de Grafică pe Calculator</a></div>
</li>
</ul>

</div>
<!-- EDIT1 SECTION "Info curs" [1-38] -->
<h1 class="sectionedit2" id="egc">EGC</h1>
<div class="level1">
<ul>
<li class="level1"><div class="li"> <a href="../seria_ca.html" class="wikilink1" title="egc:seria_ca">Seria CA</a></div>
</li>
<li class="level1"><div class="li"> <a href="../seria_cb.html" class="wikilink1" title="egc:seria_cb">Seria CB</a></div>
</li>
<li class="level1"><div class="li"> <a href="../seria_cc.html" class="wikilink1" title="egc:seria_cc">Seria CC</a></div>
</li>
</ul>

</div>
<!-- EDIT2 SECTION "EGC" [39-123] -->
<h1 class="sectionedit3" id="laboratoare">Laboratoare</h1>
<div class="level1">
<ul>
<li class="level1"><div class="li"> <a href="01.html" class="wikilink1" title="egc:laboratoare:01">Laboratorul 01</a></div>
</li>
<li class="level1"><div class="li"> <a href="02.html" class="wikilink1" title="egc:laboratoare:02">Laboratorul 02</a></div>
</li>
<li class="level1"><div class="li"> <a href="03.html" class="wikilink1" title="egc:laboratoare:03">Laboratorul 03</a></div>
</li>
<li class="level1"><div class="li"> <a href="04.html" class="wikilink1" title="egc:laboratoare:04">Laboratorul 04</a></div>
</li>
<li class="level1"><div class="li"> <span class="curid"><a href="05.html" class="wikilink1" title="egc:laboratoare:05">Laboratorul 05</a></span></div>
</li>
<li class="level1"><div class="li"> <a href="06.html" class="wikilink1" title="egc:laboratoare:06">Laboratorul 06</a></div>
</li>
<li class="level1"><div class="li"> <a href="07.html" class="wikilink1" title="egc:laboratoare:07">Laboratorul 07</a></div>
</li>
</ul>

</div>
<!-- EDIT3 SECTION "Laboratoare" [124-421] -->
<h1 class="sectionedit4" id="teme">Teme</h1>
<div class="level1">

<div><div id="nojs_indexmenu_76431945458355a917b6c1" data-jsajax="" class="indexmenu_nojs">

<ul class="idx">
<li class="level1"><div class="li"><a href="../teme/01.html" class="wikilink1" title="egc:teme:01">Tema 1: Geometry Wars</a></div></li>
<li class="level1"><div class="li"><a href="../teme/02.html" class="wikilink1" title="egc:teme:02">Tema 2: Build and Survive</a></div></li>
</ul>
</div></div>

</div>
<!-- EDIT4 SECTION "Teme" [422-464] -->
<h1 class="sectionedit5" id="resurse">Resurse</h1>
<div class="level1">
<ul>
<li class="level1"><div class="li"> <a href="../resurse.html" class="wikilink1" title="egc:resurse">Resurse Utile</a></div>
</li>
</ul>

</div>
<!-- EDIT5 SECTION "Resurse" [465-] -->
</div>
<div class="toc_sidebar sidebar_box">
<!-- TOC START -->
<div id="sb__right__dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="05.html#laboratorul_05">Laboratorul 05</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="05.html#spatiul_obiect">Spatiul Obiect</a></div></li>
<li class="level2"><div class="li"><a href="05.html#spatiul_lume">Spatiul Lume</a></div></li>
<li class="level2"><div class="li"><a href="05.html#spatiul_de_vizualizare">Spatiul de Vizualizare</a></div></li>
<li class="level2"><div class="li"><a href="05.html#spatiul_de_proiectie">Spatiul de Proiectie</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="05.html#matricea_de_proiectie">Matricea de Proiectie</a></div></li>
<li class="level3"><div class="li"><a href="05.html#proiectia_ortografica">Proiectia Ortografica</a></div></li>
<li class="level3"><div class="li"><a href="05.html#proiectia_perspectiva">Proiectia Perspectiva</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="05.html#spatiul_coordonatelor_de_dispozitiv_normalizate_ndc">Spatiul Coordonatelor de Dispozitiv Normalizate (NDC)</a></div></li>
<li class="level2"><div class="li"><a href="05.html#aplicarea_transformarilor_de_modelare_vizualizare_si_proiectie">Aplicarea Transformarilor de Modelare, Vizualizare si Proiectie</a></div></li>
<li class="level2"><div class="li"><a href="05.html#transformari_de_camera">Transformari de Camera</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="05.html#first-person_camera">First-person Camera</a></div>
<ul class="toc">
<li class="level4"><div class="li"><a href="05.html#translatia_camerei_first-person">Translatia camerei First-person</a></div></li>
<li class="level4"><div class="li"><a href="05.html#rotatia_camerei_first-person">Rotatia camerei First-person</a></div></li>
</ul>
</li>
<li class="level3"><div class="li"><a href="05.html#third-person_camera">Third-person Camera</a></div>
<ul class="toc">
<li class="level4"><div class="li"><a href="05.html#rotatia_camerei_third-person">Rotatia Camerei Third-person</a></div></li>
<li class="level4"><div class="li"><a href="05.html#translatia_camerei_third-person">Translatia Camerei Third-person</a></div></li>
</ul>
</li>
</ul>
</li>
<li class="level2"><div class="li"><a href="05.html#cerinte_laborator">Cerinte laborator</a></div></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->
</div>
        </div>
      
    
      <div class="stylefoot">
        <div class="meta">
          <div class="user">
                    </div>
          <div class="doc">
          egc/laboratoare/05.txt · Last modified: 2016/11/10 10:43 by gabriel.ivanica          </div>
        </div>
      </div>

    <div class="clearer"></div>

    
                <div class="bar" id="bar__bottom">
      <div class="bar-left">
              </div>
      <div class="bar-right">
        <a href="05%3Fdo=media&amp;ns=egc%253Alaboratoare.html"  class="action media" rel="nofollow" title="Media Manager">Media Manager</a><a href="05.html#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]">Back to top</a>      </div>
    </div>
    <div class="clearer"></div>
            
    <div align="center" class="footerinc">
  <div class="license"><a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license"><img src="../../lib/images/license/button/cc-by-sa.png" alt="CC Attribution-Share Alike 3.0 Unported" /></a></div>
  <a target="_blank" href="http://www.chimeric.de" title="www.chimeric.de"><img src="../../lib/tpl/arctic/images/button-chimeric-de.png" width="80" height="15" alt="www.chimeric.de" border="0" /></a>

  <a target="_blank" href="http://jigsaw.w3.org/css-validator/check/referer" title="Valid CSS"><img src="../../lib/tpl/arctic/images/button-css.png" width="80" height="15" alt="Valid CSS" border="0" /></a>

  <a target="_blank" href="http://wiki.splitbrain.org/wiki:dokuwiki" title="Driven by DokuWiki"><img src="../../lib/tpl/arctic/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" border="0" /></a>

  <a target="_blank" href="http://www.firefox-browser.de" title="do yourself a favour and use a real browser - get firefox"><img src="../../lib/tpl/arctic/images/button-firefox.png" width="80" height="15" alt="do yourself a favour and use a real browser - get firefox!!" border="0" /></a>
  
  <a target="_blank" href="../../feed.php" title="Recent changes RSS feed"><img src="../../lib/tpl/arctic/images/button-rss.png" width="80" height="15" alt="Recent changes RSS feed" border="0" /></a>

  <a target="_blank" href="http://validator.w3.org/check/referer" title="Valid XHTML 1.0"><img src="../../lib/tpl/arctic/images/button-xhtml.png" width="80" height="15" alt="Valid XHTML 1.0" border="0" /></a>
</div>

  </div>
</div>

<div class="no"><img src="../../lib/exe/indexer.php%3Fid=egc%253Alaboratoare%253A05&amp;1479891601" width="2" height="1" alt="" /></div>
</body>
</html>
