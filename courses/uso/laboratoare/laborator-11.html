    
    

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
 lang="en" dir="ltr">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
    Laborator 11 - Shell scripting    [CS Open CourseWare]
  </title>

  <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="noindex,nofollow"/>
<meta name="date" content="2016-11-23T01:11:40+0200"/>
<meta name="keywords" content="uso,laboratoare,laborator-11"/>
<link rel="search" type="application/opensearchdescription+xml" href="../../lib/exe/opensearch.php" title="CS Open CourseWare"/>
<link rel="start" href="../../../courses.1.html"/>
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="../../feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="../../feed.php%3Fmode=list&amp;ns=uso:laboratoare"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="http://ocw.cs.pub.ro/courses/_export/xhtml/uso/laboratoare/laborator-11"/>
<link rel="canonical" href="laborator-11.html"/>
<link rel="stylesheet" type="text/css" href="../../lib/exe/css.php%3Ft=arctic&amp;tseed=1479898000.css"/>
<script type="text/javascript">/*<![CDATA[*/var NS='uso:laboratoare';var JSINFO = {"id":"uso:laboratoare:laborator-11","namespace":"uso:laboratoare","isadmin":0,"isauth":0};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="../../lib/exe/js.php%3Ftseed=1479898000"></script>
<script type="text/x-mathjax-config">/*<![CDATA[*/MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ["$","$"], ["\\(","\\)"] ],
        displayMath: [ ["$$","$$"], ["\\[","\\]"] ],
        processEscapes: true
    }
});
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
<script type="text/javascript">/*<![CDATA[*/
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
		  
/*!]]>*/</script>
<script type="text/javascript">/*<![CDATA[*/
var pageTracker = _gat._getTracker("UA-38383934-1");
pageTracker._initData();
pageTracker._trackPageview();
		  
/*!]]>*/</script>

  <link rel="shortcut icon" href="../../lib/tpl/arctic/images/favicon.ico" />

  
</head>
<body>
<div id="wrapper" class='show'>
  <div class="dokuwiki">

    
    <div class="stylehead">
      <div class="header">
        <div class="pagename">
          <a href="http://ocw.cs.pub.ro/courses/uso/"><img height="70" src="../../res/sigla_uso.png"/> </a>        </div>
        <div class="logo">
          <a style="color: #AAA !important;" href="../../systems/index.html"/><img height="70" src="../../res/systems.png" name="dokuwiki__top"/></a>        </div>
      </div>
    
       
      <div class="breadcrumbs">
              </div>
      
            </div>

                  <div class="bar" id="bar__top">
        <div class="bar-left">
                  </div>
        <div class="bar-right">
          <a href="http://ocw.cs.pub.ro/courses/uso/laboratoare/laborator-11?do=recent"  class="action recent" accesskey="r" rel="nofollow" title="Recent changes [R]">Recent changes</a><a href="http://ocw.cs.pub.ro/courses/uso/laboratoare/laborator-11?do=login&amp;sectok=f62420cf5b01253da4b50505d148181b"  class="action login" rel="nofollow" title="Login">Login</a>        </div>
    </div>
        
    
    
    
              <div class="left_page">
          
<h1 class="sectionedit1" id="laborator_11_-_shell_scripting">Laborator 11 - Shell scripting</h1>
<div class="level1">

</div>

<h2 class="sectionedit2" id="suport_laborator">Suport laborator</h2>
<div class="level2">

<p>
<strong>Cuvinte cheie</strong>: date, prelucrare, <em>means</em>, <em>ends</em>, parsare, prezentare, date tabelare, separator de câmpuri, <code>cut</code>, <code>awk</code>, <code>IFS</code>, <code>while read</code>, expresii regulate, metacaractere, <code>grep</code>, shell scripting, <code>for</code>, <code>if</code>, rezultate numerice, grafice
</p>
<ul>
<li class="level1"><div class="li"> Suport (Introducere în sisteme de operare)</div>
<ul>
<li class="level2"><div class="li"> Capitolul 12 – Shell scripting</div>
<ul>
<li class="level3"><div class="li"> Secțiunile 12.4, 12.5, 12.6, 12.9</div>
</li>
</ul>
</li>
</ul>
</li>
<li class="level1"><div class="li"> <a href="http://www.amazon.com/Regular-Expressions-Cookbook-Jan-Goyvaerts/dp/1449319432" class="urlextern" title="http://www.amazon.com/Regular-Expressions-Cookbook-Jan-Goyvaerts/dp/1449319432"  rel="nofollow">Regular Expressions Cookbook</a></div>
<ul>
<li class="level2"><div class="li"> Puteți descărca fișierul PDF aferent de <a href="https://github.com/shihyu/Regular_Expressions" class="urlextern" title="https://github.com/shihyu/Regular_Expressions"  rel="nofollow">aici</a>.</div>
</li>
<li class="level2"><div class="li"> Capitolul 1 – Introduction to Regular Expressions</div>
</li>
<li class="level2"><div class="li"> Capitolul 2 – Basic Regular Expression Skills</div>
</li>
</ul>
</li>
</ul>

</div>

<h2 class="sectionedit3" id="repository_laborator">Repository laborator</h2>
<div class="level2">

<p>
Pentru a descărca fișierele necesare acestui laborator deschidem un terminal (folosim combinația de taste <code>Alt+Ctrl+t</code>) și clonăm repository-ului oficial de USO. Folosim comanda
</p>
<pre class="code bash"><span class="co4">student@midgard:~$ </span><span class="kw2">git clone</span> https:<span class="sy0">//</span>github.com<span class="sy0">/</span>systems-cs-pub-ro<span class="sy0">/</span>uso uso.git</pre>

<p>
În directorul <code>/home/student/uso.git/lab10</code> găsim fișierele necesare pentru laboratorul 10. Accesăm acel director folosind comanda
</p>
<pre class="code bash"><span class="co4">student@midgard:~$ </span><span class="kw3">cd</span> uso<span class="sy0">/</span>lab10
student<span class="sy0">@</span>midgard:~<span class="sy0">/</span>uso<span class="sy0">/</span>lab10$ <span class="kw3">pwd</span>
<span class="sy0">/</span>home<span class="sy0">/</span>student<span class="sy0">/</span>uso<span class="sy0">/</span>lab10</pre>

</div>

<h2 class="sectionedit4" id="demo">Demo</h2>
<div class="level2">

<p>
În continuare, împreună cu asistentul veți parcurge câteva exerciții de tip demo/tutorial.
</p>

</div>

<h3 class="sectionedit5" id="expresii_regulate">Expresii regulate</h3>
<div class="level3">

<p>
Expresiile regulate sunt folosite pentru căutarea/selecția anumitor intrări în fișiere text și pentru parsarea informațiilor din fișiere text. În procesarea expresiilor regulate, matching-ul se face pe fiecare linie din text. Într-o expresie regulată, anumite caractere au rol special precum caracterele de mai jos.
</p>
<div class="table sectionedit6"><table class="inline">
	<tr class="row0">
		<th class="col0"> Caracter </th><th class="col1"> Efect în expresie regulată </th>
	</tr>
	<tr class="row1">
		<td class="col0"> ^ </td><td class="col1"> început de linie </td>
	</tr>
	<tr class="row2">
		<td class="col0"> $ </td><td class="col1"> sfârșit de linie </td>
	</tr>
	<tr class="row3">
		<td class="col0"> . </td><td class="col1"> orice caracter </td>
	</tr>
	<tr class="row4">
		<td class="col0"> * </td><td class="col1"> expresia anterioară de oricâte ori, posibil niciodată </td>
	</tr>
	<tr class="row5">
		<td class="col0"> + </td><td class="col1"> expresia anterioară de oricâte ori, cel puțin o dată </td>
	</tr>
	<tr class="row6">
		<td class="col0"> [ajt] </td><td class="col1"> orice caracter din setul de caractere <code>a</code>, <code>j</code>, <code>t</code> </td>
	</tr>
	<tr class="row7">
		<td class="col0"> [^ajt] </td><td class="col1"> orice caracter <strong>mai puțin</strong> caracterele <code>a</code>, <code>j</code>, <code>t</code> </td>
	</tr>
	<tr class="row8">
		<td class="col0"> | </td><td class="col1"> expresia anterioară <strong>sau</strong> expresia de după (una dintre cele două expresii) </td>
	</tr>
	<tr class="row9">
		<td class="col0"> ? </td><td class="col1"> expresia anterioară o dată sau niciodată </td>
	</tr>
</table></div>

<p>
<p><div class="notetip">
Găsiți un tool online <a href="http://regexr.com/" class="urlextern" title="http://regexr.com/"  rel="nofollow"> aici</a> care va permite să vizualizați efectul expresiilor regulate în mod interactiv. Puteți să îl folosiți pentru a vă obișnui cu scrierea de regexp-uri. 

</div></p>
</p>

</div>

<h3 class="sectionedit7" id="expresii_regulate_vs_globbing">Expresii regulate vs globbing</h3>
<div class="level3">
<div class="table sectionedit8"><table class="inline">
	<tr class="row0">
		<td class="col0 centeralign">  Construtie  </td><td class="col1 centeralign">  RegExp  </td><td class="col2 centeralign">  Glob  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  .  </td><td class="col1 centeralign">	 orice carcater  </td><td class="col2 centeralign">  caracterul <code>.</code>  </td>
	</tr>
	<tr class="row2">
		<td class="col0 centeralign">  .*  </td><td class="col1 centeralign">  orice caracter de oricâte ori, posibil niciodată  </td><td class="col2 centeralign">  orice incepe cu <code>.</code>  </td>
	</tr>
	<tr class="row3">
		<td class="col0 centeralign">  ?  </td><td class="col1 centeralign">  expresia anterioară o dată sau niciodată  </td><td class="col2 centeralign">  orice caracter  </td>
	</tr>
	<tr class="row4">
		<td class="col0 centeralign">  a+  </td><td class="col1 centeralign">  carcaterul <code>a</code> de oricâte ori, cel puțin o dată  </td><td class="col2 centeralign">  carcaterul <code>a</code> urmat de <code>+</code>  </td>
	</tr>
</table></div>

</div>

<h2 class="sectionedit9" id="expresii_regulate_grep">Expresii regulate &amp; grep</h2>
<div class="level2">

<p>
În directorul din repository aferent laboratorului există un fișier <code>students.txt</code> pe care îl vom folosi ca suport pentru comenzi cu expresii regulate. Acest fișier conține o listă de studenți cu numele complet al studenților (prima coloană), grupa din care fac parte (a doua coloană) și diverse note la USO (nota finală - a treia coloană, nota la testul grilă - a patra coloană - și nota la testul practic - a cincea coloană), câmpuri separate prin caracterul tab.
</p>

<p>
Pentru căutarea și selectarea de linii din fișiere text folosim comanda <code>grep</code> care folosește, la rândul ei, expresii regulate. Astfel, dacă dorim să selectăm studenții care au litera <code>z</code> în numele lor, folosim comanda
</p>
<pre class="code">student@midgard:~/uso.git/lab11$ grep &#039;z&#039; students.txt 
GHECENCO F. Răzvan	312CC	8	8.75	4.67
MARIN N. Răzvan	312CC	5	3.5	4.2</pre>

<p>
<p><div class="noteimportant">
Este recomandat ca argumentul de tip expresie regulată transmis comenzii <code>grep</code> să fie plasat între apostrofuri (<code>&#039;</code>) pentru a fi escapat. În felul acesta caracterele din expresia regulată vor fi transmise întocmai comenzii <code>grep</code> și nu vor fi interpretate de shell.

</div></p>
</p>
<div class="hiddenGlobal  hiddenActive"><div class="hiddenElements"></div><div class="hiddenHead  hiddenSinceBeginning"><div class="hiddenOnHidden">
<p>
Click pentru detalii legate de apostrofuri și ghilimele
</p>
</div><div class="hiddenOnVisible">
<p>
Click pentru detalii legate de apostrofuri și ghilimele
</p>
</div></div> <!-- .hiddenHead --><div class="hiddenBody">
<p>
În shell este recomandată folosirea ghilimelelor (<code>”</code>, <em>(double) quotes</em>) și a apostrofurilor (<code>&#039;</code>, <em>single quotes</em>) pentru escapare. <strong>Escapare</strong> înseamnă că nu vor fi interpretate special caracterele speciale din shell; adică vor fi interpretate drept caractere obișnuite. Exemple de caractere speciale în shell sunt:
</p>
<ul>
<li class="level1"><div class="li"> <code>$</code>: folosit pentru expandare: expandarea valorii unei variabile, expandarea unei comenzi, substituție aritmetică</div>
</li>
<li class="level1"><div class="li"> <code>*</code>: folosit în globbing: înseamnă orice caracter de oricâte ori</div>
</li>
<li class="level1"><div class="li"> <code>&gt;</code>, <code>&lt;</code>: folosite pentru redirectare</div>
</li>
<li class="level1"><div class="li"> <code>&amp;</code>, <code>|</code>: folosite pentru trimiterea unei comenzi în background sau pentru înlănțuirea unei comenzi; sau ca parte a operatorilor de secvențiere condiționată (<code>||</code> și <code>&amp;&amp;</code>)</div>
</li>
<li class="level1"><div class="li"> <code>;</code>: folosit pentru secvențierea comenzilor</div>
</li>
<li class="level1"><div class="li"> <code>(</code>, <code>)</code>: folosite pentru crearea de subshell-uri</div>
</li>
<li class="level1"><div class="li"> <code>”</code>, <code>&#039;</code>, <code>\</code>: folosite pentru escapare</div>
</li>
</ul>

<p>
Diferența dintre ghilimele și apostrofuri constă în interpretarea caracterului dolar (<code>$</code>, <em>dollar</em>). Între ghilimele, caracterul dolar își păstrează rolul special, pe când între apostrofuri este considerat un caracter ca oricare altul.
</p>

<p>
De exemplu, dacă dorim să afișăm valoarea variabilei <code>USER</code>, vom folosi construcția
</p>
<pre class="code">student@mjolnir.local:~$ echo &quot;$USER&quot;
student</pre>

<p>
Va fi afișată valoarea variabilei <code>USER</code> întrucât am folosit construcția <code>$USER</code> între ghilimele.
</p>

<p>
Dacă însă folosim construcția <code>$USER</code> între apostrofuri, ca în continuare
</p>
<pre class="code">student@mjolnir.local:~$ echo &#039;$USER&#039;
$USER</pre>

<p>
atunci va fi afișat chiar șirul <code>$USER</code>. Asta pentru că apostrofurile, spre deosebire de ghilimele, escapează inclusiv caracterul dolar.
</p>
</div></div>
<p>
Doar că expresia <code>z</code> nu se potrivește (nu face <em>match</em>) pe litera <code>Z</code> (majusculă). Pentru a selecta studenții al cărore nume conține atât litera <code>z</code> cât și <code>Z</code> (majusculă) folosim expresia regulată <code>[zZ]</code> și comanda
</p>
<pre class="code">student@midgard:~/uso.git/lab11$ grep &#039;[zZ]&#039; students.txt 
PAJARCU Z.P. Raul-Constantin	312CC	2	0.5	1.7
GHECENCO F. Răzvan	312CC	8	8.75	4.67
MARIN N. Răzvan	312CC	5	3.5	4.2
ZINCULESCU C. Marius-Valentin	313CC	7	4.75	5.7</pre>

<p>
Expresia regulată <code>[zZ]</code> se potrivește pe setul de caractere compus din litera <code>z</code> cât și <code>Z</code> (majusculă). Cu aceasta au apărut două linii noi: o linie conține studentul cu numele de familie <code>ZINCULESCU</code> iar cealaltă linie conține ințialele <code>Z.P.</code> ambele cu litera <code>Z</code> (majusculă).
</p>

<p>
Dacă vrem să selectăm studenții al căror nume de familie începe cu litera <code>F</code>, atunci vom folosi expresia regulată <code>^F</code> denotând litera <code>F</code> (majusculă) la început de rând. Vom folosi, așadar, comanda de mai jos:
</p>
<pre class="code">student@midgard:~/uso.git/lab11$ grep &#039;^F&#039; students.txt 
FLOREA N. Monica-Andreea	313CC	9	7.5	8.5
FULGER P. Alexandru-Gabriel	315CC	7	4.25	5</pre>

<p>
Dacă vrem în schimb să selectăm studenții al căror prenume începe cu litera <code>F</code> trebuie să privim lucrurile altfel. Urmărind textul putem observa că prenumele sunt precedate fie de caracterul spațiu (<em>blank</em>) fie de caracterul minus (<code>-</code>). Pentru început vom folosi expresia regulată <code>[ -]F</code> care face match pe caracterul spațiu sau minus urmat de caracterul <code>F</code> majusculă. Comanda aferentă este:
</p>
<pre class="code">student@midgard:~/uso.git/lab11$ grep &#039;[ -]F&#039; students.txt 
ONEA I. Flavia-Katilina	311CC	7	6.5	4.33
PLEȘEA Fl. Alexandru	311CC	9	9.25	7.9
GHECENCO F. Răzvan	312CC	8	8.75	4.67
EPURE P. Andi-Florin	314CC	8	9.5	3.67
NEACȘU C. Florin-Mărgărit	314CC	10	9	9
COSTEA I. Florin Traian	315CC	4	3.5	3.7
CHIȚESCU E. Bogdan-Florentin	315CC	9	7.75	6.89</pre>

<p>
Observăm, însă, că se face match și pe șirul <code>Fl.</code> și pe șirul <code>F.</code> reprezentând inițiale. Știm că un prenume conține doar litere mici și că <strong>nu</strong> se încheie cu punct (<code>.</code>, <em>dot</em>). Atunci extindem expresia regulată de mai sus la expresia <code>[ -]F[a-z]+[^\.]</code>. Expresia regulată face match pe un șir care:
</p>
<ul>
<li class="level1"><div class="li"> începe cu unul dintre caracterele spațiu (<em>blank</em>) sau minus (<code>-</code>);</div>
</li>
<li class="level1"><div class="li"> continuă cu litera <code>F</code> (majusculă)</div>
</li>
<li class="level1"><div class="li"> continuă cu litere mici (folosind setul <code>[a-z]</code>)</div>
</li>
<li class="level1"><div class="li"> literele mici de oricâte ori cel puțin o dată (folosind caracterul plus (<code>+</code>))</div>
</li>
<li class="level1"><div class="li"> continuă cu orice caracter diferit de punct (<code>.</code>, <em>dot</em>), folosind expresia <code>[^\.]</code>. Folosim backslash (<code>\</code>) pentru a escapa caracterul punct (<code>.</code>, <em>dot</em>); altfel ar fi însemnat orice caracter, așa cum înseamnă într-o expresie regulată.</div>
</li>
</ul>

<p>
<p><div class="noteclassic">
În expresiile regulate obișnuite (<em>basic regular expressions</em>), anumite caractere își pierd rolul lor special. Este cazul caracterului <code>+</code>, dar și al caracterelor <code>?</code>, <code>{</code>, <code>(</code>, <code>)</code> și <code>|</code>. Pentru a-și păstra rolul special, acestea trebuie precedate de backslash în construcții de forma <code>\+</code>, <code>\?</code>, <code>\{</code>, <code>\(</code>, <code>\)</code> și <code>\|</code>.
</p>

<p>
Găsiți această precizare în pagina de manual a comenzii <code>grep</code>; căutați șirul <code>Basic vs Extended</code>.

</div></p>
</p>

<p>
Astfel, comanda <code>grep</code> pentru a extrage studenții al căror prenume începe cu litera <code>F</code> este
</p>
<pre class="code">student@midgard:~/uso.git/lab11$ grep &#039;[ -]F[a-z]\+[^\.]&#039; students.txt 
ONEA I. Flavia-Katilina	311CC	7	6.5	4.33
EPURE P. Andi-Florin	314CC	8	9.5	3.67
NEACȘU C. Florin-Mărgărit	314CC	10	9	9
COSTEA I. Florin Traian	315CC	4	3.5	3.7
CHIȚESCU E. Bogdan-Florentin	315CC	9	7.75	6.89</pre>

<p>
<p><div class="notetip">
Dacă ați fi dorit să faceți match pe o literă (mică sau mare) ați fi folosit construcția <code>[a-zA-Z]</code>. Dacă ați fi dorit să faceți match pe o literă (mică sau mare) sau pe o cifră, ați fi folosit expresia <code>[a-zA-Z0-9]</code>.

</div></p>
</p>

</div>

<h3 class="sectionedit10" id="tr_sed">tr &amp; sed</h3>
<div class="level3">

<p>
Utilitarul <strong>tr</strong> permite translatarea, ștergerea și manipularea caracterelor primite la intrare.  
După cum am văzut în <a href="http://ocw.cs.pub.ro/courses/uso/laboratoare/laborator-9" class="urlextern" title="http://ocw.cs.pub.ro/courses/uso/laboratoare/laborator-9"  rel="nofollow">laboratorul precedent</a>, <strong>sed</strong> este un <strong>stream editor</strong> ce poate efectua transformări la nivel de string asupra unui text primit la intrare. În plus, sed poate primi expresii regulate ca argument de căutare. 
</p>

<p>
<p><div class="noteclassic">
Diferența dintre tr și sed este că primul efectuează transformări la nivel de caracter, pe când al doilea efectuează transformări la nivel de string. Din acest motiv putem spune că șed este un tr mai avansat, tr++ :). 

</div></p>
</p>

<p>
Spre exemplu, folosinf atât <strong>tr</strong>, cât și <strong>sed</strong>, să înlocuim caracterul &#039;,&#039; cu <code>TAB</code> în <code>student.csv</code>: 
</p>
<pre class="code Bash">student<span class="sy0">@</span>ubuntu:~<span class="sy0">/</span>uso<span class="sy0">/</span>lab10$ <span class="kw2">cat</span> students.csv <span class="sy0">|</span> <span class="kw2">tr</span> , <span class="st0">&quot;<span class="es1">\t</span>&quot;</span> <span class="sy0">&gt;</span> students.out
student<span class="sy0">@</span>ubuntu:~<span class="sy0">/</span>uso<span class="sy0">/</span>lab10$ <span class="kw2">cat</span> students.out 
VLĂDUȚU I. Liviu-Alexandru	311CC	<span class="nu0">6</span>	<span class="nu0">3.5</span>	<span class="nu0">5.22</span>
GEORGIU V. Alexandra-Maria	311CC	<span class="nu0">10</span>	<span class="nu0">10</span>	<span class="nu0">9.67</span>
PĂUNOIU N. Gabriel	311CC	<span class="nu0">7</span>	<span class="nu0">6.5</span>	<span class="nu0">3.5</span>
BĂCÎRCEA A. Andrei	311CC	<span class="nu0">7</span>	<span class="nu0">5.5</span>	<span class="nu0">4.44</span>
<span class="br0">&#91;</span>...<span class="br0">&#93;</span>
&nbsp;
student<span class="sy0">@</span>ubuntu:~<span class="sy0">/</span>uso<span class="sy0">/</span>lab10$ <span class="kw2">sed</span> <span class="st_h">'s/,/\t/g'</span> students.csv <span class="sy0">&gt;</span> students.out 
student<span class="sy0">@</span>ubuntu:~<span class="sy0">/</span>uso<span class="sy0">/</span>lab10$ <span class="kw2">cat</span> students.out 
VLĂDUȚU I. Liviu-Alexandru	311CC	<span class="nu0">6</span>	<span class="nu0">3.5</span>	<span class="nu0">5.22</span>
GEORGIU V. Alexandra-Maria	311CC	<span class="nu0">10</span>	<span class="nu0">10</span>	<span class="nu0">9.67</span>
PĂUNOIU N. Gabriel	311CC	<span class="nu0">7</span>	<span class="nu0">6.5</span>	<span class="nu0">3.5</span>
BĂCÎRCEA A. Andrei	311CC	<span class="nu0">7</span>	<span class="nu0">5.5</span>	<span class="nu0">4.44</span>
<span class="br0">&#91;</span>...<span class="br0">&#93;</span></pre>

<p>
Observăm că cele două comenzi au același efect. Pentru a înlocui șiruri de caractere, tr nu mai oferă funcționalitatea dorită întrucât el face o mapare 1-la-1 între caracterele setul ce trebuie înlocuit și setul ce înlocuiește. În exemplul de mai jos, <code>1</code> este translatat în <code>2</code> indiferent unde apare, iar <code>C</code> în <code>A</code>: 
</p>
<pre class="code Bash">student<span class="sy0">@</span>ubuntu:~<span class="sy0">/</span>uso<span class="sy0">/</span>lab10$ <span class="kw2">cat</span> students.csv <span class="sy0">|</span> <span class="kw2">tr</span> <span class="st0">&quot;311CC&quot;</span> <span class="st0">&quot;312CA&quot;</span> <span class="sy0">&gt;</span> students.out
student<span class="sy0">@</span>ubuntu:~<span class="sy0">/</span>uso<span class="sy0">/</span>lab10$ <span class="kw2">cat</span> students.out 
VLĂDUȚU I. Liviu-Alexandru,322AA,<span class="nu0">6</span>,<span class="nu0">3.5</span>,<span class="nu0">5.22</span>
GEORGIU V. Alexandra-Maria,322AA,<span class="nu0">20</span>,<span class="nu0">20</span>,<span class="nu0">9.67</span>
PĂUNOIU N. Gabriel,322AA,<span class="nu0">7</span>,<span class="nu0">6.5</span>,<span class="nu0">3.5</span>
BĂAÎRAEA A. Andrei,322AA,<span class="nu0">7</span>,<span class="nu0">5.5</span>,<span class="nu0">4.44</span>
<span class="br0">&#91;</span>...<span class="br0">&#93;</span>
&nbsp;
student<span class="sy0">@</span>ubuntu:~<span class="sy0">/</span>uso<span class="sy0">/</span>lab10$ <span class="kw2">sed</span> <span class="st0">&quot;s/311CC/312CA/g&quot;</span> students.csv <span class="sy0">&gt;</span> students.out
student<span class="sy0">@</span>ubuntu:~<span class="sy0">/</span>uso<span class="sy0">/</span>lab10$ <span class="kw2">cat</span> students.out 
VLĂDUȚU I. Liviu-Alexandru,312CA,<span class="nu0">6</span>,<span class="nu0">3.5</span>,<span class="nu0">5.22</span>
GEORGIU V. Alexandra-Maria,312CA,<span class="nu0">10</span>,<span class="nu0">10</span>,<span class="nu0">9.67</span>
PĂUNOIU N. Gabriel,312CA,<span class="nu0">7</span>,<span class="nu0">6.5</span>,<span class="nu0">3.5</span>
BĂCÎRCEA A. Andrei,312CA,<span class="nu0">7</span>,<span class="nu0">5.5</span>,<span class="nu0">4.44</span>
<span class="br0">&#91;</span>...<span class="br0">&#93;</span></pre>

</div>

<h3 class="sectionedit11" id="cut_awk">cut &amp; awk</h3>
<div class="level3">

<p>
Am văzut în laboratoarele precedente cum putem extrage informații structurate pe linii și coloane folosind utilitarul <strong>cut</strong>. 
</p>
<pre class="code Bash">student<span class="sy0">@</span>ubuntu:~<span class="sy0">/</span>uso<span class="sy0">/</span>lab10$ <span class="kw2">cat</span> <span class="sy0">/</span>etc<span class="sy0">/</span><span class="kw2">passwd</span> <span class="sy0">|</span> <span class="kw2">cut</span> <span class="re5">-d</span><span class="st_h">':'</span> -f1,<span class="nu0">6</span> <span class="sy0">|</span> <span class="kw2">head</span> <span class="re5">-3</span>
root:<span class="sy0">/</span>root
daemon:<span class="sy0">/</span>usr<span class="sy0">/</span>sbin
bin:<span class="sy0">/</span>bin</pre>

<p>
Utilitarul <a href="https://linux.die.net/man/1/awk" class="urlextern" title="https://linux.die.net/man/1/awk"  rel="nofollow">awk</a> permite aceleași acțiuni ca și <strong>cut</strong>, dar funcționalitatea sa este mai extinsă. Spre exemplu, awk poate folosi o expresie regulată ca delimitator, pe când cut acceptă un singur caracter: 
</p>
<pre class="code Bash">student<span class="sy0">@</span>ubuntu:~<span class="sy0">/</span>uso<span class="sy0">/</span>lab10$ <span class="kw2">netstat</span> <span class="re5">-i</span>
Kernel Interface table
Iface   MTU Met   RX-OK RX-ERR RX-DRP RX-OVR    TX-OK TX-ERR TX-DRP TX-OVR Flg
eth0       <span class="nu0">1500</span> <span class="nu0">0</span>      <span class="nu0">1955</span>      <span class="nu0">0</span>      <span class="nu0">0</span> <span class="nu0">0</span>           <span class="nu0">521</span>      <span class="nu0">0</span>      <span class="nu0">0</span>      <span class="nu0">0</span> BMRU
lo        <span class="nu0">65536</span> <span class="nu0">0</span>       <span class="nu0">359</span>      <span class="nu0">0</span>      <span class="nu0">0</span> <span class="nu0">0</span>           <span class="nu0">359</span>      <span class="nu0">0</span>      <span class="nu0">0</span>      <span class="nu0">0</span> LRU
&nbsp;
student<span class="sy0">@</span>ubuntu:~<span class="sy0">/</span>uso<span class="sy0">/</span>lab10$ <span class="kw2">netstat</span> <span class="re5">-i</span> <span class="sy0">|</span> <span class="kw2">cut</span> <span class="re5">-d</span><span class="st_h">' '</span> -f1,<span class="nu0">2</span>
Kernel Interface
Iface 
eth0 
lo 
&nbsp;
student<span class="sy0">@</span>ubuntu:~<span class="sy0">/</span>uso<span class="sy0">/</span>lab10$ <span class="kw2">netstat</span> <span class="re5">-i</span> <span class="sy0">|</span> <span class="kw2">awk</span> <span class="re5">-F</span><span class="st_h">' *'</span> <span class="st_h">'{print $1,$2,$4}'</span>
Kernel Interface 
Iface MTU RX-OK
eth0 <span class="nu0">1500</span> <span class="nu0">2029</span>
lo <span class="nu0">65536</span> <span class="nu0">359</span></pre>

<p>
<p><div class="noteclassic">
<a href="https://en.wikipedia.org/wiki/AWK" class="urlextern" title="https://en.wikipedia.org/wiki/AWK"  rel="nofollow"> Awk</a> este considerat un fel de limbaj de programare ce vizează procesarea text. Există script-uri awk complexe ce se aseamănă programelor C. Printre altele, awk permite implementarea și apelarea de funcții. 

</div></p>
</p>

</div>

<h3 class="sectionedit12" id="sort_uniq">sort &amp; uniq</h3>
<div class="level3">

<p>
Dacă dorim să sortăm studenții din fișier în ordinea numelor vom folosi comanda <code>sort</code>:
</p>
<pre class="code Bash">student<span class="sy0">@</span>mjolnir:~<span class="sy0">/</span>uso.git<span class="sy0">/</span>lab10$ <span class="kw2">sort</span> students.csv 
ALECU C. Ionuț-Gabriel,312CC,<span class="nu0">7</span>,<span class="nu0">4.5</span>,<span class="nu0">6.4</span>
ASĂVOAEI P. Cătălin,315CC,<span class="nu0">8</span>,<span class="nu0">6.75</span>,<span class="nu0">7</span>
BĂCÎRCEA A. Andrei,311CC,<span class="nu0">7</span>,<span class="nu0">5.5</span>,<span class="nu0">4.44</span>
BADEA P. Bogdan,314CC,<span class="nu0">4</span>,<span class="nu0">2.75</span>,<span class="nu0">1.56</span>
<span class="br0">&#91;</span>...<span class="br0">&#93;</span></pre>

<p>
Cateva optiuni des folosite cu <strong>sort</strong> sunt:
</p>
<ul>
<li class="level1"><div class="li"> <code>-t</code> specifica separatorul</div>
</li>
<li class="level1"><div class="li"> <code>-k</code> specifica index-ul, sau cheia, coloanei dupa care vrem sa sortam intrarile</div>
</li>
<li class="level1"><div class="li"> <code>n</code>  sortare numerică (implicit este alfabetica)</div>
</li>
<li class="level1"><div class="li"> <code>-r</code> sortare inversa (implicit crescator)</div>
</li>
</ul>

<p>
<p><div class="noteimportant">
O sursă frecventă de greșeli este folosirea construcției <code>-k 3</code> în loc de <code>-k 3,3</code> atunci când folosim mai multe chei de sortare. Dacă folosim <code>-k 3</code> atunci cheia de sortare este dată de <strong>toate</strong> coloanele începând cu a 3-a coloană. În acest caz viitoare opțiuni de chei de sortare nu mai sunt luate în considerare.
</p>

<p>
Vezi și discuția de <a href="http://unix.stackexchange.com/questions/52762/trying-to-sort-on-two-fields-second-then-first" class="urlextern" title="http://unix.stackexchange.com/questions/52762/trying-to-sort-on-two-fields-second-then-first"  rel="nofollow">aici</a>.

</div></p>
</p>

<p>
Dorim sa facem o sortare numerica descrescatoare după notă, urmata de o sortare alfabetică după grupă (adică să fie toate notele de 10 la început dar sortate în ordinea grupelor). Astfel, pentru a sorta intrările în ordinea notei, vom folosi separatorul <code>,</code> (virgulă, <em>comma</em>) și coloana a 3-a pentru cheie:
</p>
<pre class="code Bash">student<span class="sy0">@</span>mjolnir:~<span class="sy0">/</span>uso.git<span class="sy0">/</span>lab10$ <span class="kw2">sort</span> <span class="re5">-t</span> <span class="st_h">','</span> <span class="re5">-k</span> <span class="nu0">3</span>,3nr <span class="re5">-k</span> <span class="nu0">2</span>,<span class="nu0">2</span> students.csv
GEORGIU V. Alexandra-Maria,311CC,<span class="nu0">10</span>,<span class="nu0">10</span>,<span class="nu0">9.67</span>
MUȘATESCU V. Alexandru-Petrișor,311CC,<span class="nu0">10</span>,<span class="nu0">8.5</span>,<span class="nu0">9</span>
RADU L. Alina,311CC,<span class="nu0">10</span>,<span class="nu0">10</span>,<span class="nu0">7.89</span>
GONDOȘ I. Gabriel,312CC,<span class="nu0">10</span>,<span class="nu0">9</span>,<span class="nu0">7.33</span>
<span class="br0">&#91;</span>...<span class="br0">&#93;</span></pre>

<p>
În cazul în care există linii duplicate, putem folosi utilitarul <strong>uniq</strong> în conjuncție cu <strong>sort</strong> pentru a le elimina. În acest scop adăugăm o linie duplicata în <code>students.csv</code>: 
</p>
<pre class="file">VLĂDUȚU I. Liviu-Alexandru,311CC,6,3.5,5.22                                                                                                                                                       
GEORGIU V. Alexandra-Maria,311CC,10,10,9.67
[...]
VLĂDUȚU I. Liviu-Alexandru,311CC,6,3.5,5.22
BENE D. Adrian,312CC,9,10,5
[...]</pre>
<pre class="code Bash">student<span class="sy0">@</span>mjolnir:~<span class="sy0">/</span>uso.git<span class="sy0">/</span>lab10$ <span class="kw2">sort</span> <span class="re5">-t</span> <span class="st_h">','</span> <span class="re5">-k</span> <span class="nu0">3</span>,3nr <span class="re5">-k</span> <span class="nu0">2</span>,<span class="nu0">2</span> students.csv <span class="sy0">|</span> <span class="kw2">wc</span> <span class="re5">-l</span>
<span class="nu0">93</span>
student<span class="sy0">@</span>mjolnir:~<span class="sy0">/</span>uso.git<span class="sy0">/</span>lab10$ <span class="kw2">sort</span> <span class="re5">-t</span> <span class="st_h">','</span> <span class="re5">-k</span> <span class="nu0">3</span>,3nr <span class="re5">-k</span> <span class="nu0">2</span>,<span class="nu0">2</span> students.csv <span class="sy0">|</span> <span class="kw2">uniq</span> <span class="sy0">|</span> <span class="kw2">wc</span> <span class="re5">-l</span>
<span class="nu0">92</span>
student<span class="sy0">@</span>mjolnir:~<span class="sy0">/</span>uso.git<span class="sy0">/</span>lab10$ <span class="kw2">uniq</span> students.csv <span class="sy0">|</span> <span class="kw2">wc</span> <span class="re5">-l</span>
<span class="nu0">93</span></pre>

<p>
<p><div class="noteclassic">
Observăm că uniq elimină liniile duplicate adiacente. De aceea, dacă datele nu sunt sortate, comanda nu are nici un efect. 

</div></p>
</p>

</div>

<h3 class="sectionedit13" id="shell_scripting">Shell scripting</h3>
<div class="level3">

<p>
Un script shell este un fișier text care conține comenzi și construcții specifice shell-ului. Un script shell începe cu construcția <code>#!/bin/bash</code>, denumită <em>shebang</em> care indică interpretorul scriptului; în cazul de față interpretorul este chiar shell-ul Bash.
</p>

<p>
Scriptul conține comenzi uzuale folosite în shell și alte comenzi care se regăsesc mai adesea în scripturi: <code>while</code>, <code>if</code>, <code>for</code>. Acestea nu sunt instrucțiuni, ci sunt tot comenzi shell; pot fi folosite, dacă sintaxa este corectă și în linia de comandă.
</p>

</div>

<h4 id="argumente_din_linia_de_comanda">Argumente din linia de comandă</h4>
<div class="level4">

<p>
Un script moștenește variabilele de mediu ale shell-ului părinte precum <code>HOME</code>, <code>BASH</code>, <code>IFS</code>, <code>USER</code>. În script le putem folosi astfel: 
</p>
<pre class="code bash"><span class="co0">#!/bin/bash</span>
&nbsp;
<span class="kw3">echo</span> <span class="re1">$HOME</span></pre>

<p>
Pe lângă aceste variabile, scriptul poate primi o serie de argumente din linia de comandă. Folosind următoarele variabile, putem referi argumentele primite de script din linia de comandă: 
</p>
<ul>
<li class="level1"><div class="li"> <code>$*</code> este un string (<code>$1, $2 … $n</code>) format din toate argumentele primite de script </div>
</li>
<li class="level1"><div class="li"> <code>$@</code> este o listă formată din argumentele scriptului </div>
</li>
<li class="level1"><div class="li"> <code>$1, $2 … $n</code> reprezintă fiecare parametru din script </div>
</li>
<li class="level1"><div class="li"> <code>$0</code> este numele scriptului </div>
</li>
<li class="level1"><div class="li"> <code>$#</code> este numărul de argumente primite din linia de comandă </div>
</li>
</ul>

<p>
Spre exemplu, să luăm următorul script <code>arguments.sh</code>:
</p>
<pre class="code bash"><span class="co0">#!/bin/bash</span>
   <span class="kw3">echo</span> There are <span class="re4">$#</span> arguments to <span class="re4">$0</span>: <span class="re4">$*</span>
   <span class="kw3">echo</span> first argument: <span class="re4">$1</span>
   <span class="kw3">echo</span> second argument: <span class="re4">$2</span>
   <span class="kw3">echo</span> third argument: <span class="re4">$3</span>
   <span class="kw3">echo</span> the list of arguments: $<span class="sy0">@</span></pre>

<p>
Să apelăm scriptul cu 3 argumente: 
</p>
<pre class="code bash"><span class="co4">student@mjolnir:~$ </span>.<span class="sy0">/</span>arguments.sh banane cirese caise castraveti
   There are <span class="nu0">4</span> arguments to arguments.sh: banane cirese caise castraveti
   first argument: banane
   second argument: cirese
   third argument: caise
   the list of arguments: banane cirese caise castraveti</pre>

</div>

<h4 id="constructia_while_read">Constructia while read</h4>
<div class="level4">

<p>
Pentru parsare în shell folosim construcția <code>while read ...</code>. Construcția este urmată de numele variabilelor în care vom reține câmpurile parsate din cadrul fiecărei linii. Folosim la intrare fișierul <code>students.csv</code> aflat în directorul părinte; este un fișier în format CSV (<em>Comma Separated Values</em>) folosind ca separator caracterul virgulă (<code>,</code>, <em>comma</em>). Pentru a extrage doar numele studenților din fișierul de intrare vom rula scriptul <code>extract-name</code>:
</p>
<pre class="code">student@mjolnir:~/uso.git/lab11/parse-table-data$ ./extract-name
VLĂDUȚU I. Liviu-Alexandru
GEORGIU V. Alexandra-Maria
PĂUNOIU N. Gabriel
BĂCÎRCEA A. Andrei
[...]</pre>

<p>
Întrucât formatul de intrare folosește virgulă (<code>,</code>, <em>comma</em>) pe post de separator, am definit în script variabila internă <code>IFS</code> (<em>Internal Field Separator</em>) la valoarea <code>&#039;,&#039;</code>, așa cum observăm în linia 3 din scriptul <code>extract-name</code>:
</p>
<pre class="code Bash"><span class="re2">IFS</span>=<span class="st_h">','</span></pre>
<div class="hiddenGlobal  hiddenActive"><div class="hiddenElements"></div><div class="hiddenHead  hiddenSinceBeginning"><div class="hiddenOnHidden">
<p>
Click pentru informații despre variabila <code>IFS</code>
</p>
</div><div class="hiddenOnVisible">
<p>
Click pentru informații despre variabila <code>IFS</code>
</p>
</div></div> <!-- .hiddenHead --><div class="hiddenBody">
<p>
Variabila internă shell-ului <code>IFS</code> (<em>Internal Field Separator</em>) definește caracterul sau caracterele care vor fi folosite pentru împărțirea unei linii în câmpuri (<em>splitting</em>).
</p>

<p>
Variabila internă este folosită ori de câte ori în shell este nevoie de împărțirea unei linii. Un caz uzual de folosire a variabilei <code>IFS</code> este în conjuncție cu construcția <code>while read</code> pentru citirea de linii de la intrarea standard sau dintr-un fișier și împărțirea acestora în câmpuri.
</p>

<p>
Informații și pe <a href="http://en.wikipedia.org/wiki/Internal_field_separator" class="urlextern" title="http://en.wikipedia.org/wiki/Internal_field_separator"  rel="nofollow">Wikipedia</a>.
</p>
</div></div>
<p>
Să extindem scriptul pentru a afișa și numele și grupa. Conținutul noului script va fi:
</p>
<pre class="code file Bash"><span class="co0">#!/bin/bash</span>
&nbsp;
<span class="re2">IFS</span>=<span class="st_h">','</span>
<span class="kw1">while</span> <span class="kw2">read</span> name group final_grade test_grade practical_grade; <span class="kw1">do</span>
    <span class="kw3">echo</span> <span class="st0">&quot;<span class="es2">$name</span>,<span class="es2">$group</span>&quot;</span>
<span class="kw1">done</span> <span class="sy0">&lt;</span> students.csv</pre>

<p>
Pașii de mai sus puteau fi realizați și cu ajutorul comenzii <code>cut</code>. Dar, în cazul parsării folosind construcția <code>while read</code> avem două avantaje:
</p>
<ul>
<li class="level1"><div class="li"> putem afișa coloanele în ce ordine dorim; <code>cut</code> permitea afișarea de coloane doar în ordinea din fișierul de intrare;</div>
</li>
<li class="level1"><div class="li"> putem prelucra în continuare, în cadrul construcției <code>while read</code> informația parsată. Spre exemplu, afișarea poate avea forma &quot;Studentul ... face parte din grupa ...&quot;.</div>
</li>
</ul>

</div>

<h4 id="if_statement">if statement</h4>
<div class="level4">

<p>
Putem extinde script-ul de mai sus pentru a afișa doar studenții care au media &gt; 5. 
</p>
<pre class="code Bash"><span class="co0">#!/bin/bash</span>
&nbsp;
<span class="re2">IFS</span>=<span class="st_h">','</span>
<span class="kw1">while</span> <span class="kw2">read</span> name group final_grade test_grade practical_grade; <span class="kw1">do</span>
    <span class="kw1">if</span> <span class="kw3">test</span> <span class="st0">&quot;<span class="es2">$final_grade</span>&quot;</span> <span class="re5">-gt</span> <span class="nu0">5</span>; <span class="kw1">then</span>
        <span class="kw3">echo</span> <span class="st0">&quot;<span class="es2">$name</span>,<span class="es2">$group</span>,<span class="es2">$final_grade</span>&quot;</span>
    <span class="kw1">fi</span>
<span class="kw1">done</span> <span class="sy0">&lt;</span> students.csv</pre>

</div>

<h4 id="for_loop">for loop</h4>
<div class="level4">

<p>
În bash există și construcții de tipul <code>for</code>. Un exemplu usual este acela de a itera prin conținutul unui director și a face prelucrări asupra fișierelor. Spre exemplu, dorim să facem backup tuturor fișierelor dintr-un director trimis ca parametru în script: 
</p>
<pre class="code Bash"><span class="co0">#!/bin/bash</span>
&nbsp;
<span class="kw1">for</span> <span class="kw2">file</span> <span class="kw1">in</span> <span class="re4">$1</span><span class="sy0">/*</span>
<span class="kw1">do</span>
    <span class="kw1">if</span> <span class="kw3">test</span> <span class="re5">-f</span> <span class="re1">$file</span>; <span class="kw1">then</span>
        <span class="kw2">stat</span> <span class="re5">--print</span>=<span class="st0">&quot;%a %F %n<span class="es1">\n</span>&quot;</span> <span class="re1">$file</span>
        <span class="kw2">cp</span> <span class="re1">$file</span> <span class="re1">$file</span>.bkp
    <span class="kw1">fi</span>
<span class="kw1">done</span></pre>

</div>

<h2 class="sectionedit14" id="exercitii">Exerciții</h2>
<div class="level2">

<p>
<p><div class="noteclassic">
Pe măsură ce parcurgeți exercițiile, pentru indicații legate de rezolvare, dați click pe barele de tip spoiler care conțin textul <em>Click pentru indicații</em>.

</div></p>
</p>

<p>
<p><div class="noteimportant">
Acolo unde apar, exercițiile pentru karma points vor fi rezolvate și punctate <strong>după</strong> rezolvarea tuturor exercițiilor. Am plasat o parte din exercițiile pentru karma points în cadrul exercițiilor obișnuite pentru continuitate.

</div></p>
</p>

</div>

<h3 class="sectionedit15" id="optiuni_pentru_grep_2p">1. Opțiuni pentru grep (2p)</h3>
<div class="level3">

<p>
Ne propunem să aflăm care sunt fișierele de tip header (cu extensia <code>.h</code> sau <code>.hpp</code>) din sistem care au cele mai multe macro-uri definite. Pentru aceasta vom folosi comanda <code>grep</code> cu opțiuni specifice și apoi comanda <code>sort</code> pentru a sorta datele în ordinea numărului de apariții de definiții de macro-uri.
</p>

<p>
<p><div class="noteclassic">
Fișierele header dintr-un sistem Unix/Linux se găsesc în ierarhia <code>/usr/include/</code>.

</div></p>
</p>

<p>
<p><div class="notetip">
Pașii din continuare sunt detaliați <strong>în subsecțiunile</strong> exercițiului (subsecțiunile 1.1, 1.2, 1.3 și 1.4). Parcurgeți subsecțiunile pentru indicații legate de acești pași și pentru rezolvarea exercițiului.

</div></p>
</p>

</div>

<h4 id="extragere_linii_ce_contin_definitii_de_macro-uri_05p">1.1. Extragere linii ce conțin definiții de macro-uri (0.5p)</h4>
<div class="level4">

<p>
Pentru început, ca să aveți un punct de plecare, veți extrage liniile ce conțin definiții de macro-uri pentru un singur fișier header dat. Recomandăm să folosiți ca intrare fișierul <code>/usr/include/stdio.h</code>.
</p>
<div class="hiddenGlobal  hiddenActive"><div class="hiddenElements"></div><div class="hiddenHead  hiddenSinceBeginning"><div class="hiddenOnHidden">
<p>
Click pentru indicații
</p>
</div><div class="hiddenOnVisible">
<p>
Click pentru indicații
</p>
</div></div> <!-- .hiddenHead --><div class="hiddenBody">
<p>
O formă simplă de realizare a acestui lucru este folosirea comenzii:
</p>
<pre class="code">grep &#039;#define&#039; /usr/include/stdio.h</pre>

<p>
Întrucât preprocesorul C este mai lax, va trebui să construiți o expresie regulată mai acoperitoare ca argument pentru <code>grep</code>. Construiți și apoi transmiteți către <code>grep</code> o expresie regulată care face match pe liniile ce conțin definiții de macro-uri, ținând cont că:
</p>
<ol>
<li class="level1"><div class="li"> Liniile pot <strong>începe</strong> cu spații (<em>blank</em>): oricât de multe caractere spațiu posibil nici unul.</div>
</li>
<li class="level1"><div class="li"> Apoi urmează caracterul diez (<code>#</code>, <em>hash</em>).</div>
</li>
<li class="level1"><div class="li"> Apoi urmează oricâte caractere spațiu (<em>blank</em>), posibil nici unul.</div>
</li>
<li class="level1"><div class="li"> Apoi urmează șirul de caractere <code>define</code>.</div>
</li>
</ol>

<p>
<p><div class="notetip">
Parcurgeți secțiunea <a href="laborator-11.html#expresii_regulate" title="uso:laboratoare:laborator-11 ↵" class="wikilink1">Expresii regulate</a> pentru ajutor legat de construirea expresiei regulate.

</div></p>
</p>
</div></div>
<p>
Comanda va avea ca output liniile ce conțin definiții de macro-uri în cadrul fișierului <code>/usr/include/stdio.h</code>.
</p>

</div>

<h4 id="extragere_linii_ce_contin_definitii_de_macro-uri_in_ierarhiausrinclude_05p">1.2. Extragere linii ce conțin definiții de macro-uri în ierarhia /usr/include (0.5p)</h4>
<div class="level4">

<p>
În continuare veți extinde comanda anterioară și veți folosi <code>grep</code> cu opțiunea de <strong>recursivitate</strong> pentru a extrage liniile ce conțin definiții de macro-uri pentru toate fișierele din ierarhia <code>/usr/include/</code>.
</p>
<div class="hiddenGlobal  hiddenActive"><div class="hiddenElements"></div><div class="hiddenHead  hiddenSinceBeginning"><div class="hiddenOnHidden">
<p>
Click pentru indicații
</p>
</div><div class="hiddenOnVisible">
<p>
Click pentru indicații
</p>
</div></div> <!-- .hiddenHead --><div class="hiddenBody">
<p>
Va trebui să modificați comanda anterioară astfel:
</p>
<ol>
<li class="level1"><div class="li"> Să folosiți opțiunea de <strong>recursivitate</strong> pentru <code>grep</code>. Vedeți mai jos indicația.</div>
</li>
<li class="level1"><div class="li"> Să folosiți ca argument pentru <code>grep</code> șirul <code>/usr/include/</code> (reprezentând o ierarhie parcursă recursiv) în locul șirului <code>/usr/include/stdio.h</code> (reprezentând un singur fișier header).</div>
</li>
</ol>

<p>
<p><div class="notetip">
Pentru a afla opțiunea de <strong>recursivitate</strong> pentru <code>grep</code>, aveți următoarele posibilități:
</p>
<ol>
<li class="level1"><div class="li"> Căutați în pagina de manual a comenzii <code>grep</code> șirul <em>recursive</em> și localizați opțiunea necesară.</div>
</li>
<li class="level1"><div class="li"> Căutați pe Google după șirul <a href="https://www.google.com/search?q=grep+recursive+option" class="urlextern" title="https://www.google.com/search?q=grep+recursive+option"  rel="nofollow">grep recursive option</a>. Puteți da click pe link.</div>
</li>
</ol>

<p>

</div></p>
</p>

<p>
<p><div class="notetip">
Atunci când o comandă are output de dimensiune mare și vreți să-l vizualizați, puteți să treceți acel output în comanda <code>less</code>. Adică înlănțuiți comanda care generează output-ul de dimensiune mare cu comanda <code>less</code>, în forma
</p>
<pre class="code">student@mjolnir:~$ grep ... | less</pre>

<p>
În felul acesta veți putea folosi în cadrul <code>less</code> parcurgere paginată (înainte și înapoi) și căutare în tot output-ul.

</div></p>
</p>
</div></div>
<p>
Comanda va avea ca output fișierele din ierarhia <code>/usr/include/</code> și liniile din cadrul fișierelor ce conțin definiții de macro-uri.
</p>

</div>

<h4 id="obtinere_numar_de_linii_ce_contin_definitii_de_macro-uri_in_ierarhiausrinclude_05p">1.3. Obținere număr de linii ce conțin definiții de macro-uri în ierarhia /usr/include (0.5p)</h4>
<div class="level4">

<p>
În continuare veți extinde comanda anterioară și veți folosi <code>grep</code> cu opțiunea de <strong>recursivitate</strong> și cea de <strong>contorizare</strong> pentru a furniza ca output fișierele din ierarhia <code>/usr/include</code> împreună cu numărul de linii care conțin definiții de macro-uri.
</p>
<div class="hiddenGlobal  hiddenActive"><div class="hiddenElements"></div><div class="hiddenHead  hiddenSinceBeginning"><div class="hiddenOnHidden">
<p>
Click pentru indicații
</p>
</div><div class="hiddenOnVisible">
<p>
Click pentru indicații
</p>
</div></div> <!-- .hiddenHead --><div class="hiddenBody">
<p>
Va trebui să completați comanda anterioară cu opțiunea de <strong>contorizare</strong> pentru <code>grep</code>. Cu această opțiune output-ul <code>grep</code> se va schimba: nu vor mai fi afișate liniile ce conțin definiții de macro-uri ci, pentru fiecare fișier, numărul de linii ce conțin definiții de macro-uri.
</p>

<p>
<p><div class="notetip">
Pentru a afla opțiunea de <strong>contorizare</strong> pentru <code>grep</code>, aveți următoarele posibilități:
</p>
<ol>
<li class="level1"><div class="li"> Căutați în pagina de manual a comenzii <code>grep</code> șirul <em>count</em> și localizați opțiunea necesară.</div>
</li>
<li class="level1"><div class="li"> Căutați pe Google după șirul <a href="https://www.google.com/search?q=grep+count+lines" class="urlextern" title="https://www.google.com/search?q=grep+count+lines"  rel="nofollow">grep count lines</a>. Puteți da click pe link.</div>
</li>
</ol>

<p>

</div></p>
</p>
</div></div>
<p>
Comanda va avea ca output fișierele din ierarhia <code>/usr/include</code> împreună cu numărul de linii ce conțin definiții de macro-uri. Cele două câmpuri sunt afișate în format tabelar cu separatorul două puncte (<code>:</code>, <em>colon</em>). Fișierele care nu au linii care conțin definiții de macro-uri au ca al doilea câmp valoarea <code>0</code> (zero).
</p>

</div>

<h4 id="sortare_dupa_numarul_de_linii_ce_contin_definitii_de_macro-uri_05p">1.4. Sortare după numărul de linii ce conțin definiții de macro-uri (0.5p)</h4>
<div class="level4">

<p>
În final, veți sorta output-ul comenzii anterioare în funcție de numărul de linii care conțin definiții de macro-uri. Vrem să aflăm care sunt fișierele de tip header din ierarhia <code>/usr/include</code> care conțin cel mai mare număr de definiții de macro-uri.
</p>
<div class="hiddenGlobal  hiddenActive"><div class="hiddenElements"></div><div class="hiddenHead  hiddenSinceBeginning"><div class="hiddenOnHidden">
<p>
Click pentru indicații
</p>
</div><div class="hiddenOnVisible">
<p>
Click pentru indicații
</p>
</div></div> <!-- .hiddenHead --><div class="hiddenBody">
<p>
Pentru aceasta, veți folosi operatorul de înlănțuire de comenzi (<code>|</code>, <em>pipe</em>) și comanda <code>sort</code> cu opțiunile necesare. Adică veți construi un one liner de forma
</p>
<pre class="code">student@mjolnir:~/uso.git/lab11$ grep ... | sort ...</pre>

<p>
Pentru comanda <code>sort</code> folosiți opțiunile specifice pentru ca:
</p>
<ol>
<li class="level1"><div class="li"> Separatorul de câmp (<em>field separator</em>) să fie cel furnizat de output-ul comenzii anterioare, adică două puncte (<code>:</code>, <em>colon</em>).</div>
</li>
<li class="level1"><div class="li"> Sortarea să se facă după al doilea câmp, adică numărul de linii. Adică să folosească pe post de <strong>cheie de sortare</strong> al doilea câmp.</div>
</li>
<li class="level1"><div class="li"> Sortarea să fie <strong>numerică</strong>, întrucât al doilea câmp este un număr.</div>
</li>
</ol>

<p>
<p><div class="notetip">
Parcurgeți secțiunea <a href="laborator-11.html#sortare_de_date_tabelare" title="uso:laboratoare:laborator-11 ↵" class="wikilink1">Sortare de date tabelare</a> pentru ajutor legat de folosirea comenzii <code>sort</code>.

</div></p>
</p>
</div></div>
<p>
Comanda va avea ca output fișierele din ierarhia <code>/usr/include</code> împreună cu numărul de linii ce conțin definiții de macro-uri, ordonate în funcție de numărul de linii. Dacă ați rezolvat corect, fișierele care au cele mai multe linii ce conțin definiții de macro-uri vor ajunge la mii de astfel de apariții; de exemplu fișierul <code>/usr/include/elf.h</code> are mii de linii care conțin definiții de macro-uri.
</p>

<p>
<p><div class="noteclassic">
Dacă doriți, puteți continua comanda pentru a extrage doar primele 10 fișiere care conțin cele mai multe definiții de macro-uri.

</div></p>
</p>

</div>

<h3 class="sectionedit16" id="expresii_regulate_1p">2. Expresii regulate (1p)</h3>
<div class="level3">

<p>
Ne propunem să sedimentăm noțiunile legate de expresii regulate. Vom folosi <code>grep</code> și expresii regulate pentru a face două prelucrări peste fișierul <code>/usr/share/vim/vim74/tutor/tutor</code>:
</p>
<ol>
<li class="level1"><div class="li"> Să extragem liniile care încep cu cuvinte de 5 litere.</div>
</li>
<li class="level1"><div class="li"> Să extragem liniile care se încheie cu cuvinte de 5 litere.</div>
</li>
</ol>

<p>
Vor rezulta două comenzii <code>grep</code> pentru cele două prelucrări de mai sus.
</p>

<p>
Vom considera un cuvânt de 5 litere un șir de 5 caractere de tipul literă mică (de la <code>a</code> până la <code>z</code>) sau literă mare (de la <code>A</code> până la <code>Z</code>).
</p>

<p>
Pentru aceasta, recomandăm să parcurgeți următorii pași:
</p>
<ol>
<li class="level1"><div class="li"> creați expresia regulată care face match pe șiruri de 5 litere mici sau mari.</div>
</li>
<li class="level1"><div class="li"> Să creați expresia regulată care face match pe cuvinte de 5 litere la început de linie.</div>
</li>
<li class="level1"><div class="li"> Să creați expresia regulată care face match pe cuvinte de 5 litere la sfârșit de linie.</div>
</li>
</ol>

<p>
<p><div class="notetip">
Parcurgeți secțiunea <a href="laborator-11.html#expresii_regulate" title="uso:laboratoare:laborator-11 ↵" class="wikilink1">Expresii regulate</a> pentru ajutor legat de construirea de expresii regulate.

</div></p>
</p>

<p>
Creați expresia regulată care face match pe șiruri de 5 litere mici sau mari.
</p>
<div class="hiddenGlobal  hiddenActive"><div class="hiddenElements"></div><div class="hiddenHead  hiddenSinceBeginning"><div class="hiddenOnHidden">
<p>
Click pentru indicații
</p>
</div><div class="hiddenOnVisible">
<p>
Click pentru indicații
</p>
</div></div> <!-- .hiddenHead --><div class="hiddenBody">
<p>
Recomandăm să urmați pașii:
</p>
<ol>
<li class="level1"><div class="li"> Creați expresia regulată care face match pe <strong>o singură</strong> literă mică sau mare. Folosiți construcția pentru set de caractere.</div>
</li>
<li class="level1"><div class="li"> Repetați de 5 ori construcția de mai sus (adică concatenați de 5 ori acea expresie) pentru o expresie regulată care face match pe 5 litere mici sau mari.</div>
</li>
<li class="level1"><div class="li"> Folosiți <code>grep</code> cu această expresie regulată ca argument peste fișierul <code>/usr/share/vim/vim74/tutor/tutor</code> pentru a extrage liniile ce conțin șiruri de 5 litere mici sau mari. Vor fi majoritatea liniilor.</div>
</li>
</ol>
</div></div>
<p>
Observați că expresia regulată de mai sus face match pe șiruri de caractere, nu pe cuvinte. Pentru a face match pe cuvinte, vom considera (chiar dacă nu acoperă toate cazurile) că un cuvânt începe sau se termină cu spațiu (<em>blank</em>).
</p>

<p>
Astfel, creați expresia regulată care face match pe cuvinte de 5 litere la început de linie.
</p>
<div class="hiddenGlobal  hiddenActive"><div class="hiddenElements"></div><div class="hiddenHead  hiddenSinceBeginning"><div class="hiddenOnHidden">
<p>
Click pentru indicații
</p>
</div><div class="hiddenOnVisible">
<p>
Click pentru indicații
</p>
</div></div> <!-- .hiddenHead --><div class="hiddenBody">
<p>
Porniți de la expresia regulată construită mai sus și faceți următoarele actualizări:
</p>
<ol>
<li class="level1"><div class="li"> Expresia regulată trebuie să facă match pe începutul de linie.</div>
</li>
<li class="level1"><div class="li"> Înainte de cele 5 litere mici sau mari, după începutul liniei se pot găsi caractere spațiu (<em>blank</em>) oricât de multe posibil nici unul.</div>
</li>
<li class="level1"><div class="li"> După cele 5 litere mici sau mari urmează un caracter spațiu, semnificând că e vorba de un cuvânt.</div>
</li>
</ol>
</div></div>
<p>
Rulați comanda <code>grep</code> cu expresia regulată actualizată peste fișierul <code>/usr/share/vim/vim74/tutor/tutor</code> pentru a extrage liniile ce conțin cuvinte de 5 litere mici sau mari la începutul liniei. Urmăriți în output-ul comenzii dacă apar doar linii care conțin cuvinte de 5 litere mici sau mari la începutul liniei.
</p>

<p>
<p><div class="noteclassic">
Puteți înlănțui comanda de mai sus cu comanda <code>wc -l</code> pentru a afla numărul de linii pe care s-a făcut match și compara cu ceilalți colegi dacă ați obținut același rezultat.

</div></p>
</p>

<p>
În final, creați expresia regulată care face match pe cuvinte de 5 litere la sfârșit de linie.
</p>
<div class="hiddenGlobal  hiddenActive"><div class="hiddenElements"></div><div class="hiddenHead  hiddenSinceBeginning"><div class="hiddenOnHidden">
<p>
Click pentru indicații
</p>
</div><div class="hiddenOnVisible">
<p>
Click pentru indicații
</p>
</div></div> <!-- .hiddenHead --><div class="hiddenBody">
<p>
Porniți de la expresia regulată construită la început (care face match pe șiruri de 5 litere mici sau mari) și faceți următoarele actualizări:
</p>
<ol>
<li class="level1"><div class="li"> Înainte de cele 5 litere mici sau mari se află un caracter spațiu, semnificând că e vorba de un cuvânt.</div>
</li>
<li class="level1"><div class="li"> După cele 5 litere mici sau mari se pot găsi caractere spațiu (<em>blank</em>) oricât de multe posibil nici unul.</div>
</li>
<li class="level1"><div class="li"> Expresia regulată trebuie să facă match pe sfârșit de linie.</div>
</li>
</ol>
</div></div>
<p>
Rulați comanda <code>grep</code> cu expresia regulată actualizată peste fișierul <code>/usr/share/vim/vim74/tutor/tutor</code> pentru a extrage liniile ce conțin cuvinte de 5 litere mici sau mari.
</p>

<p>
<p><div class="noteclassic">
La fel ca mai sus, puteți înlănțui comanda de mai sus cu comanda <code>wc -l</code> pentru a afla numărul de linii pe care s-a făcut match și compara cu ceilalți colegi dacă ați obținut același rezultat.

</div></p>
</p>

<p>
<p><div class="noteclassic">
Exercițiul curent putea fi rezolvat și în alte moduri:
</p>
<ol>
<li class="level1"><div class="li"> Folosind opțiunea <code>-w</code> a <code>grep</code> care face match pe cuvinte (<em>words</em>).</div>
</li>
<li class="level1"><div class="li"> Folosind construcțiile <code>\&lt;</code> <code>\&gt;</code> care fac match pe șirul vid la începutul și sfârșitul unui cuvânt (<em>word</em>).</div>
</li>
</ol>

<p>
Am preferat varianta curentă pentru a sedimenta noțiunile legate de expresii regulate.

</div></p>
</p>

<p>
<p><div class="noteclassic">
Pentru <strong>1 karma point</strong>, simplificați expresiile regulate folosite pentru match de cuvinte de 5 litere la început, respectiv sfârșit de linie, folosind operatorul de repetiție pentru expresii regulate în <code>grep</code>.
</p>

<p>
Ca să identificați operatorul de repetiție pentru expresii regulate în <code>grep</code>, aveți următoarele posibilități.
</p>
<ol>
<li class="level1"><div class="li"> Căutați în pagina de manual a comenzii <code>grep</code> șirul <em>Repetition</em> și localizați opțiunea necesară.</div>
</li>
<li class="level1"><div class="li"> Căutați pe Google după șirul <a href="https://www.google.com/search?q=grep+regular+expression+repetition" class="urlextern" title="https://www.google.com/search?q=grep+regular+expression+repetition"  rel="nofollow">grep regular expression repetition</a>. Puteți da click pe link</div>
</li>
</ol>

<p>
<strong>Observație</strong>: Caracterele acoladă (<code>{</code>, <code>}</code>, <em>curly brackets</em>) trebuie escapate în argumentul transmis către grep pentru a a avea rolul lor special într-o expresie regulată. La fel cum este cazul caracterului plus (<code>+</code>).

</div></p>
</p>

</div>

<h3 class="sectionedit17" id="parsare_folosind_tab_ca_separator_1p">3. Parsare folosind tab ca separator (1p)</h3>
<div class="level3">

<p>
În secțiunea <a href="laborator-11.html#parsare_date_tabelare_in_shell" title="uso:laboratoare:laborator-11 ↵" class="wikilink1">Parsare date tabelare în shell</a> am folosit la intrare fișierul <code>students.csv</code>, fișier format CSV (<em>Comma Separated Values</em>) care folosește virgula (<code>,</code>, <em>comma</em>) pe post de separator de câmpuri. Ne propunem să folosim la intrare fișierul <code>students.txt</code> care folosește caracterul tab pe post de separator de câmpuri.
</p>

<p>
Pentru aceasta, creați o copie a scriptului <code>extract-name</code> numită <code>extract-name-tab</code>. Noul script (<code>extract-name-tab</code>) va face același lucru ca scriptul inițial (<code>extract-name</code>): va afișa <strong>doar</strong> numele studenților. Doar că veți opera două modificări pe acest nou script:
</p>
<ol>
<li class="level1"><div class="li"> Veți folosi fișierul <code>students.txt</code> în locul fișierului <code>students.csv</code>.</div>
</li>
<li class="level1"><div class="li"> Veți folosi ca separator de câmpuri caracterul tab (specific fișierului <code>students.txt</code>) în locul caracterului virgulă (<code>,</code>, <em>comma</em>) (specific fișierului <code>students.csv</code>). Vedeți indicația de mai jos.</div>
</li>
</ol>

<p>
Realizați cele două modificări de mai sus și apoi rulați scriptul <code>extract-name-tab</code>.
</p>
<div class="hiddenGlobal  hiddenActive"><div class="hiddenElements"></div><div class="hiddenHead  hiddenSinceBeginning"><div class="hiddenOnHidden">
<p>
Click to display ⇲
</p>
</div><div class="hiddenOnVisible">
<p>
Click to hide ⇱
</p>
</div></div> <!-- .hiddenHead --><div class="hiddenBody">
<p>
<p><div class="notetip">
Pentru configurarea caracterului tab ca separator de câmpuri, ar trebui, în mod obișnuit, inițializată variabila internă shell-ului <code>IFS</code> (<em>Input Field Separator</em>) la valoarea <code>&#039;\t&#039;</code>, la fel ca în linia
</p>
<pre class="code bash"><span class="re2">IFS</span>=<span class="st_h">'\t'</span></pre>

<p>
Doar că shell-ul nu poate interpreta secvențele de escape precum <code>&#039;\t&#039;</code> sau <code>&#039;\n&#039;</code> și trebuie folosit, în Bash, simbolul dolar (<code>$</code>, <em>dollar</em>) înaintea unui șir cu secvențe de escape. Așadar, modul corect de inițializare a variabilei <code>IFS</code> la caracterul tab este
</p>
<pre class="code bash"><span class="re2">IFS</span>=$<span class="st_h">'\t'</span></pre>

<p>
Mai multe detalii găsiți <a href="http://stackoverflow.com/questions/4128235/bash-shell-scripting-what-is-the-exact-meaning-of-ifs-n" class="urlextern" title="http://stackoverflow.com/questions/4128235/bash-shell-scripting-what-is-the-exact-meaning-of-ifs-n"  rel="nofollow">aici</a>.

</div></p>
</p>
</div></div>
<p>
În final, la rularea scriptului <code>extract-name-tab</code> veți obține <strong>doar</strong> numele studenților așa cum se găsesc în fișierul de intrare <code>students.txt</code>; fișierul de intrare folosește tab pe post de separator de câmpuri.
</p>

</div>

<h3 class="sectionedit18" id="selectare_studenti_care_au_nota_10_1p">4. Selectare studenți care au nota 10 (1p)</h3>
<div class="level3">

<p>
Ne propunem să actualizăm scriptul anterior <code>extract-name-tab</code> pentru a afișa doar numele studenților pentru acei studenți care au nota finală <code>10</code> (a treia coloană are valoarea <code>10</code>).
</p>

<p>
Va trebui să adăugați în scriptul <code>extract-name-tab</code> condiția pentru ca nota finală să fie <code>10</code>. Pentru aceasta folosiți construcția <code>if test ...</code>. Afișați numele studenților doar dacă este condiția satisfăcută.
</p>
<div class="hiddenGlobal  hiddenActive"><div class="hiddenElements"></div><div class="hiddenHead  hiddenSinceBeginning"><div class="hiddenOnHidden">
<p>
Click pentru indicații
</p>
</div><div class="hiddenOnVisible">
<p>
Click pentru indicații
</p>
</div></div> <!-- .hiddenHead --><div class="hiddenBody">
<p>
<p><div class="notetip">
Pentru a afla opțiunea de comparație a unei variabile cu un număr (în cazul nostru <code>10</code>), căutați în pagina de manual a comenzii <code>test</code> după șirul <em>equal</em>. Folosiți opțiunea de comparație pentru întregi.

</div></p>
</p>
</div></div>
<p>
La rularea scriptului <code>extract-name-tab</code> veți obține numele studenților care au nota finală <code>10</code>. Va trebui să obțineți 13 studenți care au nota finală <code>10</code>.
</p>

<p>
<p><div class="noteclassic">
Pentru <strong>1 karma point</strong>, actualizați scriptul <code>extract-name-tab</code> astfel încât să primească un argument reprezentând nota finală pe care au obținut-o studenții care vor fi afișați.
</p>

<p>
Scriptul va verifica faptul că primește exact un argument și că argumentul este un număr cuprins între <code>1</code> și <code>10</code>. Dacă nu primește un argument sau dacă primește ca argument un număr din afara intervalului <code>1</code> până la <code>10</code>, scriptul va afișa un mesaj de eroare și își va încheia execuția.
</p>

<p>
Exemple de rulare sunt:
</p>
<pre class="code">$ ./extract-name-tab 10
$ ./extract-name-tab 7
$ ./extract-name-tab 5</pre>

<p>

</div></p>
</p>

</div>

<h3 class="sectionedit19" id="selectare_si_sortare_studenti_care_au_nota_intre_6_si_9_2p">5. Selectare și sortare studenți care au nota între 6 și 9 (2p)</h3>
<div class="level3">

<p>
Ne propunem să realizăm un script numit <code>extract-sort-grades</code> pentru a afișa numele studenților, grupa și nota finală pentru acei studenți care au nota finală cuprinsă între <code>6</code> și <code>9</code> inclusiv. Adică valoarea de pe a treia coloană să fie <code>6</code>, <code>7</code>, <code>8</code> sau <code>9</code>. Apoi vom sorta intrările în ordinea notei și apoi în ordinea grupei (adică dacă au aceeași notă să fie sortați în ordinea grupei).
</p>

<p>
Pentru început creați o copie a scriptului <code>extract-name-tab</code> numită <code>extract-sort-grades</code> pe care o veți actualiza pentru a răspunde cerinței de mai sus.
</p>

<p>
<p><div class="notetip">
Pașii din continuare sunt detaliați <strong>în subsecțiunile</strong> exercițiului (subsecțiunile 5.1 și 5.2). Parcurgeți subsecțiunile pentru indicații legate de acești pași și pentru rezolvarea exercițiului.

</div></p>
</p>

<p>
Va trebui să actualizați scriptul <code>extract-sort-grades</code> în două locuri:
</p>
<ol>
<li class="level1"><div class="li"> Condiția trebuie să fie de număr cuprins între <code>6</code> și <code>9</code> (în loc de număr egal cu <code>10</code> cum este cazul în scriptul <code>extract-name-tab</code>). Vedeți indicațiile.</div>
</li>
<li class="level1"><div class="li"> Trebuie afișate numele studenților, grupa din care fac parte și nota finală (nu doar numele cu este cazul în scriptul <code>extract-name-tab</code>).</div>
</li>
<li class="level1"><div class="li"> Trebuie sortate intrările obținute în ordinea notelor și în ordinea grupei.</div>
</li>
</ol>

</div>

<h4 id="selectare_studenti_care_au_nota_intre_6_si_9_1p">5.1. Selectare studenți care au nota între 6 și 9 (1p)</h4>
<div class="level4">
<div class="hiddenGlobal  hiddenActive"><div class="hiddenElements"></div><div class="hiddenHead  hiddenSinceBeginning"><div class="hiddenOnHidden">
<p>
Click pentru indicații
</p>
</div><div class="hiddenOnVisible">
<p>
Click pentru indicații
</p>
</div></div> <!-- .hiddenHead --><div class="hiddenBody">
<p>
<p><div class="notetip">
Cerința presupune două condiții care trebuie îndeplinite: nota finală să fie mai mare sau egală cu <code>6</code> <strong>și</strong> nota finală să fie mai mică sau egală cu <code>9</code>.
</p>

<p>
Pentru a afla care este opțiunea de <strong>și logic</strong> pentru comanda <code>test</code>, căutați în pagina de manual a comenzii <code>test</code> șirul <code>and</code> și localizați opțiunea necesară.
</p>

<p>
La fel procedați pentru a afla opțiunile pentru <em>greater than</em> sau <em>less than</em>.
</p>

<p>
Exemple de folosire pentru comanda <code>test</code> și diversele sale opțiuni sunt mai jos:
</p>
<pre class="code"># Is 5 equal to 4? False
$ test 5 -eq 4
$ echo $?
1

# Is 5 equal to 5? True
$ test 5 -eq 5
$ echo $?
0

# Is 6 greater than 6? False
$ test 6 -gt 6
$ echo $?
1

# Is 6 greater than or equal to 6? True
$ test 6 -ge 6
$ echo $?
0

# Is 7 less than 10? True
$ test 7 -lt 10
$ echo $?
0

# Is 7 less than 10 and 6 greater than 4? True
$ test 7 -lt 10 -a 6 -gt 4
$ echo $?
0

# Is 7 less than 10 and 6 greater than 7? False
$ test 7 -lt 10 -a 6 -gt 7
$ echo $?
1

# Is 7 less than 10 or 6 greater than 7? True
$ test 7 -lt 10 -o 6 -gt 7
$ echo $?
0</pre>

<p>

</div></p>
</p>

<p>
Afișați la ieșirea standard numele, grupa și nota finală a studenților selectați <strong>separate prin virgulă</strong>.
</p>
</div></div>
<p>
La rularea scriptului <code>extract-sort-grades</code> veți obține numele studenților, grupa și nota finală pentru studenții a căror notă finală este cuprinsă între <code>6</code> și <code>9</code>.
</p>

</div>

<h4 id="sortare_studenti_care_au_nota_intre_6_si_9_1p">5.2. Sortare studenți care au nota între 6 și 9 (1p)</h4>
<div class="level4">

<p>
În continuare actualizați scriptul folosind operatorul de secvențiere (<code>|</code>, <em>pipe</em>) și comanda <code>sort</code> cu opțiunile necesare pentru a sorta ieșirea comenzii în ordinea notei și apoi a grupei.
</p>
<div class="hiddenGlobal  hiddenActive"><div class="hiddenElements"></div><div class="hiddenHead  hiddenSinceBeginning"><div class="hiddenOnHidden">
<p>
Click pentru indicații
</p>
</div><div class="hiddenOnVisible">
<p>
Click pentru indicații
</p>
</div></div> <!-- .hiddenHead --><div class="hiddenBody">
<p>
<p><div class="notetip">
Pentru comanda <code>sort</code> folosiți ca separator de câmp (<em>field separator</em>) caraceterul virgulă (<code>,</code>, <em>comma</em>). Și faceți sortarea după nota finală (al 3-lea câmp) <strong>în format numeric</strong> și după grupă (al 2-lea câmp).

</div></p>
</p>

<p>
<p><div class="notetip">
Puteți folosi comanda <code>sort</code> la finalul comenzii <code>while</code>. Adică ultima linie a scriptului să fie de forma
</p>
<pre class="code">done &lt; ../students.txt | sort ...</pre>

<p>

</div></p>
</p>
</div></div>
<p>
În final, rularea scriptului <code>extract-sort-grades</code> va conduce la afișarea numelui, grupei și a notei finale pentru studenții care au nota finală cuprinsă între <code>6</code> și <code>9</code>, sortate după nota finală și după grupă.
</p>

<p>
<p><div class="noteclassic">
Pentru <strong>1 karma point</strong>, actualizați scriptul <code>extract-sort-grades</code> astfel încât să primească două argumente reprezentând intervalul de note finale în care trebuie să se afle nota pe care au obținut-o studenții care vor fi afișați. La fel ca mai sus, studenții vor fi afișați în ordinea notei și apoi în ordinea grupei.
</p>

<p>
Scriptul va verifica faptul că:
</p>
<ul>
<li class="level1"><div class="li"> Primește exact două argumente.</div>
</li>
<li class="level1"><div class="li"> Ambele argumente sunt numere cuprinse între <code>1</code> și <code>10</code>.</div>
</li>
<li class="level1"><div class="li"> Primul argument este strict mai mic decât al doilea.</div>
</li>
</ul>

<p>
Dacă cele de mai sus nu sunt satisfăcute, scriptul va afișa un mesaj de eroare și își va încheia execuția.
</p>

<p>
Exemple de rulare sunt:
</p>
<pre class="code">$ ./extract-sort-grades 5 9
$ ./extract-sort-grades 1 4
$ ./extract-sort-grades 8 10</pre>

<p>

</div></p>
</p>

</div>

<h3 class="sectionedit20" id="conversie_de_fisiere_imagine_3p">6. Conversie de fișiere imagine (3p)</h3>
<div class="level3">

<p>
Dorim să realizăm un script care să automatizeze rescalarea dimensiunii unor fișiere imagine.
</p>

<p>
În arhiva de <a href="http://koala.cs.pub.ro/shell-scripting/res/arc/media.zip" class="urlextern" title="http://koala.cs.pub.ro/shell-scripting/res/arc/media.zip"  rel="nofollow">aici</a> aveți un set de fișiere imagine. Descărcați arhiva și dezarhivați-o folosind comenzile
</p>
<pre class="code Bash"><span class="kw2">wget</span> http:<span class="sy0">//</span>koala.cs.pub.ro<span class="sy0">/</span>shell-scripting<span class="sy0">/</span>res<span class="sy0">/</span>arc<span class="sy0">/</span>media.zip
<span class="kw2">unzip</span> media.zip</pre>

<p>
Dorim să scalăm dimensiunea acestor fișiere. Pe un fișier oarecare folosiți comanda <code>&#039;convert</code> pentru a-i schimba dimensiunea. Spre exemplu, comanda urmatoare convertește fișierul <code>input.jpg</code> în fișierul <code>output.jpg</code>.
</p>
<pre class="code Bash">convert <span class="re5">-resize</span> <span class="nu0">50</span><span class="sy0">%</span> input.jpg output.jpg</pre>

<p>
Dorim să convertim fișierele din directorul <code>media/</code>. Vrem ca numele noului fișier să se încheie cu <code>.2</code>. Astfel, dacă în variabila f avem numele fișierul inițial, comanda de conversie va fi:
</p>
<pre class="code Bash">convert <span class="re5">-resize</span> <span class="nu0">50</span><span class="sy0">%</span> <span class="st0">&quot;<span class="es2">$f</span>&quot;</span> <span class="st0">&quot;<span class="es2">$f</span>.2&quot;</span></pre>

<p>
<p><div class="noteclassic">
Având o cale către un fișier, putem obține numele și extensia acetuia folosind comanda <code>basename</code>.
</p>
<pre class="code bash"><span class="re2">filename</span>=$<span class="br0">&#40;</span><span class="kw2">basename</span> <span class="st0">&quot;<span class="es2">$fullfile</span>&quot;</span><span class="br0">&#41;</span> <span class="co0">#filename.ext</span>
<span class="re2">extension</span>=<span class="st0">&quot;<span class="es3">${filename##*.}</span>&quot;</span>      <span class="co0">#ext</span>
<span class="re2">filename</span>=<span class="st0">&quot;<span class="es3">${filename%.*}</span>&quot;</span>        <span class="co0">#filename</span></pre>

<p>

</div></p>
</p>

<p>
Realizați un script numit <code>convert-scale-images</code> care să convertească toate fișierele din directorul <code>media/</code> în fișiere noi care să se încheie cu <code>.2</code>.
</p>

<p>
<p><div class="notetip">
Folosiți <code>for f in * ...</code> pentru parcurgerea fișierelor.

</div></p>
</p>

<p>
Actualizați scriptul pentru a primi un parametru care indică scalarea conversiei. Adică dacă parametrul este <code>25%</code> atunci se scalează imaginea la <code>25%</code>. Înainte și după scalarea imaginii, afișați dimensiunea imaginii la consolă în formatul <code>widthxhigth</code>.
</p>

<p>
<p><div class="notetip">
</p>
<ul>
<li class="level1"><div class="li"> Revedeți secțiunea  <a href="http://ocw.cs.pub.ro/courses/uso/laboratoare/laborator-11?&amp;#argumente_din_linia_de_comanda" class="urlextern" title="http://ocw.cs.pub.ro/courses/uso/laboratoare/laborator-11?&amp;#argumente_din_linia_de_comanda"  rel="nofollow"> Argumente din linia de comandă </a>.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> Folosiți opțiunea <code>print</code> a lui <code>convert</code> pentru a afișa dimensiunea imaginii într-un anumit format.</div>
</li>
</ul>

<p>

</div></p>
</p>

<p>
Actualizați scriptul pentru a primi ca argument directorul de intrare (în care se găsesc fișierele) și directorul de ieșire (în care se vor găsi fișierele convertite). Dacă directorul de ieșire nu există va fi creat.
</p>

<p>
Actualizați scriptul să afișeze mesaje de eroare dacă directorul de intrare nu există. In acest caz, veti iesi din script cu un cod de eroare avand valoarea 1.
</p>

<p>
<p><div class="notetip">
</p>
<ul>
<li class="level1"><div class="li"> Verificați existența directorului folosind o construcție de forma <code>if test</code>. </div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> Pentru a întoarce un cod de eroare din script, folosi comanda <code>exit</code>. <a href="laborator-06.html" class="urlextern" title="http://ocw.cs.pub.ro/courses/uso/laboratoare/laborator-06"  rel="nofollow"> | Amintiți-vă </a> cum verificăm codul de succes/eroare întors de un proces. </div>
</li>
</ul>

<p>

</div></p>
</p>

<p>
<p><div class="noteclassic">
Pentru <strong>1 karma point</strong>, actualizați scriptul ca să valideze dacă argumentul de scalare este în forma XY% unde X și Y sunt cifre. Puteți folosi pentru validare o construcție de forma
</p>
<pre class="code Bash"><span class="kw3">echo</span> <span class="st0">&quot;$1&quot;</span> <span class="sy0">|</span> <span class="kw2">grep</span> <span class="sy0">&lt;</span>suitable-regex<span class="sy0">&gt;</span> <span class="sy0">&gt;</span> <span class="sy0">/</span>dev<span class="sy0">/</span>null <span class="nu0">2</span><span class="sy0">&gt;&amp;</span><span class="nu0">1</span></pre>

<p>

</div></p>
</p>

</div>

<h2 class="sectionedit21" id="bonus">Bonus</h2>
<div class="level2">

</div>

<h3 class="sectionedit22" id="selectare_studenti_dupa_nota_fractionara_1_karma_point">1. Selectare studenți după notă fracționară (1 karma point)</h3>
<div class="level3">

<p>
Ne propunem să selectăm studenții care au obținut la testul grilă notă mai mare sau egală cu <code>8</code>. Este vorba de coloana a 4-a din fișierele de intrare (<code>students.txt</code> sau <code>students.csv</code>).
</p>

<p>
Creați un script numit <code>extract-students-test-over-8</code> care afișează numele, grupa și nota la testul grilă, separate prin virgulă (<code>,</code>, <em>comma</em>) pentru studenții care au obținut o notă mai mare sau egală cu <code>8</code> la testul grilă.
</p>

<p>
Puteți folosi ca intrare fie fișierul <code>students.txt</code> fie fișierul <code>students.csv</code>.
</p>
<div class="hiddenGlobal  hiddenActive"><div class="hiddenElements"></div><div class="hiddenHead  hiddenSinceBeginning"><div class="hiddenOnHidden">
<p>
Click pentru indicații
</p>
</div><div class="hiddenOnVisible">
<p>
Click pentru indicații
</p>
</div></div> <!-- .hiddenHead --><div class="hiddenBody">
<p>
<p><div class="notetip">
Notele la testul grilă sunt numere fracționare (<em>float</em>). Întrucât în shell nu se pot efectua operații pe numere fracționare (însemnând că nu putem face comparații), va trebui să folosiți utilitarul <code>bc</code>.
</p>

<p>
Utilitarul <code>bc</code> permite comparații pe numere fracționare afișând <code>0</code> în cazul în care comparația este falsă, și <code>1</code> în cazul în care comparația este adevărată. <code>bc</code> primește operațiile la intrarea standard. Mai jos sunt două exemple de folosire:
</p>
<pre class="code">$ echo &quot;1.4 &gt; 2.5&quot; | bc
0
$ echo &quot;2.5 &gt;= 1.14&quot; | bc
1</pre>

<p>
În cazul primei comenzi, <code>bc</code> primește la intrarea standard șirul <code>1.4 &gt; 2.5</code> însemnând comparația <em>este 1.4 mai mare decât 2.5?</em>. Întrucât comparația este falsă, <code>bc</code> afișează <code>0</code>.
</p>

<p>
În cazul celei de-a doua comenzi, <code>bc</code> primește la intrarea standard șirul <code>2.5 &gt;= 1.14</code> însemnând comparația <em>este 2.5 mai mare sau egal decât 1.14?</em>. Întrucât comparația este adevărată, <code>bc</code> afișează <code>1</code>.

</div></p>
</p>
</div></div>
<p>
În urma rulării scriptului <code>extract-students-test-over-8</code> veți obține numele, grupa și nota la testul grilă, separate prin virgulă, pentru studenții care au obținut o notă mai mare sau egală cu <code>8</code> la testul grilă. Output-ul va conține 36 de linii.
</p>

</div>

<h3 class="sectionedit23" id="selectare_studenti_dupa_note_fractionare_1_karma_point">2. Selectare studenți după note fracționare (1 karma point)</h3>
<div class="level3">

<p>
Ne propunem să selectăm studenții care au obținut la testul grilă notă mai mare sau egală cu <code>8</code> (coloana a 4-a) <strong>și</strong> care au obținut la testul grilă notă mai mică sau egală ca cea de la testul practic (coloana a 5-a).
</p>

<p>
Actualizați scriptul <code>extract-students-test-over-8</code> și afișați numele, grupa, nota la testul grilă și nota la testul practic, separate prin virgulă (<code>,</code>, <em>comma</em>) pentru studenții care au obținut o notă mai mare sau egală cu 8 la testul grilă <strong>și</strong> care au obținut la testul grilă notă mai mică sau egală ca cea de la testul practic.
</p>

<p>
Puteți folosi ca intrare fie fișierul <code>students.txt</code> fie fișierul <code>students.csv</code>.
</p>

<p>
Output-ul scriptului va conține 3 linii de forma:
</p>
<pre class="code">MUȘATESCU V. Alexandru-Petrișor,311CC,8.5,9
NEACȘU C. Florin-Mărgărit,314CC,9,9
ȘTIRBĂȚ A. Steliana,315CC,10,10</pre>

</div>

<h3 class="sectionedit24" id="sortare_studenti_in_grupa_1_karma_point">3. Sortare studenți în grupă (1 karma point)</h3>
<div class="level3">

<p>
Ne propunem să afișăm studenții unei grupe, sortați după nota finală (coloana a 3-a).
</p>

<p>
Creați un script numit <code>sort-students-by-group</code> care primește ca argument un șir reprezentând grupa și afișează numele și nota finală, separate prin virgulă (<code>,</code>, <em>comma</em>), a studenților din acea grupă sortați după nota finală. Realizați sortare inversă (<em>reverse</em>) astfel încât cele mai mari note să fie primele.
</p>
<div class="hiddenGlobal  hiddenActive"><div class="hiddenElements"></div><div class="hiddenHead  hiddenSinceBeginning"><div class="hiddenOnHidden">
<p>
Click pentru indicații
</p>
</div><div class="hiddenOnVisible">
<p>
Click pentru indicații
</p>
</div></div> <!-- .hiddenHead --><div class="hiddenBody">
<p>
<p><div class="notetip">
Porniți de la un script existent. De exemplu, creați o copie a scriptului <code>extract-sort-grades</code> și modificați-l pentru a satisface cerința acestui exercițiu.

</div></p>
</p>

<p>
<p><div class="notetip">
Nota finală, după care se face sortarea, este o valoare <strong>numerică</strong>.

</div></p>
</p>
</div></div>
<p>
Scriptul trebuie să afișeze un mesaj de eroare în cazul în care nu primește exact un argument sau în cazul în care argumentul nu reprezintă o grupă validă. Grupe valide sunt <code>311CC</code>, <code>312CC</code>, <code>313CC</code>, <code>314CC</code>, <code>315CC</code>.
</p>

<p>
<p><div class="noteclassic">
Puteți valida parametrul comparând pe rând cu fiecare dintre cele 5 grupe valide. Sau puteți folosi expresii regulate printr-o construcție de forma
</p>
<pre class="code">echo &quot;$1&quot; | grep &#039;...&#039; &gt; /dev/null
if test $? -eq 0; then   # if group was matched
    ...</pre>

<p>

</div></p>
</p>

<p>
Puteți folosi ca intrare fie fișierul <code>students.txt</code> fie fișierul <code>students.csv</code>.
</p>

</div>

<h3 class="sectionedit25" id="sortare_grupe_dupa_note_de_10_obtinute_de_studenti_2_karma_points">4. Sortare grupe după note de 10 obținute de studenți (2 karma points)</h3>
<div class="level3">

<p>
Ne propunem să afișăm grupele sortate în funcție de câți studenți din acea grupă au obținut nota <code>10</code>.
</p>

<p>
Creați un script numit <code>sort-groups-by-grade</code> care afișează fiecare grupă și numărul de note de <code>10</code> obținute de studenții din acea grupă, separate prin virgulă (<code>,</code>, <em>comma</em>), sortate după numărul de note de <code>10</code>. Sortarea să fie inversă, adică grupele cu cele mai multe note de <code>10</code> să fie primele.
</p>
<div class="hiddenGlobal  hiddenActive"><div class="hiddenElements"></div><div class="hiddenHead  hiddenSinceBeginning"><div class="hiddenOnHidden">
<p>
Click pentru indicații
</p>
</div><div class="hiddenOnVisible">
<p>
Click pentru indicații
</p>
</div></div> <!-- .hiddenHead --><div class="hiddenBody">
<p>
<p><div class="notetip">
În Bash puteți folosi array-uri asociative, adică array-uri pentru care indexul poate fi un șir, nu neapărat un număr.
</p>

<p>
Un mod simplu prin care putem să inițializăm și să afișăm un array asociativ este descris mai jos, împreună cu un exemplu de rulare. Puteți pleca de la acest exemplu în rezolvarea acestui exercițiu. Scriptul <code>sample-bash-associative-array</code> se găsește în directorul laboratorului în subdirectorul <code>process-table-data/</code>.
</p>
<pre class="code">student@mjolnir:~/uso.git/lab11/process-table-data$ cat sample-bash-associative-array 
#!/bin/bash

# Initialize grades array.
declare -A grades
for group in &quot;311CC&quot; &quot;312CC&quot; &quot;313CC&quot; &quot;314CC&quot; &quot;315CC&quot;; do
    grades[&quot;$group&quot;]=2
done

# Print groups and grades.
for group in &quot;311CC&quot; &quot;312CC&quot; &quot;313CC&quot; &quot;314CC&quot; &quot;315CC&quot;; do
    echo &quot;$group,${grades[$group]}&quot;
done
student@mjolnir:~/uso.git/lab11/process-table-data$ ./sample-bash-associative-array 
311CC,2
312CC,2
313CC,2
314CC,2
315CC,2</pre>

<p>
Pentru informații detaliate despre array-uri în shell aveți două posibilități:
</p>
<ol>
<li class="level1"><div class="li"> Cautați în pagina de manual a <code>bash</code> șirul <em>Arrays</em> și localizați secțiunea corespunzătoare.</div>
</li>
<li class="level1"><div class="li"> Căutați pe Google după șirul <a href="https://www.google.com/search?q=bash+arrays" class="urlextern" title="https://www.google.com/search?q=bash+arrays"  rel="nofollow">bash arrays</a>. Puteți da click pe link.</div>
</li>
</ol>

<p>

</div></p>
</p>

<p>
<p><div class="notetip">
Acest exercițiu poate fi rezolvat și cu un one liner. Dacă folosiți corespunzător filtre de text precum <code>cut</code>, <code>tr</code>, <code>sed</code>, <code>awk</code>, <code>grep</code>, <code>sort</code>, <code>uniq</code>, veți putea obține aceeași soluție, fără să folosiți array-uri asociative.

</div></p>
</p>
</div></div>
<p>
Puteți folosi ca intrare fie fișierul <code>students.txt</code> fie fișierul <code>students.csv</code>.
</p>

<p>
În cazul unei implementări corecte, în urma rulării scriptului veți obține output-ul
</p>
<pre class="code">314CC,4
311CC,3
315CC,3
313CC,2
312CC,1</pre>

<p>
Grupa <code>314CC</code> este prima grupă afișată întrucât are cel mai mare număr de studenți care au obținut nota <code>10</code>: <code>4</code> studenți. Grupa <code>312CC</code> este ultima grupă afișată întrucât are cel mai mic număr de studenți care au obținut nota <code>10</code>: <code>1</code> student.
</p>

</div>

<h2 class="sectionedit26" id="sumar">Sumar</h2>
<div class="level2">

<p>
Pe parcursul acestui laborator am acoperit câteva aspecte practice legate de prelucrarea datelor, expresii regulate si shell scripting.
</p>

<p>
Datele sunt preluate dintr-un suport și format specific de stocare și apoi sunt prelucrate și prezentate într-o formă utilă observatorului uman: rapoarte, tabele, grafice, rezultate numerice.
</p>

<p>
Expresiile regulate reprezintă șiruri de caractere în care unele caractere au rol special și pot ține locul altor caractere. Spunem că o expresie regulată se potrivește sau <em>face match</em> pe un șir dat (sau pe mai multe șiruri). Exemple de caractere speciale sunt:
</p>
<ul>
<li class="level1"><div class="li"> <code>^</code> (început de rând)</div>
</li>
<li class="level1"><div class="li"> <code>$</code> (sfârșit de rând)</div>
</li>
<li class="level1"><div class="li"> <code>*</code> (expresia anterioară de oricâte ori, posibil niciodată)</div>
</li>
<li class="level1"><div class="li"> <code>+</code> (expresia anterioară de oricâte ori, cel puțin o dată)</div>
</li>
<li class="level1"><div class="li"> <code>.</code> (orice caracter)</div>
</li>
</ul>

<p>
Expresiile regulate sunt folosite pentru căutare, selecție și verificare în secțiuni text.
</p>

<p>
Expresiile regulate sunt întâlnite în toate limbajele de programare. Suport nativ pentru expresii regulate se găsește în majoritatea limbajelor de programare moderne precum Python, Perl, PHP, Ruby, JavaScript. În shell, utilitare precum <code>grep</code>, <code>sed</code>, <code>awk</code> folosesc expresii regulate. <code>grep</code> primește ca argument o expresie regulată și un fișier sau set de fișiere unde face căutarea; <code>grep</code> va afișa liniile care conțin șiruri pe care face match expresia regulată primită ca argument.
</p>

<p>
Pentru parsarea datelor tabelare în shell, putem folosi construcția <code>while read ...</code> în conjuncție cu variabila internă <code>IFS</code> (<em>Input Field Separator</em>). Cu ajutorul construcției putem citi linie cu linie și apoi parsa câmpurile fiecărei linii și stoca în variabile individuale. Apoi putem face operații pe acele câmpuri.
</p>

<p>
Prelucrarea datelor presune extragerea doar a anumitor valori sau sortarea acestora sau realizarea de diferite operații (precum medii aritmetice) sau trasarea de grafice. În shell, pentru sortarea datelor putem folosi comanda <code>sort</code>. Comanda <code>sort</code> două opțiuni importante:
</p>
<ul>
<li class="level1"><div class="li"> <code>-t</code> care precizează separatorul de câmpuri (<em>field separator</em>)</div>
</li>
<li class="level1"><div class="li"> <code>-k</code> care precizează cheia/cheile după care se face sortarea. De obicei opțiunea va fi folosită, de exemplu, în forma <code>-k 2,2</code>, însemnând că sortarea se face după a doua cheie.</div>
</li>
</ul>

</div>

        </div>
        <div class="right_sidebar">
          <form action="../../start.html" accept-charset="utf-8" class="search" id="dw__search" method="get"><div class="no"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch__in" accesskey="f" name="id" class="edit" title="[F]" /><input type="submit" value="Search" class="button" title="Search" /><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>          <div class="namespace_sidebar sidebar_box">
<ul>
<li class="level1"><div class="li"> <a href="../anunturi.html" class="wikilink1" title="uso:anunturi">Anunțuri</a></div>
</li>
<li class="level1"><div class="li"> <a href="../need-to-know.html" class="wikilink1" title="uso:need-to-know">USO Need to Know</a></div>
</li>
<li class="level1"><div class="li"> <a href="../calendar.html" class="wikilink1" title="uso:calendar">Calendar</a></div>
</li>
<li class="level1"><div class="li"> <a href="../regulament.html" class="wikilink1" title="uso:regulament">Reguli generale și notare</a></div>
<ul>
<li class="level2"><div class="li"> <a href="../punctaj.html" class="wikilink1" title="uso:punctaj">Notare</a></div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> <a href="../orar.html" class="wikilink1" title="uso:orar">Orar</a></div>
</li>
<li class="level1"><div class="li"> <a href="../catalog.html" class="wikilink1" title="uso:catalog">Catalog</a></div>
</li>
<li class="level1"><div class="li"> <a href="../echipa.1.html" class="wikilink1" title="uso:echipa">Echipă</a></div>
</li>
</ul>

<h1 class="sectionedit1" id="resurse">Resurse</h1>
<div class="level1">

</div>
<!-- EDIT2 PLUGIN_INCLUDE_START "uso:resurse:start" [0-] --><div class="plugin_include_content plugin_include__uso:resurse:start">
<div class="level1">
<ul>
<li class="level1"><div class="li"> <a href="../resurse/bashcheatsheet.html" class="wikilink1" title="uso:resurse:bashcheatsheet">Cheatsheet Bash</a></div>
</li>
<li class="level1"><div class="li"> <a href="../resurse/cheatsheet.html" class="wikilink1" title="uso:resurse:cheatsheet">Cheatsheet</a></div>
</li>
<li class="level1"><div class="li"> <a href="../resurse/email.html" class="wikilink1" title="uso:resurse:email">Conturi de email @stud.acs.upb.ro</a></div>
</li>
<li class="level1"><div class="li"> <a href="../resurse/feed.html" class="wikilink1" title="uso:resurse:feed">Feed RSS</a></div>
</li>
<li class="level1"><div class="li"> <a href="../resurse/folosire-vim.html" class="wikilink1" title="uso:resurse:folosire-vim">Folosire Vim</a></div>
</li>
<li class="level1"><div class="li"> <a href="../resurse/mv.html" class="wikilink1" title="uso:resurse:mv">Mașina virtuală</a></div>
</li>
</ul>

</div>
<!-- EDIT4 PLUGIN_INCLUDE_EDITBTN "uso:resurse:start" [0-] --><!-- EDIT3 PLUGIN_INCLUDE_END "uso:resurse:start" [0-] --></div>
<div class="level1">

</div>
<!-- EDIT1 SECTION "Resurse" [263-335] -->
<h1 class="sectionedit5" id="cursuri">Cursuri</h1>
<div class="level1">

</div>
<!-- EDIT6 PLUGIN_INCLUDE_START "uso:cursuri:start" [0-] --><div class="plugin_include_content plugin_include__uso:cursuri:start">
<div class="level1">
<ul>
<li class="level1"><div class="li"> <a href="../cursuri/curs-00.html" class="wikilink1" title="uso:cursuri:curs-00">00. Bine ați venit!</a></div>
</li>
<li class="level1"><div class="li"> <a href="../cursuri/curs-01.html" class="wikilink1" title="uso:cursuri:curs-01">01. Introducere în sisteme de operare</a></div>
</li>
<li class="level1"><div class="li"> <a href="../cursuri/curs-02.html" class="wikilink1" title="uso:cursuri:curs-02">02. Utilizarea sistemului de fișiere</a></div>
</li>
<li class="level1"><div class="li"> <a href="../cursuri/curs-03.html" class="wikilink1" title="uso:cursuri:curs-03">03. Dezvoltarea programelor</a></div>
</li>
<li class="level1"><div class="li"> <a href="../cursuri/curs-04.html" class="wikilink1" title="uso:cursuri:curs-04">04. Procese și utilizatori</a></div>
</li>
<li class="level1"><div class="li"> <a href="../cursuri/curs-05.html" class="wikilink1" title="uso:cursuri:curs-05">05. Administrarea sistemului de fișiere</a></div>
</li>
<li class="level1"><div class="li"> <a href="../cursuri/curs-06.html" class="wikilink1" title="uso:cursuri:curs-06">06. Interfața în linia de comandă</a></div>
</li>
<li class="level1"><div class="li"> <a href="../cursuri/curs-07.html" class="wikilink1" title="uso:cursuri:curs-07">07. Servicii de rețea</a></div>
</li>
<li class="level1"><div class="li"> <a href="../cursuri/curs-08.html" class="wikilink1" title="uso:cursuri:curs-08">08. Configurări de rețea</a></div>
</li>
</ul>

</div>
<!-- EDIT8 PLUGIN_INCLUDE_EDITBTN "uso:cursuri:start" [0-] --><!-- EDIT7 PLUGIN_INCLUDE_END "uso:cursuri:start" [0-] --></div>
<div class="level1">

</div>
<!-- EDIT5 SECTION "Cursuri" [336-408] -->
<h1 class="sectionedit9" id="laboratoare">Laboratoare</h1>
<div class="level1">

</div>
<!-- EDIT10 PLUGIN_INCLUDE_START "uso:laboratoare:start" [0-] --><div class="plugin_include_content plugin_include__uso:laboratoare:start">
<div class="level1">
<ul>
<li class="level1"><div class="li"> <a href="laborator-01.html" class="wikilink1" title="uso:laboratoare:laborator-01">01. Introducere</a></div>
</li>
<li class="level1"><div class="li"> <a href="laborator-02.html" class="wikilink1" title="uso:laboratoare:laborator-02">02. Utilizarea sistemului de fișiere</a></div>
</li>
<li class="level1"><div class="li"> <a href="laborator-03.html" class="wikilink1" title="uso:laboratoare:laborator-03">03. Dezvoltarea programelor C sub Linux</a></div>
</li>
<li class="level1"><div class="li"> <a href="laborator-04.html" class="wikilink1" title="uso:laboratoare:laborator-04">04. Utilizatori și procese</a></div>
</li>
<li class="level1"><div class="li"> <a href="laborator-05.html" class="wikilink1" title="uso:laboratoare:laborator-05">05. Gestiunea sistemului de fișiere</a></div>
</li>
<li class="level1"><div class="li"> <a href="laborator-06.html" class="wikilink1" title="uso:laboratoare:laborator-06">06. Interfața în linia de comandă</a></div>
</li>
<li class="level1"><div class="li"> <a href="laborator-06b.html" class="wikilink1" title="uso:laboratoare:laborator-06b">06b. Recapitulare midterm</a></div>
</li>
<li class="level1"><div class="li"> <a href="laborator-07.html" class="wikilink1" title="uso:laboratoare:laborator-07">07. Servicii de rețea</a></div>
</li>
<li class="level1"><div class="li"> <a href="laborator-08.html" class="wikilink1" title="uso:laboratoare:laborator-08">08. Configurări de rețea</a></div>
</li>
</ul>

</div>
<!-- EDIT12 PLUGIN_INCLUDE_EDITBTN "uso:laboratoare:start" [0-] --><!-- EDIT11 PLUGIN_INCLUDE_END "uso:laboratoare:start" [0-] --></div>
<div class="level1">

</div>
<!-- EDIT9 SECTION "Laboratoare" [409-488] -->
<h1 class="sectionedit13" id="teme">Teme</h1>
<div class="level1">

</div>
<!-- EDIT14 PLUGIN_INCLUDE_START "uso:teme:start" [0-] --><div class="plugin_include_content plugin_include__uso:teme:start">
<div class="level1">
<ul>
<li class="level1"><div class="li"> <a href="../teme/instructiuni-checker.html" class="wikilink1" title="uso:teme:instructiuni-checker">Instrucțiuni de folosire a checkerului</a></div>
</li>
<li class="level1"><div class="li"> <a href="../teme/intrebari-frecvente.html" class="wikilink1" title="uso:teme:intrebari-frecvente">Întrebări frecvente</a></div>
</li>
<li class="level1"><div class="li"> <a href="../teme/tema-0.html" class="wikilink1" title="uso:teme:tema-0">Tema 0</a></div>
</li>
<li class="level1"><div class="li"> <a href="../teme/tema-1.html" class="wikilink1" title="uso:teme:tema-1">Tema 1</a></div>
</li>
<li class="level1"><div class="li"> <a href="../teme/tema-2.html" class="wikilink1" title="uso:teme:tema-2">Tema 2</a></div>
</li>
</ul>

</div>
<!-- EDIT16 PLUGIN_INCLUDE_EDITBTN "uso:teme:start" [0-] --><!-- EDIT15 PLUGIN_INCLUDE_END "uso:teme:start" [0-] --></div>
<div class="level1">

</div>
<!-- EDIT13 SECTION "Teme" [489-] -->
</div>
<div class="toc_sidebar sidebar_box">
<!-- TOC START -->
<div id="sb__right__dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="laborator-11.html#laborator_11_-_shell_scripting">Laborator 11 - Shell scripting</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="laborator-11.html#suport_laborator">Suport laborator</a></div></li>
<li class="level2"><div class="li"><a href="laborator-11.html#repository_laborator">Repository laborator</a></div></li>
<li class="level2"><div class="li"><a href="laborator-11.html#demo">Demo</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="laborator-11.html#expresii_regulate">Expresii regulate</a></div></li>
<li class="level3"><div class="li"><a href="laborator-11.html#expresii_regulate_vs_globbing">Expresii regulate vs globbing</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="laborator-11.html#expresii_regulate_grep">Expresii regulate &amp; grep</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="laborator-11.html#tr_sed">tr &amp; sed</a></div></li>
<li class="level3"><div class="li"><a href="laborator-11.html#cut_awk">cut &amp; awk</a></div></li>
<li class="level3"><div class="li"><a href="laborator-11.html#sort_uniq">sort &amp; uniq</a></div></li>
<li class="level3"><div class="li"><a href="laborator-11.html#shell_scripting">Shell scripting</a></div>
<ul class="toc">
<li class="level4"><div class="li"><a href="laborator-11.html#argumente_din_linia_de_comanda">Argumente din linia de comandă</a></div></li>
<li class="level4"><div class="li"><a href="laborator-11.html#constructia_while_read">Constructia while read</a></div></li>
<li class="level4"><div class="li"><a href="laborator-11.html#if_statement">if statement</a></div></li>
<li class="level4"><div class="li"><a href="laborator-11.html#for_loop">for loop</a></div></li>
</ul>
</li>
</ul>
</li>
<li class="level2"><div class="li"><a href="laborator-11.html#exercitii">Exerciții</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="laborator-11.html#optiuni_pentru_grep_2p">1. Opțiuni pentru grep (2p)</a></div>
<ul class="toc">
<li class="level4"><div class="li"><a href="laborator-11.html#extragere_linii_ce_contin_definitii_de_macro-uri_05p">1.1. Extragere linii ce conțin definiții de macro-uri (0.5p)</a></div></li>
<li class="level4"><div class="li"><a href="laborator-11.html#extragere_linii_ce_contin_definitii_de_macro-uri_in_ierarhiausrinclude_05p">1.2. Extragere linii ce conțin definiții de macro-uri în ierarhia /usr/include (0.5p)</a></div></li>
<li class="level4"><div class="li"><a href="laborator-11.html#obtinere_numar_de_linii_ce_contin_definitii_de_macro-uri_in_ierarhiausrinclude_05p">1.3. Obținere număr de linii ce conțin definiții de macro-uri în ierarhia /usr/include (0.5p)</a></div></li>
<li class="level4"><div class="li"><a href="laborator-11.html#sortare_dupa_numarul_de_linii_ce_contin_definitii_de_macro-uri_05p">1.4. Sortare după numărul de linii ce conțin definiții de macro-uri (0.5p)</a></div></li>
</ul>
</li>
<li class="level3"><div class="li"><a href="laborator-11.html#expresii_regulate_1p">2. Expresii regulate (1p)</a></div></li>
<li class="level3"><div class="li"><a href="laborator-11.html#parsare_folosind_tab_ca_separator_1p">3. Parsare folosind tab ca separator (1p)</a></div></li>
<li class="level3"><div class="li"><a href="laborator-11.html#selectare_studenti_care_au_nota_10_1p">4. Selectare studenți care au nota 10 (1p)</a></div></li>
<li class="level3"><div class="li"><a href="laborator-11.html#selectare_si_sortare_studenti_care_au_nota_intre_6_si_9_2p">5. Selectare și sortare studenți care au nota între 6 și 9 (2p)</a></div>
<ul class="toc">
<li class="level4"><div class="li"><a href="laborator-11.html#selectare_studenti_care_au_nota_intre_6_si_9_1p">5.1. Selectare studenți care au nota între 6 și 9 (1p)</a></div></li>
<li class="level4"><div class="li"><a href="laborator-11.html#sortare_studenti_care_au_nota_intre_6_si_9_1p">5.2. Sortare studenți care au nota între 6 și 9 (1p)</a></div></li>
</ul>
</li>
<li class="level3"><div class="li"><a href="laborator-11.html#conversie_de_fisiere_imagine_3p">6. Conversie de fișiere imagine (3p)</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="laborator-11.html#bonus">Bonus</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="laborator-11.html#selectare_studenti_dupa_nota_fractionara_1_karma_point">1. Selectare studenți după notă fracționară (1 karma point)</a></div></li>
<li class="level3"><div class="li"><a href="laborator-11.html#selectare_studenti_dupa_note_fractionare_1_karma_point">2. Selectare studenți după note fracționare (1 karma point)</a></div></li>
<li class="level3"><div class="li"><a href="laborator-11.html#sortare_studenti_in_grupa_1_karma_point">3. Sortare studenți în grupă (1 karma point)</a></div></li>
<li class="level3"><div class="li"><a href="laborator-11.html#sortare_grupe_dupa_note_de_10_obtinute_de_studenti_2_karma_points">4. Sortare grupe după note de 10 obținute de studenți (2 karma points)</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="laborator-11.html#sumar">Sumar</a></div></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->
</div>
        </div>
      
    
      <div class="stylefoot">
        <div class="meta">
          <div class="user">
                    </div>
          <div class="doc">
          uso/laboratoare/laborator-11.txt · Last modified: 2016/11/23 01:11 by lucia.cojocaru          </div>
        </div>
      </div>

    <div class="clearer"></div>

    
                <div class="bar" id="bar__bottom">
      <div class="bar-left">
        <a href="http://ocw.cs.pub.ro/courses/uso/laboratoare/laborator-11?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Old revisions [O]">Old revisions</a>      </div>
      <div class="bar-right">
        <a href="http://ocw.cs.pub.ro/courses/uso/laboratoare/laborator-11?do=media&amp;ns=uso%3Alaboratoare"  class="action media" rel="nofollow" title="Media Manager">Media Manager</a><a href="laborator-11.html#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]">Back to top</a>      </div>
    </div>
    <div class="clearer"></div>
            
    <div align="center" class="footerinc">
  <div class="license"><a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license"><img src="../../lib/images/license/button/cc-by-sa.png" alt="CC Attribution-Share Alike 3.0 Unported" /></a></div>
  <a target="_blank" href="http://www.chimeric.de" title="www.chimeric.de"><img src="../../lib/tpl/arctic/images/button-chimeric-de.png" width="80" height="15" alt="www.chimeric.de" border="0" /></a>

  <a target="_blank" href="http://jigsaw.w3.org/css-validator/check/referer" title="Valid CSS"><img src="../../lib/tpl/arctic/images/button-css.png" width="80" height="15" alt="Valid CSS" border="0" /></a>

  <a target="_blank" href="http://wiki.splitbrain.org/wiki:dokuwiki" title="Driven by DokuWiki"><img src="../../lib/tpl/arctic/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" border="0" /></a>

  <a target="_blank" href="http://www.firefox-browser.de" title="do yourself a favour and use a real browser - get firefox"><img src="../../lib/tpl/arctic/images/button-firefox.png" width="80" height="15" alt="do yourself a favour and use a real browser - get firefox!!" border="0" /></a>
  
  <a target="_blank" href="../../feed.php" title="Recent changes RSS feed"><img src="../../lib/tpl/arctic/images/button-rss.png" width="80" height="15" alt="Recent changes RSS feed" border="0" /></a>

  <a target="_blank" href="http://validator.w3.org/check/referer" title="Valid XHTML 1.0"><img src="../../lib/tpl/arctic/images/button-xhtml.png" width="80" height="15" alt="Valid XHTML 1.0" border="0" /></a>
</div>

  </div>
</div>

<div class="no"><img src="http://ocw.cs.pub.ro/courses/lib/exe/indexer.php?id=uso%3Alaboratoare%3Alaborator-11&amp;1479900287" width="2" height="1" alt="" /></div>
</body>
</html>
